From bugs+caf_=bugs=bugs.plt-scheme.org@plt-scheme.org Sun Oct 22 12:58:16 2006
Received: from py-out-1112.google.com (py-out-1112.google.com [64.233.166.183])
	by champlain.ccs.neu.edu (8.13.7/8.13.7) with ESMTP id k9MGwAq9022575
	for <bugs@bugs.plt-scheme.org>; Sun, 22 Oct 2006 12:58:10 -0400
Message-Id: <200610221658.k9MGw8YZ022569@champlain.ccs.neu.edu>
Date: Sun, 22 Oct 2006 12:58:08 -0400
From: dalev@ccs.neu.edu
To: bugs@plt-scheme.org
Subject: drag-and-drop on .app in OS X doesn't work

>Number:         8344
>Category:       misc
>Synopsis:       drag-and-drop on .app in OS X doesn't work
>Class:          sw-bug
>Responsible:    mflatt
>Severity:       serious
>Priority:       medium
>State:          closed
>Confidential:   no
>Arrival-Date:   Sun Oct 22 13:00:01 -0400 2006
>Closed-Date:    Mon Jan 17 17:47:45 -0500 2011
>Last-Modified:  Mon Jan 17 17:47:45 -0500 2011
>Originator:     Dale Vaillancourt
>Organization:
plt
>Submitter-Id:   unknown
>Release:        352.8-svn22oct2006
>Environment:
macosx "Darwin desktopdv.local 8.8.0 Darwin Kernel Version 8.8.0: Fri Sep  8 17:18:57 PDT 2006; root:xnu-792.12.6.obj~1/RELEASE_PPC Power Macintosh powerpc" (ppc-macosx/3m) (get-display-depth) = 32
Docs Installed:
(("/Users/dalev/Software/plt/doc" "r5rs" "mzscheme" "mred" "help" "tour" "drscheme" "srfi" "mzlib" "misclib" "mrlib" "framework" "foreign" "mzc" "tools" "insidemz" "web-server" "swindle" "plot" "release-notes" "t-y-scheme" "tex2page" "beginning" "beginning-abbr" "intermediate" "intermediate-lambda" "advanced" "teachpack" "teachpack-htdc" "profj-beginner" "profj-intermediate" "profj-advanced") (* "/Users/dalev/Library/PLT Scheme/planet/300/352.8/cache/dalev/acl2.plt/1/0/acl2-html-docs"))
Human Language: english
(current-memory-use) 99120260

Collections:
(("/Users/dalev/Library/PLT Scheme/352.8/collects" non-existent-path) ("/Users/dalev/Software/plt/collects" ".DS_Store" ".svn" "afm" "algol60" "browser" "compiler" "config" "defaults" "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "framework" "frtime" "games" "graphics" "guibuilder" "handin-client" "handin-server" "help" "hierlist" "honu-module" "htdch" "htdp" "html" "icons" "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "mred" "mrflow" "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "mztake" "net" "openssl" "parser-tools" "planet" "plot" "preprocessor" "profj" "profjBoxes" "profjWizard" "r5rs" "r6rs" "readline" "repos-time-stamp" "scribble" "setup" "sgl" "sirmail" "skipper" "slatex" "slibinit" "slideshow" "srfi" "srpersist" "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack" "test-suite" "tests" "tex2page" "texpict" "trace" "version" "waterworld" "web-server" "xelda" "xml"))
Teachpack filenames: ()
Computer Language: (("Professional Languages" "(module ...)") (#6(#t write mixed-fraction-e #f #t debug) (default) #0()))
>Description:
I created an executable (type Launcher, base MrEd) in the module language with the following program:

(module show-dropped-files mzscheme
  (display (current-command-line-arguments)))

I expected it to display the paths of all files dropped onto the .app, but OS X simply does not allow the files to be dropped.

I ran the same experiment on Windows, and there it works as I had expected (on both 352 & today's nightly 352.8).
>How-To-Repeat:
See Description.
>Fix:
Use the following Info.plist.  I added the 'CFBundleDocumentTypes' key; the rest was generated by Create Executable.

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>CFBundleDevelopmentRegion</key>
	<string>English</string>
	<key>CFBundleDocumentTypes</key>
	<array>
		<dict>
			<key>CFBundleTypeExtensions</key>
			<array>
				<string>*</string>
			</array>
			<key>CFBundleTypeOSTypes</key>
			<array>
				<string>****</string>
			</array>
			<key>CFBundleTypeRole</key>
			<string>Viewer</string>
		</dict>
	</array>
	<key>CFBundleExecutable</key>
	<string>create-tgz</string>
	<key>CFBundleIconFile</key>
	<string>Starter</string>
	<key>CFBundleIdentifier</key>
	<string>org.plt-scheme.create-tgz</string>
	<key>CFBundleInfoDictionaryVersion</key>
	<string>6.0</string>
	<key>CFBundlePackageType</key>
	<string>APPL</string>
	<key>CFBundleShortVersionString</key>
	<string>352.8</string>
	<key>CFBundleSignature</key>
	<string>MrSt</string>
	<key>CFBundleVersion</key>
	<string>352.8</string>
</dict>
</plist>
>Audit-Trail:
From: Dale Vaillancourt <dalev@ccs.neu.edu>
To: bugs@plt-scheme.org
Cc: 
Subject: Re: all/8344: drag-and-drop on .app in OS X doesn't work
Date: Sun, 22 Oct 2006 13:36:47 -0400

 --Apple-Mail-3-695297267
 Content-Transfer-Encoding: 7bit
 Content-Type: text/plain;
 	charset=US-ASCII;
 	delsp=yes;
 	format=flowed
 
 FWIW, I tinkered with the Info.plist that Create Executable produced  
 inside the .app, and I seem to have made it work.  See the attached  
 Info.plist.  I added the 'CFBundleDocumentTypes' array (and  
 everything contained therein).  -Dale
 
 
 --Apple-Mail-3-695297267
 Content-Transfer-Encoding: 7bit
 Content-Type: application/octet-stream;
 	x-unix-mode=0644;
 	name=Info.plist
 Content-Disposition: attachment;
 	filename=Info.plist
 
 <?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
 <plist version="1.0">
 <dict>
 	<key>CFBundleDevelopmentRegion</key>
 	<string>English</string>
 	<key>CFBundleDocumentTypes</key>
 	<array>
 		<dict>
 			<key>CFBundleTypeExtensions</key>
 			<array>
 				<string>*</string>
 			</array>
 			<key>CFBundleTypeOSTypes</key>
 			<array>
 				<string>****</string>
 			</array>
 			<key>CFBundleTypeRole</key>
 			<string>Viewer</string>
 		</dict>
 	</array>
 	<key>CFBundleExecutable</key>
 	<string>create-tgz</string>
 	<key>CFBundleIconFile</key>
 	<string>Starter</string>
 	<key>CFBundleIdentifier</key>
 	<string>org.plt-scheme.create-tgz</string>
 	<key>CFBundleInfoDictionaryVersion</key>
 	<string>6.0</string>
 	<key>CFBundlePackageType</key>
 	<string>APPL</string>
 	<key>CFBundleShortVersionString</key>
 	<string>352.8</string>
 	<key>CFBundleSignature</key>
 	<string>MrSt</string>
 	<key>CFBundleVersion</key>
 	<string>352.8</string>
 </dict>
 </plist>
 
 --Apple-Mail-3-695297267
 Content-Transfer-Encoding: 7bit
 Content-Type: text/plain;
 	charset=US-ASCII;
 	format=flowed
 
 
 On Oct 22, 2006, at 1:00 PM, bugs@plt-scheme.org wrote:
 
 > Thank you very much for your problem report.
 > It has the internal identification `all/8344'.
 > You can check on the status of your problem report at
 >   http://bugs.plt-scheme.org/query/?cmd=view&pr=8344
 > Assigned to Unclaimed <nobody@plt-scheme.org>.
 
 
 --Apple-Mail-3-695297267--
From: Matthew Flatt <mflatt@cs.utah.edu>
To: dalev@ccs.neu.edu, bugs@plt-scheme.org
Cc: 
Subject: Re: all/8344: drag-and-drop on .app in OS X doesn't work
Date: Mon, 23 Oct 2006 05:35:36 0800

 At Sun, 22 Oct 2006 13:00:01 -0400, dalev@ccs.neu.edu wrote:
 > I created an executable (type Launcher, base MrEd) in the module language with 
 > the following program:
 > 
 > (module show-dropped-files mzscheme
 >   (display (current-command-line-arguments)))
 > 
 > I expected it to display the paths of all files dropped onto the .app, but OS 
 > X simply does not allow the files to be dropped.
 > 
 > I ran the same experiment on Windows, and there it works as I had expected (on 
 > both 352 & today's nightly 352.8).
 
 For Mac OS X, an executable has to specifically declare the kinds of
 files that it's willing to accept by drag-and-drop on the .app.
 
 DrScheme's "Create Executable..." doesn't currently let you specify
 that information. But see `make-mred-launcher', specifically the
 'file-types key for the `aux' association list. (Actually, the
 'file-types key is documented via reference to
 `create-embedding-executable', so you'll have to look there.)
 
 Matthew
 
 
 
From: Dale Vaillancourt <dalev@ccs.neu.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@plt-scheme.org
Subject: Re: all/8344: drag-and-drop on .app in OS X doesn't work
Date: Sun, 22 Oct 2006 22:53:58 -0400

 On Oct 22, 2006, at 5:35 PM, Matthew Flatt wrote:
 > At Sun, 22 Oct 2006 13:00:01 -0400, dalev@ccs.neu.edu wrote:
 >> I created an executable (type Launcher, base MrEd) in the module  
 >> language with
 >> the following program:
 >>
 >> (module show-dropped-files mzscheme
 >>   (display (current-command-line-arguments)))
 >>
 >> I expected it to display the paths of all files dropped onto  
 >> the .app, but OS
 >> X simply does not allow the files to be dropped.
 >>
 >> I ran the same experiment on Windows, and there it works as I had  
 >> expected (on
 >> both 352 & today's nightly 352.8).
 >
 > For Mac OS X, an executable has to specifically declare the kinds of
 > files that it's willing to accept by drag-and-drop on the .app.
 >
 > DrScheme's "Create Executable..." doesn't currently let you specify
 > that information. But see `make-mred-launcher', specifically the
 > 'file-types key for the `aux' association list. (Actually, the
 > 'file-types key is documented via reference to
 > `create-embedding-executable', so you'll have to look there.)
 
 Ah, I didn't realize there was a Scheme API for this.  I hacked the  
 Info.plist manually to get what I wanted.
 
 Perhaps in the interest of consistent behavior across platforms, the  
 default Create Executable behavior should specify that OS X apps  
 handle any file dropped onto them?
 
 Thanks for the reference!
 
 -Dale

Responsible changed from "nobody" to "mflatt" by eli at Tue, 31 Oct 2006 16:39:00 -0500
Reason>>> Probably to be closed.
(Dale feel free to close it too...)


State changed from "open" to "closed" by eli at Mon, 17 Jan 2011 17:47:45 -0500
Reason>>> closed as "obsolete" with respect to v5.0.99.6 and later; 
either the bug
is long-since fixed, the relevant code doesn't exist 
anymore, the
relevant platform hasn't been supported recently, or a new 
bug report is
needed if the problem really isn't fixed and someone 
actually cares

