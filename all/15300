From bugs+caf_=bugs=bugs.plt-scheme.org@plt-scheme.org Fri May  6 21:41:14 2016
Received: from mail-io0-f169.google.com (mail-io0-f169.google.com [209.85.223.169])
	by winooski.ccs.neu.edu (8.14.7/8.14.7) with ESMTP id u471fA78019159
	for <bugs@bugs.plt-scheme.org>; Fri, 6 May 2016 21:41:10 -0400
Message-Id: <201605070141.u471f8tq019152@winooski.ccs.neu.edu>
Date: Fri, 6 May 2016 21:41:08 -0400
From: matthias@ccs.neu.edu
To: bugs@racket-lang.org
Subject: ->dm does not work with dr syntax-check

>Number:         15300
>Category:       all
>Synopsis:       ->dm does not work with dr syntax-check
>Class:          not-a-bug
>Responsible:    nobody
>Severity:       serious
>Priority:       medium
>State:          closed
>Confidential:   no
>Arrival-Date:   Fri May 06 21:44:01 -0400 2016
>Closed-Date:    Mon May 16 11:30:55 -0400 2016
>Last-Modified:  Mon May 16 11:30:55 -0400 2016
>Originator:     matthias
>Organization:
plt
>Submitter-Id:   unknown
>Release:        6.5.0.4--2016-04-30(-/f)
>Environment:
macosx "Darwin Texas-2.local 15.4.0 Darwin Kernel Version 15.4.0: Fri Feb 26 22:08:05 PST 2016; root:xnu-3248.40.184~3/RELEASE_X86_64 x86_64" (x86_64-macosx/3m) (get-display-depth) = 32
Human Language: english
(current-memory-use) 922203412
raco pkg (show):
Installation-wide:
 Package                 Checksum           Source
 benchmark               78f36c4e85e97d...  catalog...#master
 benchmark-util                             link...hmark-util
 glob                    96817aaf9cfb22...  catalog...nn/glob
 htdp                    fe58066fea6e2c...  clone...path=htdp
 main-distribution       1a0cd523117ae3...  catalog...ibution
 main-distribution-test  046a93803a9e84...  catalog...on-test
 r-lexer                 a94313082d5244...  catalog...r-lexer
 racket-lib                                 static-link...lib
 racket-test                                static-link...est
 summarize                                  link.../summarize
 syntax-sloc             946bcbe955b654...  url...ax-sloc.git
 unstable                6d2564bf725be9...  catalog...nstable
 [245 auto-installed packages not shown]
User-specific for installation "development":
 [none]



Collections:
("/Users/matthias/0Unison/collects/"
 (".DS_Store" "._.DS_Store" "compiled" "date" "finance" "info-domain" "info.ss" "pdf.ss~" "session" "short" "testing" "tll-collects" "utils" "web"))
("/Users/matthias/Library/Racket/development/collects"
 (non-existent-path))
("/Users/matthias/plt/racket/collects"
 (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))

Recent Internal Errors: 
Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket" #t #t ((test) (main)) #t))
>Description:
Syntax check does not draw binding arrows across bindings generated by ->dm
>How-To-Repeat:
Mouse over err/c in this program:

#lang racket

(define (err/c x) (or/c #false x))

(define (external-player/c pre-choose)
  (object/c
   [k (->m number? (err/c string?))]
   [m (->dm ([done number?]) #:pre (> done 0) [err/c number?])]))

The occurrenc in the last line won't be targeted. When you try to rename err/c, it will generate an erroneous program (with free variable err/c). 
>Fix:
>Audit-Trail:
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthias Felleisen <matthias@ccs.neu.edu>, bugs <bugs@racket-lang.org>
Cc: nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15300: ->dm does not work with dr syntax-check
Date: Sun, 15 May 2016 21:22:45 -0500

 Check syntax's arrows are correct for this program. In particular, the
 "err/c" on the last line is not a reference to the definition. It is a
 binding occurrence. Try this program to maybe clarify:
 
 #lang racket
 
 (define (err/c x) (or/c #false x))
 
 (define (external-player/c pre-choose)
   (object/c
    [k (->m number? (err/c string?))]
    [m (->dm ([done number?]) #:pre (> done 0) [err/c number?] #:post
 (< err/c 0))]))
 
 
 
 On Fri, May 6, 2016 at 8:44 PM,  <matthias@ccs.neu.edu> wrote:
 > A new problem report is waiting at
 >   http://bugs.racket-lang.org/query/?cmd=view&pr=15300
 >
 > Reported by matthias for release: 6.5.0.4--2016-04-30(-/f)
 >
 > *** Description:
 > Syntax check does not draw binding arrows across bindings generated by ->dm
 >
 > *** How to repeat:
 > Mouse over err/c in this program:
 >
 > #lang racket
 >
 > (define (err/c x) (or/c #false x))
 >
 > (define (external-player/c pre-choose)
 >   (object/c
 >    [k (->m number? (err/c string?))]
 >    [m (->dm ([done number?]) #:pre (> done 0) [err/c number?])]))
 >
 > The occurrenc in the last line won't be targeted. When you try to rename err/c, it will generate an erroneous program (with free variable err/c).
 >
 > *** Environment:
 > macosx "Darwin Texas-2.local 15.4.0 Darwin Kernel Version 15.4.0: Fri Feb 26 22:08:05 PST 2016; root:xnu-3248.40.184~3/RELEASE_X86_64 x86_64" (x86_64-macosx/3m) (get-display-depth) = 32
 > Human Language: english
 > (current-memory-use) 922203412
 > raco pkg (show):
 > Installation-wide:
 >  Package                 Checksum           Source
 >  benchmark               78f36c4e85e97d...  catalog...#master
 >  benchmark-util                             link...hmark-util
 >  glob                    96817aaf9cfb22...  catalog...nn/glob
 >  htdp                    fe58066fea6e2c...  clone...path=htdp
 >  main-distribution       1a0cd523117ae3...  catalog...ibution
 >  main-distribution-test  046a93803a9e84...  catalog...on-test
 >  r-lexer                 a94313082d5244...  catalog...r-lexer
 >  racket-lib                                 static-link...lib
 >  racket-test                                static-link...est
 >  summarize                                  link.../summarize
 >  syntax-sloc             946bcbe955b654...  url...ax-sloc.git
 >  unstable                6d2564bf725be9...  catalog...nstable
 >  [245 auto-installed packages not shown]
 > User-specific for installation "development":
 >  [none]
 >
 >
 >
 > Collections:
 > ("/Users/matthias/0Unison/collects/"
 >  (".DS_Store" "._.DS_Store" "compiled" "date" "finance" "info-domain" "info.ss" "pdf.ss~" "session" "short" "testing" "tll-collects" "utils" "web"))
 > ("/Users/matthias/Library/Racket/development/collects"
 >  (non-existent-path))
 > ("/Users/matthias/plt/racket/collects"
 >  (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))
 >
 > Recent Internal Errors:
 > Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket" #t #t ((test) (main)) #t))
 >
From: Matthias Felleisen <matthias@ccs.neu.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs <bugs@racket-lang.org>, nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15300: ->dm does not work with dr syntax-check
Date: Sun, 15 May 2016 22:42:15 -0400

 Ouch. This is brittle syntax. Thanks. 
 
 
 
 
 > On May 15, 2016, at 10:22 PM, Robby Findler <robby@eecs.northwestern.edu> wrote:
 > 
 > Check syntax's arrows are correct for this program. In particular, the
 > "err/c" on the last line is not a reference to the definition. It is a
 > binding occurrence. Try this program to maybe clarify:
 > 
 > #lang racket
 > 
 > (define (err/c x) (or/c #false x))
 > 
 > (define (external-player/c pre-choose)
 >  (object/c
 >   [k (->m number? (err/c string?))]
 >   [m (->dm ([done number?]) #:pre (> done 0) [err/c number?] #:post
 > (< err/c 0))]))
 > 
 > 
 > 
 > On Fri, May 6, 2016 at 8:44 PM,  <matthias@ccs.neu.edu> wrote:
 >> A new problem report is waiting at
 >>  http://bugs.racket-lang.org/query/?cmd=view&pr=15300
 >> 
 >> Reported by matthias for release: 6.5.0.4--2016-04-30(-/f)
 >> 
 >> *** Description:
 >> Syntax check does not draw binding arrows across bindings generated by ->dm
 >> 
 >> *** How to repeat:
 >> Mouse over err/c in this program:
 >> 
 >> #lang racket
 >> 
 >> (define (err/c x) (or/c #false x))
 >> 
 >> (define (external-player/c pre-choose)
 >>  (object/c
 >>   [k (->m number? (err/c string?))]
 >>   [m (->dm ([done number?]) #:pre (> done 0) [err/c number?])]))
 >> 
 >> The occurrenc in the last line won't be targeted. When you try to rename err/c, it will generate an erroneous program (with free variable err/c).
 >> 
 >> *** Environment:
 >> macosx "Darwin Texas-2.local 15.4.0 Darwin Kernel Version 15.4.0: Fri Feb 26 22:08:05 PST 2016; root:xnu-3248.40.184~3/RELEASE_X86_64 x86_64" (x86_64-macosx/3m) (get-display-depth) = 32
 >> Human Language: english
 >> (current-memory-use) 922203412
 >> raco pkg (show):
 >> Installation-wide:
 >> Package                 Checksum           Source
 >> benchmark               78f36c4e85e97d...  catalog...#master
 >> benchmark-util                             link...hmark-util
 >> glob                    96817aaf9cfb22...  catalog...nn/glob
 >> htdp                    fe58066fea6e2c...  clone...path=htdp
 >> main-distribution       1a0cd523117ae3...  catalog...ibution
 >> main-distribution-test  046a93803a9e84...  catalog...on-test
 >> r-lexer                 a94313082d5244...  catalog...r-lexer
 >> racket-lib                                 static-link...lib
 >> racket-test                                static-link...est
 >> summarize                                  link.../summarize
 >> syntax-sloc             946bcbe955b654...  url...ax-sloc.git
 >> unstable                6d2564bf725be9...  catalog...nstable
 >> [245 auto-installed packages not shown]
 >> User-specific for installation "development":
 >> [none]
 >> 
 >> 
 >> 
 >> Collections:
 >> ("/Users/matthias/0Unison/collects/"
 >> (".DS_Store" "._.DS_Store" "compiled" "date" "finance" "info-domain" "info.ss" "pdf.ss~" "session" "short" "testing" "tll-collects" "utils" "web"))
 >> ("/Users/matthias/Library/Racket/development/collects"
 >> (non-existent-path))
 >> ("/Users/matthias/plt/racket/collects"
 >> (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))
 >> 
 >> Recent Internal Errors:
 >> Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket" #t #t ((test) (main)) #t))
 >> 
 
 

Class changed from "sw-bug" to "not-a-bug" by stamourv at Mon, 16 May 2016 11:30:55 -0400
Reason>>> .

State changed from "open" to "closed" by stamourv at Mon, 16 May 2016 11:30:55 -0400
Reason>>> .

