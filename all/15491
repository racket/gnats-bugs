From bugs+caf_=bugs=bugs.plt-scheme.org@plt-scheme.org Sat Nov 18 08:39:38 2017
Received: from mail-oi0-f41.google.com (mail-oi0-f41.google.com [209.85.218.41])
	by winooski.ccs.neu.edu (8.14.7/8.14.7) with ESMTP id vAIDdaVv003567
	for <bugs@bugs.plt-scheme.org>; Sat, 18 Nov 2017 08:39:36 -0500
Message-Id: <201711181339.vAIDdXxm003560@winooski.ccs.neu.edu>
Date: Sat, 18 Nov 2017 08:39:33 -0500
From: ylwhj051@163.com
To: bugs@racket-lang.org
Subject: Chinese string problem report

>Number:         15491
>Category:       all
>Synopsis:       Chinese string problem report
>Class:          sw-bug
>Responsible:    nobody
>Severity:       serious
>Priority:       medium
>State:          closed
>Confidential:   no
>Arrival-Date:   Sat Nov 18 08:40:01 -0500 2017
>Closed-Date:    Sat Nov 18 10:35:42 -0500 2017
>Last-Modified:  Sat Nov 18 10:36:01 -0500 2017
>Originator:     ice
>Organization:
plt
>Submitter-Id:   unknown
>Release:        6.11
>Environment:
windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m) (get-display-depth) = 32
Human Language: english
(current-memory-use) 379999364
raco pkg (show):
Installation-wide:
 Package            Checksum             Source
 main-distribution  2691ecda516c7f3c...  catalog...tribution
 racket-lib         db645864e1c06f9c...  catalog racket-lib
 [195 auto-installed packages not shown]
User-specific for installation "6.11":
 [none]



Collections:
("C:\\Users\\ice\\AppData\\Roaming\\Racket\\6.11\\collects"
 (non-existent-path))
("C:\\Program Files\\Racket\\collects"
 ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))

Recent Internal Errors: 
Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((test) (main)) #t))
>Description:
#lang racket/base
(require racket/class racket/math racket/draw)
(define bitmap-size 4200)
(define font-size (/ bitmap-size 10))
(define yuan-2 1600)
(define yuan-3 1150)
(define yuan-4 750)

;(define na-yin-1 '("1" "2" "3" "4" "5" "6" "7" "8"
;                       "9" "10" "11" "12" "13" "14" "15" ))
(define na-yin-2 '("沙中金" "山下火" "平地木" "壁上土" "金箔金" "覆灯火" "天河水" "大驿土"
                         "钗钏金" "桑柘木" "大溪水" "沙中土" "天上火" "石榴木" "大海水" ))
(define na-yin-shu (length na-yin-2))

(define text-target (make-bitmap bitmap-size bitmap-size))
(define dc (new bitmap-dc% [bitmap text-target]))

(send dc set-pen
      (send the-pen-list find-or-create-pen
            "blue" (/ bitmap-size 200) 'solid 'projecting))
(send dc set-brush "blue" 'transparent)
(send dc set-text-foreground "red")
(send dc set-font (make-object font% font-size 'roman))
(send dc set-origin (/ bitmap-size 2) (/ bitmap-size 2))

(for ([j (reverse na-yin-2)])
  (send dc draw-text
        j
        (- (* 2/3 font-size))
        (- (/ (+ yuan-3 yuan-2) 2) (* 0.6 font-size)))
  (send dc rotate (/ pi na-yin-shu))
  (send dc draw-line 0 yuan-4 0 yuan-2)
  (send dc rotate (/ pi na-yin-shu)))

(send text-target save-file "na-yin.png" 'png)
>How-To-Repeat:
>Fix:
>Audit-Trail:
From: Robby Findler <robby@eecs.northwestern.edu>
To: bugs <bugs@racket-lang.org>
Cc: nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15491: Chinese string problem report
Date: Sat, 18 Nov 2017 08:54:35 -0600

 This program causes DrRacket to crash for me. Below is the stack trace.
 
 Robby
 
 Process:               DrRacket [93821]
 Path:                  /Users/USER/*/DrRacket.app/Contents/MacOS/DrRacket
 Identifier:            org.racket-lang.DrRacket
 Version:               6.11.0.2 (6.11.0.2)
 Code Type:             X86-64 (Native)
 Parent Process:        ??? [1]
 Responsible:           DrRacket [93821]
 User ID:               501
 
 Date/Time:             2017-11-18 08:53:15.774 -0600
 OS Version:            Mac OS X 10.11.6 (15G17023)
 Report Version:        11
 Anonymous UUID:        BEAB3650-647A-76F1-135D-159DF6A06DB6
 
 Sleep/Wake UUID:       BBDABC7A-088E-48BC-BC9E-1E385F5BC2B2
 
 Time Awake Since Boot: 650000 seconds
 Time Since Wake:       40000 seconds
 
 System Integrity Protection: enabled
 
 Crashed Thread:        0  Dispatch queue: com.apple.main-thread
 
 Exception Type:        EXC_CRASH (SIGABRT)
 Exception Codes:       0x0000000000000000, 0x0000000000000000
 Exception Note:        EXC_CORPSE_NOTIFY
 
 Application Specific Information:
 abort() called
 
 Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
 0   libsystem_kernel.dylib        0x00007fffa05f5f06 __pthread_kill + 10
 1   libsystem_pthread.dylib        0x00007fffa02e34ec pthread_kill + 90
 2   libsystem_c.dylib              0x00007fff97bc96df abort + 129
 3   Racket                        0x00000001090d29b7
 scheme_wait_until_suspend_ok + 215 (thread.c:5168)
 4   Racket                        0x000000010906636f
 scheme_wait_semas_chs + 751 (sema.c:734)
 5   Racket                        0x00000001090d7b09
 scheme_syncing_ready + 1673 (thread.c:6594)
 6   Racket                        0x00000001090d4e9d
 scheme_block_until + 333 (thread.c:4995)
 7   Racket                        0x00000001090d91f6 do_sync + 1510
 (schthread.h:410)
 8   Racket                        0x0000000108df76d3
 _scheme_apply_from_native + 467 (schnapp.inc:33)
 9   ???                            0x000000010a40f92f 0 + 4466997551
 10  ???                            0x000000010a41379b 0 + 4467013531
 11  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 12  Racket                        0x0000000108e2862c apply_k + 236 (fun.c:1481)
 13  Racket                        0x0000000108e27d12
 scheme_top_level_do_worker + 1858 (fun.c:1303)
 14  Racket                        0x0000000109003308 user_write_bytes
 + 904 (portfun.c:1457)
 15  Racket                        0x0000000108fe88da
 scheme_put_byte_string + 234 (port.c:3196)
 16  Racket                        0x0000000108ff27ef
 scheme_redirect_write_bytes + 175 (port.c:5552)
 17  Racket                        0x000000010900314d user_write_bytes
 + 461 (portfun.c:1417)
 18  Racket                        0x0000000108fe8af4
 scheme_put_byte_string + 772 (port.c:3153)
 19  Racket                        0x0000000109008efc print_to_port +
 348 (print.c:1198)
 20  Racket                        0x0000000108ff7654
 sch_default_display_handler + 148 (portfun.c:4006)
 21  ???                            0x000000010a41cac9 0 + 4467051209
 22  ???                            0x000000010c85050b 0 + 4505011467
 23  ???                            0x0000000116225f5d 0 + 4666318685
 24  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 25  Racket                        0x0000000109006970 display_write +
 1056 (portfun.c:4131)
 26  Racket                        0x0000000108ff73cf display + 31
 (portfun.c:4143)
 27  ???                            0x000000010a419cdb 0 + 4467039451
 28  ???                            0x000000010efd79dd 0 + 4546460125
 29  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 30  Racket                        0x0000000108e28601 apply_k + 193 (fun.c:1479)
 31  Racket                        0x0000000108e27d12
 scheme_top_level_do_worker + 1858 (fun.c:1303)
 32  Racket                        0x0000000108df2d4d call_error + 1293
 (error.c:999)
 33  Racket                        0x0000000108df0ae3 def_exn_handler +
 499 (error.c:4581)
 34  Racket                        0x0000000108df8c2a scheme_do_eval +
 5114 (eval.c:2804)
 35  Racket                        0x0000000108df2232
 do_raise_inside_barrier + 594 (error.c:4684)
 36  Racket                        0x0000000108e27d12
 scheme_top_level_do_worker + 1858 (fun.c:1303)
 37  Racket                        0x0000000108dee4f1 do_raise + 609
 (error.c:4761)
 38  ???                            0x000000010a41ac09 0 + 4467043337
 39  ???                            0x000000010a4107ad 0 + 4467001261
 40  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 41  Racket                        0x0000000108df769a
 _scheme_apply_from_native + 410 (schthread.h:410)
 42  ???                            0x000000010a40f92f 0 + 4466997551
 43  ???                            0x000000010a41215b 0 + 4467007835
 44  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 45  Racket                        0x0000000108dfbd7c
 _scheme_apply_multi_from_native + 396 (schthread.h:410)
 46  ???                            0x000000010c85217c 0 + 4505018748
 47  ???                            0x000000010c8b391b 0 + 4505418011
 48  ???                            0x000000010efd623d 0 + 4546454077
 49  ???                            0x000000010a40e5e7 0 + 4466992615
 50  Racket                        0x0000000108e2c8e2 _apply_native +
 194 (fun.c:3730)
 51  Racket                        0x0000000108e2d1ca
 scheme_apply_chaperone + 938 (fun.c:3911)
 52  ???                            0x000000010c851eed 0 + 4505018093
 53  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 54  Racket                        0x0000000108dfef90
 apply_values_execute + 208 (eval.c:2223)
 55  Racket                        0x0000000108dfab0f scheme_do_eval +
 13023 (eval.c:3897)
 56  Racket                        0x0000000108f4c152 body_one_expr +
 162 (module.c:6120)
 57  Racket                        0x0000000108dfb7a2 scheme_do_eval +
 16242 (eval.c:3219)
 58  Racket                        0x0000000108e31535
 scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 59  Racket                        0x0000000108e31865
 scheme_apply_for_prompt + 101 (fun.c:6735)
 60  Racket                        0x0000000108e212d8 call_with_prompt
 + 2568 (fun.c:7232)
 61  Racket                        0x0000000108df8c2a scheme_do_eval +
 5114 (eval.c:2804)
 62  Racket                        0x0000000108e32198
 _scheme_call_with_prompt_multi + 504 (fun.c:7453)
 63  Racket                        0x0000000108f4bd4c
 scheme_module_run_finish + 1260 (module.c:6219)
 64  ???                            0x000000010a40d71d 0 + 4466988829
 65  ???                            0x000000010a40540d 0 + 4466955277
 66  Racket                        0x0000000108f55c96 eval_module_body
 + 198 (module.c:6110)
 67  Racket                        0x0000000108f5a11f do_start_module +
 255 (module.c:5885)
 68  Racket                        0x0000000108f41515 start_module +
 3749 (module.c:6009)
 69  Racket                        0x0000000108f505e1 parse_requires +
 5905 (module.c:12788)
 70  Racket                        0x0000000108f55b99
 do_namespace_require + 409 (module.c:1548)
 71  Racket                        0x0000000108f3c41f namespace_require
 + 15 (module.c:1553)
 72  ???                            0x000000010a40ffe5 0 + 4466999269
 73  ???                            0x000000010c853629 0 + 4505024041
 74  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 75  Racket                        0x0000000108e31535
 scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 76  Racket                        0x0000000108e31865
 scheme_apply_for_prompt + 101 (fun.c:6735)
 77  Racket                        0x0000000108e212d8 call_with_prompt
 + 2568 (fun.c:7232)
 78  ???                            0x000000010a4133f5 0 + 4467012597
 79  ???                            0x000000010a40540d 0 + 4466955277
 80  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 81  Racket                        0x0000000108e31535
 scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 82  Racket                        0x0000000108e31865
 scheme_apply_for_prompt + 101 (fun.c:6735)
 83  Racket                        0x0000000108e212d8 call_with_prompt
 + 2568 (fun.c:7232)
 84  Racket                        0x0000000108dfbdb5
 _scheme_apply_multi_from_native + 453 (schnapp.inc:33)
 85  ???                            0x000000010c8b2725 0 + 4505413413
 86  ???                            0x000000010c8b0df9 0 + 4505406969
 87  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 88  Racket                        0x0000000108dfbd7c
 _scheme_apply_multi_from_native + 396 (schthread.h:410)
 89  ???                            0x000000010a41116e 0 + 4467003758
 90  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 91  Racket                        0x0000000108e31535
 scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 92  Racket                        0x0000000108e31865
 scheme_apply_for_prompt + 101 (fun.c:6735)
 93  Racket                        0x0000000108e212d8 call_with_prompt
 + 2568 (fun.c:7232)
 94  ???                            0x000000010a405383 0 + 4466955139
 95  Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 96  Racket                        0x0000000108e31535
 scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 97  Racket                        0x0000000108e31865
 scheme_apply_for_prompt + 101 (fun.c:6735)
 98  Racket                        0x0000000108e212d8 call_with_prompt
 + 2568 (fun.c:7232)
 99  ???                            0x000000010a4133f5 0 + 4467012597
 100 Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 101 Racket                        0x0000000108e28283 force_values +
 355 (fun.c:1396)
 102 Racket                        0x0000000108e2831e
 scheme_force_value_same_mark + 110 (fun.c:1442)
 103 ???                            0x000000010a40fb06 0 + 4466998022
 104 Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 105 Racket                        0x0000000108e31535
 scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 106 Racket                        0x0000000108e31865
 scheme_apply_for_prompt + 101 (fun.c:6735)
 107 Racket                        0x0000000108e212d8 call_with_prompt
 + 2568 (fun.c:7232)
 108 ???                            0x000000010a4133f5 0 + 4467012597
 109 Racket                        0x0000000108df8e41 scheme_do_eval +
 5649 (eval.c:3062)
 110 Racket                        0x0000000108e28601 apply_k + 193 (fun.c:1479)
 111 Racket                        0x0000000108e27d12
 scheme_top_level_do_worker + 1858 (fun.c:1303)
 112 Racket                        0x00000001090d0c17 start_child + 903
 (thread.c:3235)
 113 ???                            0x000000010a40d7e7 0 + 4466989031
 114 Racket                        0x00000001090d1722 make_subprocess +
 818 (thread.c:3337)
 115 Racket                        0x00000001090d0f4d
 scheme_thread_w_details + 285 (thread.c:3549)
 
 
 
 On Sat, Nov 18, 2017 at 7:40 AM,  <ylwhj051@163.com> wrote:
 > A new problem report is waiting at
 >   http://bugs.racket-lang.org/query/?cmd=view&pr=15491
 >
 > Reported by ice for release: 6.11
 >
 > *** Description:
 > #lang racket/base
 > (require racket/class racket/math racket/draw)
 > (define bitmap-size 4200)
 > (define font-size (/ bitmap-size 10))
 > (define yuan-2 1600)
 > (define yuan-3 1150)
 > (define yuan-4 750)
 >
 > ;(define na-yin-1 '("1" "2" "3" "4" "5" "6" "7" "8"
 > ;                       "9" "10" "11" "12" "13" "14" "15" ))
 > (define na-yin-2 '("沙中金" "山下火" "平地木" "壁上土" "金箔金" "覆灯火" "天河水" "大驿土"
 >                          "钗钏金" "桑柘木" "大溪水" "沙中土" "天上火" "石榴木" "大海水" ))
 > (define na-yin-shu (length na-yin-2))
 >
 > (define text-target (make-bitmap bitmap-size bitmap-size))
 > (define dc (new bitmap-dc% [bitmap text-target]))
 >
 > (send dc set-pen
 >       (send the-pen-list find-or-create-pen
 >             "blue" (/ bitmap-size 200) 'solid 'projecting))
 > (send dc set-brush "blue" 'transparent)
 > (send dc set-text-foreground "red")
 > (send dc set-font (make-object font% font-size 'roman))
 > (send dc set-origin (/ bitmap-size 2) (/ bitmap-size 2))
 >
 > (for ([j (reverse na-yin-2)])
 >   (send dc draw-text
 >         j
 >         (- (* 2/3 font-size))
 >         (- (/ (+ yuan-3 yuan-2) 2) (* 0.6 font-size)))
 >   (send dc rotate (/ pi na-yin-shu))
 >   (send dc draw-line 0 yuan-4 0 yuan-2)
 >   (send dc rotate (/ pi na-yin-shu)))
 >
 > (send text-target save-file "na-yin.png" 'png)
 >
 > *** How to repeat:
 >
 >
 > *** Environment:
 > windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m) (get-display-depth) = 32
 > Human Language: english
 > (current-memory-use) 379999364
 > raco pkg (show):
 > Installation-wide:
 >  Package            Checksum             Source
 >  main-distribution  2691ecda516c7f3c...  catalog...tribution
 >  racket-lib         db645864e1c06f9c...  catalog racket-lib
 >  [195 auto-installed packages not shown]
 > User-specific for installation "6.11":
 >  [none]
 >
 >
 >
 > Collections:
 > ("C:\\Users\\ice\\AppData\\Roaming\\Racket\\6.11\\collects"
 >  (non-existent-path))
 > ("C:\\Program Files\\Racket\\collects"
 >  ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))
 >
 > Recent Internal Errors:
 > Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((test) (main)) #t))
 >
 
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs <bugs@racket-lang.org>, nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15491: Chinese string problem report
Date: Sat, 18 Nov 2017 08:03:42 -0700

 When I run not in DrRacket, I get
 
  get-point-size: broke its own contract
   promised: (integer-in 1 255)
   produced: 420
   in: the range of
       the get-point-size method in
       font%/c
   contract from: 
       <pkgs>/draw-lib/racket/draw.rkt
   contract on: font%
   blaming: <pkgs>/draw-lib/racket/draw.rkt
    (assuming the contract is correct)
   at: <pkgs>/draw-lib/racket/draw.rkt:79.19
 
 So, it looks like the contract is out of sync. DrRacket crashes because
 the exception is raised in atomic mode.
 
 At Sat, 18 Nov 2017 08:54:35 -0600, Robby Findler wrote:
 > This program causes DrRacket to crash for me. Below is the stack trace.
 > 
 > Robby
 > 
 > Process:               DrRacket [93821]
 > Path:                  /Users/USER/*/DrRacket.app/Contents/MacOS/DrRacket
 > Identifier:            org.racket-lang.DrRacket
 > Version:               6.11.0.2 (6.11.0.2)
 > Code Type:             X86-64 (Native)
 > Parent Process:        ??? [1]
 > Responsible:           DrRacket [93821]
 > User ID:               501
 > 
 > Date/Time:             2017-11-18 08:53:15.774 -0600
 > OS Version:            Mac OS X 10.11.6 (15G17023)
 > Report Version:        11
 > Anonymous UUID:        BEAB3650-647A-76F1-135D-159DF6A06DB6
 > 
 > Sleep/Wake UUID:       BBDABC7A-088E-48BC-BC9E-1E385F5BC2B2
 > 
 > Time Awake Since Boot: 650000 seconds
 > Time Since Wake:       40000 seconds
 > 
 > System Integrity Protection: enabled
 > 
 > Crashed Thread:        0  Dispatch queue: com.apple.main-thread
 > 
 > Exception Type:        EXC_CRASH (SIGABRT)
 > Exception Codes:       0x0000000000000000, 0x0000000000000000
 > Exception Note:        EXC_CORPSE_NOTIFY
 > 
 > Application Specific Information:
 > abort() called
 > 
 > Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
 > 0   libsystem_kernel.dylib        0x00007fffa05f5f06 __pthread_kill + 10
 > 1   libsystem_pthread.dylib        0x00007fffa02e34ec pthread_kill + 90
 > 2   libsystem_c.dylib              0x00007fff97bc96df abort + 129
 > 3   Racket                        0x00000001090d29b7
 > scheme_wait_until_suspend_ok + 215 (thread.c:5168)
 > 4   Racket                        0x000000010906636f
 > scheme_wait_semas_chs + 751 (sema.c:734)
 > 5   Racket                        0x00000001090d7b09
 > scheme_syncing_ready + 1673 (thread.c:6594)
 > 6   Racket                        0x00000001090d4e9d
 > scheme_block_until + 333 (thread.c:4995)
 > 7   Racket                        0x00000001090d91f6 do_sync + 1510
 > (schthread.h:410)
 > 8   Racket                        0x0000000108df76d3
 > _scheme_apply_from_native + 467 (schnapp.inc:33)
 > 9   ???                            0x000000010a40f92f 0 + 4466997551
 > 10  ???                            0x000000010a41379b 0 + 4467013531
 > 11  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 12  Racket                        0x0000000108e2862c apply_k + 236 (fun.c:1481)
 > 13  Racket                        0x0000000108e27d12
 > scheme_top_level_do_worker + 1858 (fun.c:1303)
 > 14  Racket                        0x0000000109003308 user_write_bytes
 > + 904 (portfun.c:1457)
 > 15  Racket                        0x0000000108fe88da
 > scheme_put_byte_string + 234 (port.c:3196)
 > 16  Racket                        0x0000000108ff27ef
 > scheme_redirect_write_bytes + 175 (port.c:5552)
 > 17  Racket                        0x000000010900314d user_write_bytes
 > + 461 (portfun.c:1417)
 > 18  Racket                        0x0000000108fe8af4
 > scheme_put_byte_string + 772 (port.c:3153)
 > 19  Racket                        0x0000000109008efc print_to_port +
 > 348 (print.c:1198)
 > 20  Racket                        0x0000000108ff7654
 > sch_default_display_handler + 148 (portfun.c:4006)
 > 21  ???                            0x000000010a41cac9 0 + 4467051209
 > 22  ???                            0x000000010c85050b 0 + 4505011467
 > 23  ???                            0x0000000116225f5d 0 + 4666318685
 > 24  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 25  Racket                        0x0000000109006970 display_write +
 > 1056 (portfun.c:4131)
 > 26  Racket                        0x0000000108ff73cf display + 31
 > (portfun.c:4143)
 > 27  ???                            0x000000010a419cdb 0 + 4467039451
 > 28  ???                            0x000000010efd79dd 0 + 4546460125
 > 29  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 30  Racket                        0x0000000108e28601 apply_k + 193 (fun.c:1479)
 > 31  Racket                        0x0000000108e27d12
 > scheme_top_level_do_worker + 1858 (fun.c:1303)
 > 32  Racket                        0x0000000108df2d4d call_error + 1293
 > (error.c:999)
 > 33  Racket                        0x0000000108df0ae3 def_exn_handler +
 > 499 (error.c:4581)
 > 34  Racket                        0x0000000108df8c2a scheme_do_eval +
 > 5114 (eval.c:2804)
 > 35  Racket                        0x0000000108df2232
 > do_raise_inside_barrier + 594 (error.c:4684)
 > 36  Racket                        0x0000000108e27d12
 > scheme_top_level_do_worker + 1858 (fun.c:1303)
 > 37  Racket                        0x0000000108dee4f1 do_raise + 609
 > (error.c:4761)
 > 38  ???                            0x000000010a41ac09 0 + 4467043337
 > 39  ???                            0x000000010a4107ad 0 + 4467001261
 > 40  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 41  Racket                        0x0000000108df769a
 > _scheme_apply_from_native + 410 (schthread.h:410)
 > 42  ???                            0x000000010a40f92f 0 + 4466997551
 > 43  ???                            0x000000010a41215b 0 + 4467007835
 > 44  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 45  Racket                        0x0000000108dfbd7c
 > _scheme_apply_multi_from_native + 396 (schthread.h:410)
 > 46  ???                            0x000000010c85217c 0 + 4505018748
 > 47  ???                            0x000000010c8b391b 0 + 4505418011
 > 48  ???                            0x000000010efd623d 0 + 4546454077
 > 49  ???                            0x000000010a40e5e7 0 + 4466992615
 > 50  Racket                        0x0000000108e2c8e2 _apply_native +
 > 194 (fun.c:3730)
 > 51  Racket                        0x0000000108e2d1ca
 > scheme_apply_chaperone + 938 (fun.c:3911)
 > 52  ???                            0x000000010c851eed 0 + 4505018093
 > 53  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 54  Racket                        0x0000000108dfef90
 > apply_values_execute + 208 (eval.c:2223)
 > 55  Racket                        0x0000000108dfab0f scheme_do_eval +
 > 13023 (eval.c:3897)
 > 56  Racket                        0x0000000108f4c152 body_one_expr +
 > 162 (module.c:6120)
 > 57  Racket                        0x0000000108dfb7a2 scheme_do_eval +
 > 16242 (eval.c:3219)
 > 58  Racket                        0x0000000108e31535
 > scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 > 59  Racket                        0x0000000108e31865
 > scheme_apply_for_prompt + 101 (fun.c:6735)
 > 60  Racket                        0x0000000108e212d8 call_with_prompt
 > + 2568 (fun.c:7232)
 > 61  Racket                        0x0000000108df8c2a scheme_do_eval +
 > 5114 (eval.c:2804)
 > 62  Racket                        0x0000000108e32198
 > _scheme_call_with_prompt_multi + 504 (fun.c:7453)
 > 63  Racket                        0x0000000108f4bd4c
 > scheme_module_run_finish + 1260 (module.c:6219)
 > 64  ???                            0x000000010a40d71d 0 + 4466988829
 > 65  ???                            0x000000010a40540d 0 + 4466955277
 > 66  Racket                        0x0000000108f55c96 eval_module_body
 > + 198 (module.c:6110)
 > 67  Racket                        0x0000000108f5a11f do_start_module +
 > 255 (module.c:5885)
 > 68  Racket                        0x0000000108f41515 start_module +
 > 3749 (module.c:6009)
 > 69  Racket                        0x0000000108f505e1 parse_requires +
 > 5905 (module.c:12788)
 > 70  Racket                        0x0000000108f55b99
 > do_namespace_require + 409 (module.c:1548)
 > 71  Racket                        0x0000000108f3c41f namespace_require
 > + 15 (module.c:1553)
 > 72  ???                            0x000000010a40ffe5 0 + 4466999269
 > 73  ???                            0x000000010c853629 0 + 4505024041
 > 74  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 75  Racket                        0x0000000108e31535
 > scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 > 76  Racket                        0x0000000108e31865
 > scheme_apply_for_prompt + 101 (fun.c:6735)
 > 77  Racket                        0x0000000108e212d8 call_with_prompt
 > + 2568 (fun.c:7232)
 > 78  ???                            0x000000010a4133f5 0 + 4467012597
 > 79  ???                            0x000000010a40540d 0 + 4466955277
 > 80  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 81  Racket                        0x0000000108e31535
 > scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 > 82  Racket                        0x0000000108e31865
 > scheme_apply_for_prompt + 101 (fun.c:6735)
 > 83  Racket                        0x0000000108e212d8 call_with_prompt
 > + 2568 (fun.c:7232)
 > 84  Racket                        0x0000000108dfbdb5
 > _scheme_apply_multi_from_native + 453 (schnapp.inc:33)
 > 85  ???                            0x000000010c8b2725 0 + 4505413413
 > 86  ???                            0x000000010c8b0df9 0 + 4505406969
 > 87  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 88  Racket                        0x0000000108dfbd7c
 > _scheme_apply_multi_from_native + 396 (schthread.h:410)
 > 89  ???                            0x000000010a41116e 0 + 4467003758
 > 90  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 91  Racket                        0x0000000108e31535
 > scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 > 92  Racket                        0x0000000108e31865
 > scheme_apply_for_prompt + 101 (fun.c:6735)
 > 93  Racket                        0x0000000108e212d8 call_with_prompt
 > + 2568 (fun.c:7232)
 > 94  ???                            0x000000010a405383 0 + 4466955139
 > 95  Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 96  Racket                        0x0000000108e31535
 > scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 > 97  Racket                        0x0000000108e31865
 > scheme_apply_for_prompt + 101 (fun.c:6735)
 > 98  Racket                        0x0000000108e212d8 call_with_prompt
 > + 2568 (fun.c:7232)
 > 99  ???                            0x000000010a4133f5 0 + 4467012597
 > 100 Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 101 Racket                        0x0000000108e28283 force_values +
 > 355 (fun.c:1396)
 > 102 Racket                        0x0000000108e2831e
 > scheme_force_value_same_mark + 110 (fun.c:1442)
 > 103 ???                            0x000000010a40fb06 0 + 4466998022
 > 104 Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 105 Racket                        0x0000000108e31535
 > scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 > 106 Racket                        0x0000000108e31865
 > scheme_apply_for_prompt + 101 (fun.c:6735)
 > 107 Racket                        0x0000000108e212d8 call_with_prompt
 > + 2568 (fun.c:7232)
 > 108 ???                            0x000000010a4133f5 0 + 4467012597
 > 109 Racket                        0x0000000108df8e41 scheme_do_eval +
 > 5649 (eval.c:3062)
 > 110 Racket                        0x0000000108e28601 apply_k + 193 (fun.c:1479)
 > 111 Racket                        0x0000000108e27d12
 > scheme_top_level_do_worker + 1858 (fun.c:1303)
 > 112 Racket                        0x00000001090d0c17 start_child + 903
 > (thread.c:3235)
 > 113 ???                            0x000000010a40d7e7 0 + 4466989031
 > 114 Racket                        0x00000001090d1722 make_subprocess +
 > 818 (thread.c:3337)
 > 115 Racket                        0x00000001090d0f4d
 > scheme_thread_w_details + 285 (thread.c:3549)
 > 
 > 
 > 
 > On Sat, Nov 18, 2017 at 7:40 AM,  <ylwhj051@163.com> wrote:
 > > A new problem report is waiting at
 > >   http://bugs.racket-lang.org/query/?cmd=view&pr=15491
 > >
 > > Reported by ice for release: 6.11
 > >
 > > *** Description:
 > > #lang racket/base
 > > (require racket/class racket/math racket/draw)
 > > (define bitmap-size 4200)
 > > (define font-size (/ bitmap-size 10))
 > > (define yuan-2 1600)
 > > (define yuan-3 1150)
 > > (define yuan-4 750)
 > >
 > > ;(define na-yin-1 '("1" "2" "3" "4" "5" "6" "7" "8"
 > > ;                       "9" "10" "11" "12" "13" "14" "15" ))
 > > (define na-yin-2 '("沙中金" "山下火" "平地木" "壁上土" "金箔金" "覆灯火" "天河水" 
 > "大驿土"
 > >                          "钗钏金" "桑柘木" "大溪水" "沙中土" "天上火" "石榴木" 
 > "大海水" ))
 > > (define na-yin-shu (length na-yin-2))
 > >
 > > (define text-target (make-bitmap bitmap-size bitmap-size))
 > > (define dc (new bitmap-dc% [bitmap text-target]))
 > >
 > > (send dc set-pen
 > >       (send the-pen-list find-or-create-pen
 > >             "blue" (/ bitmap-size 200) 'solid 'projecting))
 > > (send dc set-brush "blue" 'transparent)
 > > (send dc set-text-foreground "red")
 > > (send dc set-font (make-object font% font-size 'roman))
 > > (send dc set-origin (/ bitmap-size 2) (/ bitmap-size 2))
 > >
 > > (for ([j (reverse na-yin-2)])
 > >   (send dc draw-text
 > >         j
 > >         (- (* 2/3 font-size))
 > >         (- (/ (+ yuan-3 yuan-2) 2) (* 0.6 font-size)))
 > >   (send dc rotate (/ pi na-yin-shu))
 > >   (send dc draw-line 0 yuan-4 0 yuan-2)
 > >   (send dc rotate (/ pi na-yin-shu)))
 > >
 > > (send text-target save-file "na-yin.png" 'png)
 > >
 > > *** How to repeat:
 > >
 > >
 > > *** Environment:
 > > windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m) (get-display-depth) 
 > = 32
 > > Human Language: english
 > > (current-memory-use) 379999364
 > > raco pkg (show):
 > > Installation-wide:
 > >  Package            Checksum             Source
 > >  main-distribution  2691ecda516c7f3c...  catalog...tribution
 > >  racket-lib         db645864e1c06f9c...  catalog racket-lib
 > >  [195 auto-installed packages not shown]
 > > User-specific for installation "6.11":
 > >  [none]
 > >
 > >
 > >
 > > Collections:
 > > ("C:\\Users\\ice\\AppData\\Roaming\\Racket\\6.11\\collects"
 > >  (non-existent-path))
 > > ("C:\\Program Files\\Racket\\collects"
 > >  ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" 
 > "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" 
 > "realm" "s-exp" "setup" "syntax" "version" "xml"))
 > >
 > > Recent Internal Errors:
 > > Computer Language: (("Determine language from source") (#(#t print 
 > mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((test) 
 > (main)) #t))
 > >
 

State changed from "open" to "closed" by robby at Sat, 18 Nov 2017 10:35:42 -0500
Reason>>> 

Thank you for the report. This push fixes it. It will be available in the 
next snapshot build (probably tomorrow), or in a git build now.

https://github.com/racket/draw/commit/3db2557fc09ed9ada94cc50
a06160149b0b13a90

From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs <bugs@racket-lang.org>, nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15491: Chinese string problem report
Date: Sat, 18 Nov 2017 09:34:34 -0600

 Thanks! I've pushed a fix.
 
 Robby
 
 
 On Sat, Nov 18, 2017 at 9:03 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > When I run not in DrRacket, I get
 >
 >  get-point-size: broke its own contract
 >   promised: (integer-in 1 255)
 >   produced: 420
 >   in: the range of
 >       the get-point-size method in
 >       font%/c
 >   contract from:
 >       <pkgs>/draw-lib/racket/draw.rkt
 >   contract on: font%
 >   blaming: <pkgs>/draw-lib/racket/draw.rkt
 >    (assuming the contract is correct)
 >   at: <pkgs>/draw-lib/racket/draw.rkt:79.19
 >
 > So, it looks like the contract is out of sync. DrRacket crashes because
 > the exception is raised in atomic mode.
 >
 > At Sat, 18 Nov 2017 08:54:35 -0600, Robby Findler wrote:
 >> This program causes DrRacket to crash for me. Below is the stack trace.
 >>
 >> Robby
 >>
 >> Process:               DrRacket [93821]
 >> Path:                  /Users/USER/*/DrRacket.app/Contents/MacOS/DrRacket
 >> Identifier:            org.racket-lang.DrRacket
 >> Version:               6.11.0.2 (6.11.0.2)
 >> Code Type:             X86-64 (Native)
 >> Parent Process:        ??? [1]
 >> Responsible:           DrRacket [93821]
 >> User ID:               501
 >>
 >> Date/Time:             2017-11-18 08:53:15.774 -0600
 >> OS Version:            Mac OS X 10.11.6 (15G17023)
 >> Report Version:        11
 >> Anonymous UUID:        BEAB3650-647A-76F1-135D-159DF6A06DB6
 >>
 >> Sleep/Wake UUID:       BBDABC7A-088E-48BC-BC9E-1E385F5BC2B2
 >>
 >> Time Awake Since Boot: 650000 seconds
 >> Time Since Wake:       40000 seconds
 >>
 >> System Integrity Protection: enabled
 >>
 >> Crashed Thread:        0  Dispatch queue: com.apple.main-thread
 >>
 >> Exception Type:        EXC_CRASH (SIGABRT)
 >> Exception Codes:       0x0000000000000000, 0x0000000000000000
 >> Exception Note:        EXC_CORPSE_NOTIFY
 >>
 >> Application Specific Information:
 >> abort() called
 >>
 >> Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
 >> 0   libsystem_kernel.dylib        0x00007fffa05f5f06 __pthread_kill + 10
 >> 1   libsystem_pthread.dylib        0x00007fffa02e34ec pthread_kill + 90
 >> 2   libsystem_c.dylib              0x00007fff97bc96df abort + 129
 >> 3   Racket                        0x00000001090d29b7
 >> scheme_wait_until_suspend_ok + 215 (thread.c:5168)
 >> 4   Racket                        0x000000010906636f
 >> scheme_wait_semas_chs + 751 (sema.c:734)
 >> 5   Racket                        0x00000001090d7b09
 >> scheme_syncing_ready + 1673 (thread.c:6594)
 >> 6   Racket                        0x00000001090d4e9d
 >> scheme_block_until + 333 (thread.c:4995)
 >> 7   Racket                        0x00000001090d91f6 do_sync + 1510
 >> (schthread.h:410)
 >> 8   Racket                        0x0000000108df76d3
 >> _scheme_apply_from_native + 467 (schnapp.inc:33)
 >> 9   ???                            0x000000010a40f92f 0 + 4466997551
 >> 10  ???                            0x000000010a41379b 0 + 4467013531
 >> 11  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 12  Racket                        0x0000000108e2862c apply_k + 236 (fun.c:1481)
 >> 13  Racket                        0x0000000108e27d12
 >> scheme_top_level_do_worker + 1858 (fun.c:1303)
 >> 14  Racket                        0x0000000109003308 user_write_bytes
 >> + 904 (portfun.c:1457)
 >> 15  Racket                        0x0000000108fe88da
 >> scheme_put_byte_string + 234 (port.c:3196)
 >> 16  Racket                        0x0000000108ff27ef
 >> scheme_redirect_write_bytes + 175 (port.c:5552)
 >> 17  Racket                        0x000000010900314d user_write_bytes
 >> + 461 (portfun.c:1417)
 >> 18  Racket                        0x0000000108fe8af4
 >> scheme_put_byte_string + 772 (port.c:3153)
 >> 19  Racket                        0x0000000109008efc print_to_port +
 >> 348 (print.c:1198)
 >> 20  Racket                        0x0000000108ff7654
 >> sch_default_display_handler + 148 (portfun.c:4006)
 >> 21  ???                            0x000000010a41cac9 0 + 4467051209
 >> 22  ???                            0x000000010c85050b 0 + 4505011467
 >> 23  ???                            0x0000000116225f5d 0 + 4666318685
 >> 24  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 25  Racket                        0x0000000109006970 display_write +
 >> 1056 (portfun.c:4131)
 >> 26  Racket                        0x0000000108ff73cf display + 31
 >> (portfun.c:4143)
 >> 27  ???                            0x000000010a419cdb 0 + 4467039451
 >> 28  ???                            0x000000010efd79dd 0 + 4546460125
 >> 29  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 30  Racket                        0x0000000108e28601 apply_k + 193 (fun.c:1479)
 >> 31  Racket                        0x0000000108e27d12
 >> scheme_top_level_do_worker + 1858 (fun.c:1303)
 >> 32  Racket                        0x0000000108df2d4d call_error + 1293
 >> (error.c:999)
 >> 33  Racket                        0x0000000108df0ae3 def_exn_handler +
 >> 499 (error.c:4581)
 >> 34  Racket                        0x0000000108df8c2a scheme_do_eval +
 >> 5114 (eval.c:2804)
 >> 35  Racket                        0x0000000108df2232
 >> do_raise_inside_barrier + 594 (error.c:4684)
 >> 36  Racket                        0x0000000108e27d12
 >> scheme_top_level_do_worker + 1858 (fun.c:1303)
 >> 37  Racket                        0x0000000108dee4f1 do_raise + 609
 >> (error.c:4761)
 >> 38  ???                            0x000000010a41ac09 0 + 4467043337
 >> 39  ???                            0x000000010a4107ad 0 + 4467001261
 >> 40  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 41  Racket                        0x0000000108df769a
 >> _scheme_apply_from_native + 410 (schthread.h:410)
 >> 42  ???                            0x000000010a40f92f 0 + 4466997551
 >> 43  ???                            0x000000010a41215b 0 + 4467007835
 >> 44  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 45  Racket                        0x0000000108dfbd7c
 >> _scheme_apply_multi_from_native + 396 (schthread.h:410)
 >> 46  ???                            0x000000010c85217c 0 + 4505018748
 >> 47  ???                            0x000000010c8b391b 0 + 4505418011
 >> 48  ???                            0x000000010efd623d 0 + 4546454077
 >> 49  ???                            0x000000010a40e5e7 0 + 4466992615
 >> 50  Racket                        0x0000000108e2c8e2 _apply_native +
 >> 194 (fun.c:3730)
 >> 51  Racket                        0x0000000108e2d1ca
 >> scheme_apply_chaperone + 938 (fun.c:3911)
 >> 52  ???                            0x000000010c851eed 0 + 4505018093
 >> 53  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 54  Racket                        0x0000000108dfef90
 >> apply_values_execute + 208 (eval.c:2223)
 >> 55  Racket                        0x0000000108dfab0f scheme_do_eval +
 >> 13023 (eval.c:3897)
 >> 56  Racket                        0x0000000108f4c152 body_one_expr +
 >> 162 (module.c:6120)
 >> 57  Racket                        0x0000000108dfb7a2 scheme_do_eval +
 >> 16242 (eval.c:3219)
 >> 58  Racket                        0x0000000108e31535
 >> scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 >> 59  Racket                        0x0000000108e31865
 >> scheme_apply_for_prompt + 101 (fun.c:6735)
 >> 60  Racket                        0x0000000108e212d8 call_with_prompt
 >> + 2568 (fun.c:7232)
 >> 61  Racket                        0x0000000108df8c2a scheme_do_eval +
 >> 5114 (eval.c:2804)
 >> 62  Racket                        0x0000000108e32198
 >> _scheme_call_with_prompt_multi + 504 (fun.c:7453)
 >> 63  Racket                        0x0000000108f4bd4c
 >> scheme_module_run_finish + 1260 (module.c:6219)
 >> 64  ???                            0x000000010a40d71d 0 + 4466988829
 >> 65  ???                            0x000000010a40540d 0 + 4466955277
 >> 66  Racket                        0x0000000108f55c96 eval_module_body
 >> + 198 (module.c:6110)
 >> 67  Racket                        0x0000000108f5a11f do_start_module +
 >> 255 (module.c:5885)
 >> 68  Racket                        0x0000000108f41515 start_module +
 >> 3749 (module.c:6009)
 >> 69  Racket                        0x0000000108f505e1 parse_requires +
 >> 5905 (module.c:12788)
 >> 70  Racket                        0x0000000108f55b99
 >> do_namespace_require + 409 (module.c:1548)
 >> 71  Racket                        0x0000000108f3c41f namespace_require
 >> + 15 (module.c:1553)
 >> 72  ???                            0x000000010a40ffe5 0 + 4466999269
 >> 73  ???                            0x000000010c853629 0 + 4505024041
 >> 74  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 75  Racket                        0x0000000108e31535
 >> scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 >> 76  Racket                        0x0000000108e31865
 >> scheme_apply_for_prompt + 101 (fun.c:6735)
 >> 77  Racket                        0x0000000108e212d8 call_with_prompt
 >> + 2568 (fun.c:7232)
 >> 78  ???                            0x000000010a4133f5 0 + 4467012597
 >> 79  ???                            0x000000010a40540d 0 + 4466955277
 >> 80  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 81  Racket                        0x0000000108e31535
 >> scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 >> 82  Racket                        0x0000000108e31865
 >> scheme_apply_for_prompt + 101 (fun.c:6735)
 >> 83  Racket                        0x0000000108e212d8 call_with_prompt
 >> + 2568 (fun.c:7232)
 >> 84  Racket                        0x0000000108dfbdb5
 >> _scheme_apply_multi_from_native + 453 (schnapp.inc:33)
 >> 85  ???                            0x000000010c8b2725 0 + 4505413413
 >> 86  ???                            0x000000010c8b0df9 0 + 4505406969
 >> 87  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 88  Racket                        0x0000000108dfbd7c
 >> _scheme_apply_multi_from_native + 396 (schthread.h:410)
 >> 89  ???                            0x000000010a41116e 0 + 4467003758
 >> 90  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 91  Racket                        0x0000000108e31535
 >> scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 >> 92  Racket                        0x0000000108e31865
 >> scheme_apply_for_prompt + 101 (fun.c:6735)
 >> 93  Racket                        0x0000000108e212d8 call_with_prompt
 >> + 2568 (fun.c:7232)
 >> 94  ???                            0x000000010a405383 0 + 4466955139
 >> 95  Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 96  Racket                        0x0000000108e31535
 >> scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 >> 97  Racket                        0x0000000108e31865
 >> scheme_apply_for_prompt + 101 (fun.c:6735)
 >> 98  Racket                        0x0000000108e212d8 call_with_prompt
 >> + 2568 (fun.c:7232)
 >> 99  ???                            0x000000010a4133f5 0 + 4467012597
 >> 100 Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 101 Racket                        0x0000000108e28283 force_values +
 >> 355 (fun.c:1396)
 >> 102 Racket                        0x0000000108e2831e
 >> scheme_force_value_same_mark + 110 (fun.c:1442)
 >> 103 ???                            0x000000010a40fb06 0 + 4466998022
 >> 104 Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 105 Racket                        0x0000000108e31535
 >> scheme_finish_apply_for_prompt + 549 (fun.c:6652)
 >> 106 Racket                        0x0000000108e31865
 >> scheme_apply_for_prompt + 101 (fun.c:6735)
 >> 107 Racket                        0x0000000108e212d8 call_with_prompt
 >> + 2568 (fun.c:7232)
 >> 108 ???                            0x000000010a4133f5 0 + 4467012597
 >> 109 Racket                        0x0000000108df8e41 scheme_do_eval +
 >> 5649 (eval.c:3062)
 >> 110 Racket                        0x0000000108e28601 apply_k + 193 (fun.c:1479)
 >> 111 Racket                        0x0000000108e27d12
 >> scheme_top_level_do_worker + 1858 (fun.c:1303)
 >> 112 Racket                        0x00000001090d0c17 start_child + 903
 >> (thread.c:3235)
 >> 113 ???                            0x000000010a40d7e7 0 + 4466989031
 >> 114 Racket                        0x00000001090d1722 make_subprocess +
 >> 818 (thread.c:3337)
 >> 115 Racket                        0x00000001090d0f4d
 >> scheme_thread_w_details + 285 (thread.c:3549)
 >>
 >>
 >>
 >> On Sat, Nov 18, 2017 at 7:40 AM,  <ylwhj051@163.com> wrote:
 >> > A new problem report is waiting at
 >> >   http://bugs.racket-lang.org/query/?cmd=view&pr=15491
 >> >
 >> > Reported by ice for release: 6.11
 >> >
 >> > *** Description:
 >> > #lang racket/base
 >> > (require racket/class racket/math racket/draw)
 >> > (define bitmap-size 4200)
 >> > (define font-size (/ bitmap-size 10))
 >> > (define yuan-2 1600)
 >> > (define yuan-3 1150)
 >> > (define yuan-4 750)
 >> >
 >> > ;(define na-yin-1 '("1" "2" "3" "4" "5" "6" "7" "8"
 >> > ;                       "9" "10" "11" "12" "13" "14" "15" ))
 >> > (define na-yin-2 '("沙中金" "山下火" "平地木" "壁上土" "金箔金" "覆灯火" "天河水"
 >> "大驿土"
 >> >                          "钗钏金" "桑柘木" "大溪水" "沙中土" "天上火" "石榴木"
 >> "大海水" ))
 >> > (define na-yin-shu (length na-yin-2))
 >> >
 >> > (define text-target (make-bitmap bitmap-size bitmap-size))
 >> > (define dc (new bitmap-dc% [bitmap text-target]))
 >> >
 >> > (send dc set-pen
 >> >       (send the-pen-list find-or-create-pen
 >> >             "blue" (/ bitmap-size 200) 'solid 'projecting))
 >> > (send dc set-brush "blue" 'transparent)
 >> > (send dc set-text-foreground "red")
 >> > (send dc set-font (make-object font% font-size 'roman))
 >> > (send dc set-origin (/ bitmap-size 2) (/ bitmap-size 2))
 >> >
 >> > (for ([j (reverse na-yin-2)])
 >> >   (send dc draw-text
 >> >         j
 >> >         (- (* 2/3 font-size))
 >> >         (- (/ (+ yuan-3 yuan-2) 2) (* 0.6 font-size)))
 >> >   (send dc rotate (/ pi na-yin-shu))
 >> >   (send dc draw-line 0 yuan-4 0 yuan-2)
 >> >   (send dc rotate (/ pi na-yin-shu)))
 >> >
 >> > (send text-target save-file "na-yin.png" 'png)
 >> >
 >> > *** How to repeat:
 >> >
 >> >
 >> > *** Environment:
 >> > windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m) (get-display-depth)
 >> = 32
 >> > Human Language: english
 >> > (current-memory-use) 379999364
 >> > raco pkg (show):
 >> > Installation-wide:
 >> >  Package            Checksum             Source
 >> >  main-distribution  2691ecda516c7f3c...  catalog...tribution
 >> >  racket-lib         db645864e1c06f9c...  catalog racket-lib
 >> >  [195 auto-installed packages not shown]
 >> > User-specific for installation "6.11":
 >> >  [none]
 >> >
 >> >
 >> >
 >> > Collections:
 >> > ("C:\\Users\\ice\\AppData\\Roaming\\Racket\\6.11\\collects"
 >> >  (non-existent-path))
 >> > ("C:\\Program Files\\Racket\\collects"
 >> >  ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain"
 >> "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader"
 >> "realm" "s-exp" "setup" "syntax" "version" "xml"))
 >> >
 >> > Recent Internal Errors:
 >> > Computer Language: (("Determine language from source") (#(#t print
 >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((test)
 >> (main)) #t))
 >> >
 
