From bugs+caf_=bugs=bugs.plt-scheme.org@plt-scheme.org Sat Aug 17 16:55:04 2013
Received: from mail-ob0-f181.google.com (mail-ob0-f181.google.com [209.85.214.181])
	by champlain.ccs.neu.edu (8.14.4/8.14.4) with ESMTP id r7HKsxuF027188
	for <bugs@bugs.plt-scheme.org>; Sat, 17 Aug 2013 16:55:00 -0400
Message-Id: <201308172054.r7HKsvRn027183@champlain.ccs.neu.edu>
Date: Sat, 17 Aug 2013 16:54:57 -0400
From: gustavo@oma.org.ar
To: bugs@racket-lang.org
Subject: No source location highlighting for errors inside begin-for-syntax

>Number:         13972
>Category:       all
>Synopsis:       No source location highlighting for errors inside begin-for-syntax
>Class:          change-request
>Responsible:    nobody
>Severity:       non-critical
>Priority:       medium
>State:          closed
>Confidential:   no
>Arrival-Date:   Sat Aug 17 16:56:01 -0400 2013
>Closed-Date:    Mon Oct 21 10:13:37 -0400 2013
>Last-Modified:  Mon Oct 21 10:13:37 -0400 2013
>Originator:     Gustavo Massaccesi
>Organization:
plt
>Submitter-Id:   unknown
>Release:        5.3.6
>Environment:
windows "Windows NT 5.1 (Build 2600) Service Pack 3" (win32\i386\3m) (get-display-depth) = 32
Human Language: english
(current-memory-use) 209179864
Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links #:user? #f #:root? #t) = ()
raco pkg (show):
Installation-wide:
 [none]
User-specific, all-version:
 [none]
User-specific, version-specific (5.3.6):
 [none]



Collections:
("C:\\Documents and Settings\\User\\Datos de programa\\Racket\\5.3.6\\collects"
 ("info-domain"))
("C:\\Archivos de programa\\Racket\\collects"
 ("2htdp" "algol60" "at-exp" "browser" "compatibility" "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm" "drracket" "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework" "frtime" "future-visualizer" "games" "graphics" "gui-debugger" "help" "hierlist" "htdp" "html" "icons" "images" "info-domain" "json" "lang" "launcher" "lazy" "macro-debugger" "make" "math" "mred" "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools" "picturing-programs" "pkg" "plai" "planet" "plot" "preprocessor" "profile" "r5rs" "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "realm" "redex" "rnrs" "s-exp" "scheme" "schemeunit" "scribble" "scribblings" "scriblib" "setup" "sgl" "slatex" "slideshow" "srfi" "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack" "test-engine" "texpict" "trace" "typed" "typed-racket" "typed-scheme" "unstable" "version" "web-server" "wxme" "xml" "xrepl"))

Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t none) (default) #() "#lang racket\n" #f #f ((main) (test))))
>Description:
(This is more a feature request than a bug report.)

When there is an exceptions from code in phase > 0 (for example inside a begin-for-syntax block) the source location of the error aren't highlighted, and there is no go-to-error-button 
>How-To-Repeat:
Run  these programs in DrRacket

;---- error at compile-time
#lang racket
(begin-for-syntax bad)   
;==> <error> 
;bad: undefined;
; cannot reference an identifier before its definition
;  phase: 1;
;----
; expected: stop-sign-icon 


;---- error at run-time
;#lang racket
;(begin-for-syntax (display))
;==> <error> 
;display: arity mismatch;
; the expected number of arguments does not match the given number
;  expected: 1 to 2
;  given: 0
;----
;expected: stop-signs-icon 
>Fix:
>Audit-Trail:
From: Robby Findler <robby@eecs.northwestern.edu>
To: Gustavo Massaccesi <gustavo@oma.org.ar>, bugs <bugs@racket-lang.org>
Cc: nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/13972: No source location highlighting for
 errors inside begin-for-syntax
Date: Sat, 17 Aug 2013 16:35:03 -0500

 --089e0158adfee9776404e42b7af1
 Content-Type: text/plain; charset=UTF-8
 
 These don't seem to be specific to DrRacket: I see the same behavior in
 racket at the command-line. As far as I can tell, the information to
 display is not in the exn records.
 
 Robby
 
 
 
 On Sat, Aug 17, 2013 at 3:56 PM, <gustavo@oma.org.ar> wrote:
 
 > A new problem report is waiting at
 >   http://bugs.racket-lang.org/query/?cmd=view&pr=13972
 >
 > Reported by Gustavo Massaccesi for release: 5.3.6
 >
 > *** Description:
 > (This is more a feature request than a bug report.)
 >
 > When there is an exceptions from code in phase > 0 (for example inside a
 > begin-for-syntax block) the source location of the error aren't
 > highlighted, and there is no go-to-error-button
 >
 > *** How to repeat:
 > Run  these programs in DrRacket
 >
 > ;---- error at compile-time
 > #lang racket
 > (begin-for-syntax bad)
 > ;==> <error>
 > ;bad: undefined;
 > ; cannot reference an identifier before its definition
 > ;  phase: 1;
 > ;----
 > ; expected: stop-sign-icon
 >
 >
 > ;---- error at run-time
 > ;#lang racket
 > ;(begin-for-syntax (display))
 > ;==> <error>
 > ;display: arity mismatch;
 > ; the expected number of arguments does not match the given number
 > ;  expected: 1 to 2
 > ;  given: 0
 > ;----
 > ;expected: stop-signs-icon
 >
 > *** Environment:
 > windows "Windows NT 5.1 (Build 2600) Service Pack 3" (win32\i386\3m)
 > (get-display-depth) = 32
 > Human Language: english
 > (current-memory-use) 209179864
 > Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = ();
 > (links #:user? #f #:root? #t) = ()
 > raco pkg (show):
 > Installation-wide:
 >  [none]
 > User-specific, all-version:
 >  [none]
 > User-specific, version-specific (5.3.6):
 >  [none]
 >
 >
 >
 > Collections:
 > ("C:\\Documents and Settings\\User\\Datos de
 > programa\\Racket\\5.3.6\\collects"
 >  ("info-domain"))
 > ("C:\\Archivos de programa\\Racket\\collects"
 >  ("2htdp" "algol60" "at-exp" "browser" "compatibility" "compiler" "config"
 > "data" "datalog" "db" "defaults" "deinprogramm" "drracket" "drscheme"
 > "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework"
 > "frtime" "future-visualizer" "games" "graphics" "gui-debugger" "help"
 > "hierlist" "htdp" "html" "icons" "images" "info-domain" "json" "lang"
 > "launcher" "lazy" "macro-debugger" "make" "math" "mred" "mrlib" "mysterx"
 > "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 > "picturing-programs" "pkg" "plai" "planet" "plot" "preprocessor" "profile"
 > "r5rs" "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline"
 > "realm" "redex" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 > "scribblings" "scriblib" "setup" "sgl" "slatex" "slideshow" "srfi"
 > "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 > "test-engine" "texpict" "trace" "typed" "typed-racket" "typed-scheme"
 > "unstable" "version" "web-server" "wxme" "xml" "xrepl"))
 >
 > Computer Language: (("Determine language from source") (#(#t print
 > mixed-fraction-e #f #t none) (default) #() "#lang racket\n" #f #f ((main)
 > (test))))
 >
 >
 
 --089e0158adfee9776404e42b7af1
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div dir=3D"ltr">These don&#39;t seem to be specific to DrRacket: I see the=
  same behavior in racket at the command-line. As far as I can tell, the inf=
 ormation to display is not in the exn records.<div><br></div><div>Robby</di=
 v>
 <div><br></div></div><div class=3D"gmail_extra"><br><br><div class=3D"gmail=
 _quote">On Sat, Aug 17, 2013 at 3:56 PM,  <span dir=3D"ltr">&lt;<a href=3D"=
 mailto:gustavo@oma.org.ar" target=3D"_blank">gustavo@oma.org.ar</a>&gt;</sp=
 an> wrote:<br>
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex">A new problem report is waiting at<br>
 =C2=A0 <a href=3D"http://bugs.racket-lang.org/query/?cmd=3Dview&amp;pr=3D13=
 972" target=3D"_blank">http://bugs.racket-lang.org/query/?cmd=3Dview&amp;pr=
 =3D13972</a><br>
 <br>
 Reported by Gustavo Massaccesi for release: 5.3.6<br>
 <br>
 *** Description:<br>
 (This is more a feature request than a bug report.)<br>
 <br>
 When there is an exceptions from code in phase &gt; 0 (for example inside a=
  begin-for-syntax block) the source location of the error aren&#39;t highli=
 ghted, and there is no go-to-error-button<br>
 <br>
 *** How to repeat:<br>
 Run =C2=A0these programs in DrRacket<br>
 <br>
 ;---- error at compile-time<br>
 #lang racket<br>
 (begin-for-syntax bad)<br>
 ;=3D=3D&gt; &lt;error&gt;<br>
 ;bad: undefined;<br>
 ; cannot reference an identifier before its definition<br>
 ; =C2=A0phase: 1;<br>
 ;----<br>
 ; expected: stop-sign-icon<br>
 <br>
 <br>
 ;---- error at run-time<br>
 ;#lang racket<br>
 ;(begin-for-syntax (display))<br>
 ;=3D=3D&gt; &lt;error&gt;<br>
 ;display: arity mismatch;<br>
 ; the expected number of arguments does not match the given number<br>
 ; =C2=A0expected: 1 to 2<br>
 ; =C2=A0given: 0<br>
 ;----<br>
 ;expected: stop-signs-icon<br>
 <br>
 *** Environment:<br>
 windows &quot;Windows NT 5.1 (Build 2600) Service Pack 3&quot; (win32\i386\=
 3m) (get-display-depth) =3D 32<br>
 Human Language: english<br>
 (current-memory-use) 209179864<br>
 Links: (links) =3D (); (links #:user? #f) =3D (); (links #:root? #t) =3D ()=
 ; (links #:user? #f #:root? #t) =3D ()<br>
 raco pkg (show):<br>
 Installation-wide:<br>
 =C2=A0[none]<br>
 User-specific, all-version:<br>
 =C2=A0[none]<br>
 User-specific, version-specific (5.3.6):<br>
 =C2=A0[none]<br>
 <br>
 <br>
 <br>
 Collections:<br>
 (&quot;C:\\Documents and Settings\\User\\Datos de programa\\Racket\\5.3.6\\=
 collects&quot;<br>
 =C2=A0(&quot;info-domain&quot;))<br>
 (&quot;C:\\Archivos de programa\\Racket\\collects&quot;<br>
 =C2=A0(&quot;2htdp&quot; &quot;algol60&quot; &quot;at-exp&quot; &quot;brows=
 er&quot; &quot;compatibility&quot; &quot;compiler&quot; &quot;config&quot; =
 &quot;data&quot; &quot;datalog&quot; &quot;db&quot; &quot;defaults&quot; &q=
 uot;deinprogramm&quot; &quot;drracket&quot; &quot;drscheme&quot; &quot;dyne=
 xt&quot; &quot;embedded-gui&quot; &quot;eopl&quot; &quot;errortrace&quot; &=
 quot;ffi&quot; &quot;file&quot; &quot;framework&quot; &quot;frtime&quot; &q=
 uot;future-visualizer&quot; &quot;games&quot; &quot;graphics&quot; &quot;gu=
 i-debugger&quot; &quot;help&quot; &quot;hierlist&quot; &quot;htdp&quot; &qu=
 ot;html&quot; &quot;icons&quot; &quot;images&quot; &quot;info-domain&quot; =
 &quot;json&quot; &quot;lang&quot; &quot;launcher&quot; &quot;lazy&quot; &qu=
 ot;macro-debugger&quot; &quot;make&quot; &quot;math&quot; &quot;mred&quot; =
 &quot;mrlib&quot; &quot;mysterx&quot; &quot;mzcom&quot; &quot;mzlib&quot; &=
 quot;mzscheme&quot; &quot;net&quot; &quot;openssl&quot; &quot;parser-tools&=
 quot; &quot;picturing-programs&quot; &quot;pkg&quot; &quot;plai&quot; &quot=
 ;planet&quot; &quot;plot&quot; &quot;preprocessor&quot; &quot;profile&quot;=
  &quot;r5rs&quot; &quot;r6rs&quot; &quot;racket&quot; &quot;racklog&quot; &=
 quot;rackunit&quot; &quot;raco&quot; &quot;reader&quot; &quot;readline&quot=
 ; &quot;realm&quot; &quot;redex&quot; &quot;rnrs&quot; &quot;s-exp&quot; &q=
 uot;scheme&quot; &quot;schemeunit&quot; &quot;scribble&quot; &quot;scribbli=
 ngs&quot; &quot;scriblib&quot; &quot;setup&quot; &quot;sgl&quot; &quot;slat=
 ex&quot; &quot;slideshow&quot; &quot;srfi&quot; &quot;stepper&quot; &quot;s=
 tring-constants&quot; &quot;swindle&quot; &quot;syntax&quot; &quot;syntax-c=
 olor&quot; &quot;teachpack&quot; &quot;test-engine&quot; &quot;texpict&quot=
 ; &quot;trace&quot; &quot;typed&quot; &quot;typed-racket&quot; &quot;typed-=
 scheme&quot; &quot;unstable&quot; &quot;version&quot; &quot;web-server&quot=
 ; &quot;wxme&quot; &quot;xml&quot; &quot;xrepl&quot;))<br>
 
 <br>
 Computer Language: ((&quot;Determine language from source&quot;) (#(#t prin=
 t mixed-fraction-e #f #t none) (default) #() &quot;#lang racket\n&quot; #f =
 #f ((main) (test))))<br>
 <br>
 </blockquote></div><br></div>
 
 --089e0158adfee9776404e42b7af1--
From: Gustavo Massaccesi <gustavo@oma.org.ar>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs <bugs@racket-lang.org>, nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/13972: No source location highlighting for
 errors inside begin-for-syntax
Date: Sun, 18 Aug 2013 11:36:30 -0300

 I agree. My uninformed guess is that the problem is related to
 begin-for-syntax and not with DrRacket.
 
 I tried to write an example that doesn't depend on DrRacket using
 with-handlers and exn-continuation-marks but the code too long and
 complex and I was not even sure that I was dealing with all the
 details correctly. (For example: Should I use error-trace? The
 debugging/no-debugging and preserve stacktrace language options change
 the information in the error.)
 
 So finally I decided to send the firsts versions, that are small and simple.
 
 Gustavo
 
 On Sat, Aug 17, 2013 at 6:35 PM, Robby Findler
 <robby@eecs.northwestern.edu> wrote:
 > These don't seem to be specific to DrRacket: I see the same behavior in
 > racket at the command-line. As far as I can tell, the information to display
 > is not in the exn records.
 >
 > Robby
 >
 >
 >
 > On Sat, Aug 17, 2013 at 3:56 PM, <gustavo@oma.org.ar> wrote:
 >>
 >> A new problem report is waiting at
 >>   http://bugs.racket-lang.org/query/?cmd=view&pr=13972
 >>
 >> Reported by Gustavo Massaccesi for release: 5.3.6
 >>
 >> *** Description:
 >> (This is more a feature request than a bug report.)
 >>
 >> When there is an exceptions from code in phase > 0 (for example inside a
 >> begin-for-syntax block) the source location of the error aren't highlighted,
 >> and there is no go-to-error-button
 >>
 >> *** How to repeat:
 >> Run  these programs in DrRacket
 >>
 >> ;---- error at compile-time
 >> #lang racket
 >> (begin-for-syntax bad)
 >> ;==> <error>
 >> ;bad: undefined;
 >> ; cannot reference an identifier before its definition
 >> ;  phase: 1;
 >> ;----
 >> ; expected: stop-sign-icon
 >>
 >>
 >> ;---- error at run-time
 >> ;#lang racket
 >> ;(begin-for-syntax (display))
 >> ;==> <error>
 >> ;display: arity mismatch;
 >> ; the expected number of arguments does not match the given number
 >> ;  expected: 1 to 2
 >> ;  given: 0
 >> ;----
 >> ;expected: stop-signs-icon
 >>
 >> *** Environment:
 >> windows "Windows NT 5.1 (Build 2600) Service Pack 3" (win32\i386\3m)
 >> (get-display-depth) = 32
 >> Human Language: english
 >> (current-memory-use) 209179864
 >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = ();
 >> (links #:user? #f #:root? #t) = ()
 >> raco pkg (show):
 >> Installation-wide:
 >>  [none]
 >> User-specific, all-version:
 >>  [none]
 >> User-specific, version-specific (5.3.6):
 >>  [none]
 >>
 >>
 >>
 >> Collections:
 >> ("C:\\Documents and Settings\\User\\Datos de
 >> programa\\Racket\\5.3.6\\collects"
 >>  ("info-domain"))
 >> ("C:\\Archivos de programa\\Racket\\collects"
 >>  ("2htdp" "algol60" "at-exp" "browser" "compatibility" "compiler" "config"
 >> "data" "datalog" "db" "defaults" "deinprogramm" "drracket" "drscheme"
 >> "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework"
 >> "frtime" "future-visualizer" "games" "graphics" "gui-debugger" "help"
 >> "hierlist" "htdp" "html" "icons" "images" "info-domain" "json" "lang"
 >> "launcher" "lazy" "macro-debugger" "make" "math" "mred" "mrlib" "mysterx"
 >> "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >> "picturing-programs" "pkg" "plai" "planet" "plot" "preprocessor" "profile"
 >> "r5rs" "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline"
 >> "realm" "redex" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 >> "scribblings" "scriblib" "setup" "sgl" "slatex" "slideshow" "srfi" "stepper"
 >> "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >> "test-engine" "texpict" "trace" "typed" "typed-racket" "typed-scheme"
 >> "unstable" "version" "web-server" "wxme" "xml" "xrepl"))
 >>
 >> Computer Language: (("Determine language from source") (#(#t print
 >> mixed-fraction-e #f #t none) (default) #() "#lang racket\n" #f #f ((main)
 >> (test))))
 >>
 >
From: Robby Findler <robby@eecs.northwestern.edu>
To: Gustavo Massaccesi <gustavo@oma.org.ar>
Cc: bugs <bugs@racket-lang.org>, nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/13972: No source location highlighting for
 errors inside begin-for-syntax
Date: Sun, 18 Aug 2013 15:48:13 -0500

 --001a1133458e3ca77104e43ef14f
 Content-Type: text/plain; charset=UTF-8
 
 Thanks for your efforts!
 
 FWIW, this transcript seems to indicate that the exn is missing the info:
 
 [robby@yanpu] ~$ cat > ~/tmp.rkt
 #lang racket
 (begin-for-syntax bad)
 
 [robby@yanpu] ~$ racket
 Welcome to Racket v5.90.0.7.
 > (dynamic-require "tmp.rkt" #f)
 bad: undefined;
  cannot reference an identifier before its definition
   in module: 'tmp
   phase: 1
   context...:
    standard-module-name-resolver
    /Users/robby/git/plt/racket/collects/racket/private/misc.rkt:87:7
 
 
 [robby@yanpu] ~$ racket
 Welcome to Racket v5.90.0.7.
 > (require errortrace)
 > (dynamic-require "tmp.rkt" #f)
 bad: undefined;
  cannot reference an identifier before its definition
   in module: 'tmp
   phase: 1
   errortrace...:
   context...:
 
  /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/errortrace-lib.rkt:434:2:
 errortrace-annotate
 
  /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/errortrace-lib.rkt:480:4
    standard-module-name-resolver
    /Users/robby/git/plt/racket/collects/racket/private/misc.rkt:87:7
 
 
 
 
 
 
 On Sun, Aug 18, 2013 at 9:36 AM, Gustavo Massaccesi <gustavo@oma.org.ar>wrote:
 
 > I agree. My uninformed guess is that the problem is related to
 > begin-for-syntax and not with DrRacket.
 >
 > I tried to write an example that doesn't depend on DrRacket using
 > with-handlers and exn-continuation-marks but the code too long and
 > complex and I was not even sure that I was dealing with all the
 > details correctly. (For example: Should I use error-trace? The
 > debugging/no-debugging and preserve stacktrace language options change
 > the information in the error.)
 >
 > So finally I decided to send the firsts versions, that are small and
 > simple.
 >
 > Gustavo
 >
 > On Sat, Aug 17, 2013 at 6:35 PM, Robby Findler
 > <robby@eecs.northwestern.edu> wrote:
 > > These don't seem to be specific to DrRacket: I see the same behavior in
 > > racket at the command-line. As far as I can tell, the information to
 > display
 > > is not in the exn records.
 > >
 > > Robby
 > >
 > >
 > >
 > > On Sat, Aug 17, 2013 at 3:56 PM, <gustavo@oma.org.ar> wrote:
 > >>
 > >> A new problem report is waiting at
 > >>   http://bugs.racket-lang.org/query/?cmd=view&pr=13972
 > >>
 > >> Reported by Gustavo Massaccesi for release: 5.3.6
 > >>
 > >> *** Description:
 > >> (This is more a feature request than a bug report.)
 > >>
 > >> When there is an exceptions from code in phase > 0 (for example inside a
 > >> begin-for-syntax block) the source location of the error aren't
 > highlighted,
 > >> and there is no go-to-error-button
 > >>
 > >> *** How to repeat:
 > >> Run  these programs in DrRacket
 > >>
 > >> ;---- error at compile-time
 > >> #lang racket
 > >> (begin-for-syntax bad)
 > >> ;==> <error>
 > >> ;bad: undefined;
 > >> ; cannot reference an identifier before its definition
 > >> ;  phase: 1;
 > >> ;----
 > >> ; expected: stop-sign-icon
 > >>
 > >>
 > >> ;---- error at run-time
 > >> ;#lang racket
 > >> ;(begin-for-syntax (display))
 > >> ;==> <error>
 > >> ;display: arity mismatch;
 > >> ; the expected number of arguments does not match the given number
 > >> ;  expected: 1 to 2
 > >> ;  given: 0
 > >> ;----
 > >> ;expected: stop-signs-icon
 > >>
 > >> *** Environment:
 > >> windows "Windows NT 5.1 (Build 2600) Service Pack 3" (win32\i386\3m)
 > >> (get-display-depth) = 32
 > >> Human Language: english
 > >> (current-memory-use) 209179864
 > >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = ();
 > >> (links #:user? #f #:root? #t) = ()
 > >> raco pkg (show):
 > >> Installation-wide:
 > >>  [none]
 > >> User-specific, all-version:
 > >>  [none]
 > >> User-specific, version-specific (5.3.6):
 > >>  [none]
 > >>
 > >>
 > >>
 > >> Collections:
 > >> ("C:\\Documents and Settings\\User\\Datos de
 > >> programa\\Racket\\5.3.6\\collects"
 > >>  ("info-domain"))
 > >> ("C:\\Archivos de programa\\Racket\\collects"
 > >>  ("2htdp" "algol60" "at-exp" "browser" "compatibility" "compiler"
 > "config"
 > >> "data" "datalog" "db" "defaults" "deinprogramm" "drracket" "drscheme"
 > >> "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework"
 > >> "frtime" "future-visualizer" "games" "graphics" "gui-debugger" "help"
 > >> "hierlist" "htdp" "html" "icons" "images" "info-domain" "json" "lang"
 > >> "launcher" "lazy" "macro-debugger" "make" "math" "mred" "mrlib"
 > "mysterx"
 > >> "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 > >> "picturing-programs" "pkg" "plai" "planet" "plot" "preprocessor"
 > "profile"
 > >> "r5rs" "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline"
 > >> "realm" "redex" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 > >> "scribblings" "scriblib" "setup" "sgl" "slatex" "slideshow" "srfi"
 > "stepper"
 > >> "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 > >> "test-engine" "texpict" "trace" "typed" "typed-racket" "typed-scheme"
 > >> "unstable" "version" "web-server" "wxme" "xml" "xrepl"))
 > >>
 > >> Computer Language: (("Determine language from source") (#(#t print
 > >> mixed-fraction-e #f #t none) (default) #() "#lang racket\n" #f #f
 > ((main)
 > >> (test))))
 > >>
 > >
 >
 
 --001a1133458e3ca77104e43ef14f
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div dir=3D"ltr">Thanks for your efforts!<div><br></div><div>FWIW, this tra=
 nscript seems to indicate that the exn is missing the info:</div><div><br><=
 /div><div><div>[robby@yanpu] ~$ cat &gt; ~/tmp.rkt</div><div>#lang racket</=
 div>
 <div>(begin-for-syntax bad)</div><div><br></div><div>[robby@yanpu] ~$ racke=
 t<br></div><div>Welcome to Racket v5.90.0.7.</div><div>&gt; (dynamic-requir=
 e &quot;tmp.rkt&quot; #f)</div><div>bad: undefined;</div><div>=C2=A0cannot =
 reference an identifier before its definition</div>
 <div>=C2=A0 in module: &#39;tmp</div><div>=C2=A0 phase: 1</div><div>=C2=A0 =
 context...:</div><div>=C2=A0 =C2=A0standard-module-name-resolver</div><div>=
 =C2=A0 =C2=A0/Users/robby/git/plt/racket/collects/racket/private/misc.rkt:8=
 7:7</div><div><br></div><div><br>
 </div><div><div>[robby@yanpu] ~$ racket=C2=A0</div><div>Welcome to Racket v=
 5.90.0.7.</div><div>&gt; (require errortrace)</div></div><div><div>&gt; (dy=
 namic-require &quot;tmp.rkt&quot; #f)</div><div>bad: undefined;</div><div>=
 =C2=A0cannot reference an identifier before its definition</div>
 <div>=C2=A0 in module: &#39;tmp</div><div>=C2=A0 phase: 1</div><div>=C2=A0 =
 errortrace...:</div><div>=C2=A0 context...:</div><div>=C2=A0 =C2=A0/Users/r=
 obby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/errortrace-lib.=
 rkt:434:2: errortrace-annotate</div>
 <div>=C2=A0 =C2=A0/Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/=
 errortrace/errortrace-lib.rkt:480:4</div><div>=C2=A0 =C2=A0standard-module-=
 name-resolver</div><div>=C2=A0 =C2=A0/Users/robby/git/plt/racket/collects/r=
 acket/private/misc.rkt:87:7</div>
 </div><div><br></div><div><br></div><div><br></div><div>=C2=A0</div></div><=
 /div><div class=3D"gmail_extra"><br><br><div class=3D"gmail_quote">On Sun, =
 Aug 18, 2013 at 9:36 AM, Gustavo Massaccesi <span dir=3D"ltr">&lt;<a href=
 =3D"mailto:gustavo@oma.org.ar" target=3D"_blank">gustavo@oma.org.ar</a>&gt;=
 </span> wrote:<br>
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex">I agree. My uninformed guess is that the pro=
 blem is related to<br>
 begin-for-syntax and not with DrRacket.<br>
 <br>
 I tried to write an example that doesn&#39;t depend on DrRacket using<br>
 with-handlers and exn-continuation-marks but the code too long and<br>
 complex and I was not even sure that I was dealing with all the<br>
 details correctly. (For example: Should I use error-trace? The<br>
 debugging/no-debugging and preserve stacktrace language options change<br>
 the information in the error.)<br>
 <br>
 So finally I decided to send the firsts versions, that are small and simple=
 .<br>
 <span class=3D"HOEnZb"><font color=3D"#888888"><br>
 Gustavo<br>
 </font></span><div class=3D"HOEnZb"><div class=3D"h5"><br>
 On Sat, Aug 17, 2013 at 6:35 PM, Robby Findler<br>
 &lt;<a href=3D"mailto:robby@eecs.northwestern.edu">robby@eecs.northwestern.=
 edu</a>&gt; wrote:<br>
 &gt; These don&#39;t seem to be specific to DrRacket: I see the same behavi=
 or in<br>
 &gt; racket at the command-line. As far as I can tell, the information to d=
 isplay<br>
 &gt; is not in the exn records.<br>
 &gt;<br>
 &gt; Robby<br>
 &gt;<br>
 &gt;<br>
 &gt;<br>
 &gt; On Sat, Aug 17, 2013 at 3:56 PM, &lt;<a href=3D"mailto:gustavo@oma.org=
 .ar">gustavo@oma.org.ar</a>&gt; wrote:<br>
 &gt;&gt;<br>
 &gt;&gt; A new problem report is waiting at<br>
 &gt;&gt; =C2=A0 <a href=3D"http://bugs.racket-lang.org/query/?cmd=3Dview&am=
 p;pr=3D13972" target=3D"_blank">http://bugs.racket-lang.org/query/?cmd=3Dvi=
 ew&amp;pr=3D13972</a><br>
 &gt;&gt;<br>
 &gt;&gt; Reported by Gustavo Massaccesi for release: 5.3.6<br>
 &gt;&gt;<br>
 &gt;&gt; *** Description:<br>
 &gt;&gt; (This is more a feature request than a bug report.)<br>
 &gt;&gt;<br>
 &gt;&gt; When there is an exceptions from code in phase &gt; 0 (for example=
  inside a<br>
 &gt;&gt; begin-for-syntax block) the source location of the error aren&#39;=
 t highlighted,<br>
 &gt;&gt; and there is no go-to-error-button<br>
 &gt;&gt;<br>
 &gt;&gt; *** How to repeat:<br>
 &gt;&gt; Run =C2=A0these programs in DrRacket<br>
 &gt;&gt;<br>
 &gt;&gt; ;---- error at compile-time<br>
 &gt;&gt; #lang racket<br>
 &gt;&gt; (begin-for-syntax bad)<br>
 &gt;&gt; ;=3D=3D&gt; &lt;error&gt;<br>
 &gt;&gt; ;bad: undefined;<br>
 &gt;&gt; ; cannot reference an identifier before its definition<br>
 &gt;&gt; ; =C2=A0phase: 1;<br>
 &gt;&gt; ;----<br>
 &gt;&gt; ; expected: stop-sign-icon<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt; ;---- error at run-time<br>
 &gt;&gt; ;#lang racket<br>
 &gt;&gt; ;(begin-for-syntax (display))<br>
 &gt;&gt; ;=3D=3D&gt; &lt;error&gt;<br>
 &gt;&gt; ;display: arity mismatch;<br>
 &gt;&gt; ; the expected number of arguments does not match the given number=
 <br>
 &gt;&gt; ; =C2=A0expected: 1 to 2<br>
 &gt;&gt; ; =C2=A0given: 0<br>
 &gt;&gt; ;----<br>
 &gt;&gt; ;expected: stop-signs-icon<br>
 &gt;&gt;<br>
 &gt;&gt; *** Environment:<br>
 &gt;&gt; windows &quot;Windows NT 5.1 (Build 2600) Service Pack 3&quot; (wi=
 n32\i386\3m)<br>
 &gt;&gt; (get-display-depth) =3D 32<br>
 &gt;&gt; Human Language: english<br>
 &gt;&gt; (current-memory-use) 209179864<br>
 &gt;&gt; Links: (links) =3D (); (links #:user? #f) =3D (); (links #:root? #=
 t) =3D ();<br>
 &gt;&gt; (links #:user? #f #:root? #t) =3D ()<br>
 &gt;&gt; raco pkg (show):<br>
 &gt;&gt; Installation-wide:<br>
 &gt;&gt; =C2=A0[none]<br>
 &gt;&gt; User-specific, all-version:<br>
 &gt;&gt; =C2=A0[none]<br>
 &gt;&gt; User-specific, version-specific (5.3.6):<br>
 &gt;&gt; =C2=A0[none]<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt; Collections:<br>
 &gt;&gt; (&quot;C:\\Documents and Settings\\User\\Datos de<br>
 &gt;&gt; programa\\Racket\\5.3.6\\collects&quot;<br>
 &gt;&gt; =C2=A0(&quot;info-domain&quot;))<br>
 &gt;&gt; (&quot;C:\\Archivos de programa\\Racket\\collects&quot;<br>
 &gt;&gt; =C2=A0(&quot;2htdp&quot; &quot;algol60&quot; &quot;at-exp&quot; &q=
 uot;browser&quot; &quot;compatibility&quot; &quot;compiler&quot; &quot;conf=
 ig&quot;<br>
 &gt;&gt; &quot;data&quot; &quot;datalog&quot; &quot;db&quot; &quot;defaults=
 &quot; &quot;deinprogramm&quot; &quot;drracket&quot; &quot;drscheme&quot;<b=
 r>
 &gt;&gt; &quot;dynext&quot; &quot;embedded-gui&quot; &quot;eopl&quot; &quot=
 ;errortrace&quot; &quot;ffi&quot; &quot;file&quot; &quot;framework&quot;<br=
 >
 &gt;&gt; &quot;frtime&quot; &quot;future-visualizer&quot; &quot;games&quot;=
  &quot;graphics&quot; &quot;gui-debugger&quot; &quot;help&quot;<br>
 &gt;&gt; &quot;hierlist&quot; &quot;htdp&quot; &quot;html&quot; &quot;icons=
 &quot; &quot;images&quot; &quot;info-domain&quot; &quot;json&quot; &quot;la=
 ng&quot;<br>
 &gt;&gt; &quot;launcher&quot; &quot;lazy&quot; &quot;macro-debugger&quot; &=
 quot;make&quot; &quot;math&quot; &quot;mred&quot; &quot;mrlib&quot; &quot;m=
 ysterx&quot;<br>
 &gt;&gt; &quot;mzcom&quot; &quot;mzlib&quot; &quot;mzscheme&quot; &quot;net=
 &quot; &quot;openssl&quot; &quot;parser-tools&quot;<br>
 &gt;&gt; &quot;picturing-programs&quot; &quot;pkg&quot; &quot;plai&quot; &q=
 uot;planet&quot; &quot;plot&quot; &quot;preprocessor&quot; &quot;profile&qu=
 ot;<br>
 &gt;&gt; &quot;r5rs&quot; &quot;r6rs&quot; &quot;racket&quot; &quot;racklog=
 &quot; &quot;rackunit&quot; &quot;raco&quot; &quot;reader&quot; &quot;readl=
 ine&quot;<br>
 &gt;&gt; &quot;realm&quot; &quot;redex&quot; &quot;rnrs&quot; &quot;s-exp&q=
 uot; &quot;scheme&quot; &quot;schemeunit&quot; &quot;scribble&quot;<br>
 &gt;&gt; &quot;scribblings&quot; &quot;scriblib&quot; &quot;setup&quot; &qu=
 ot;sgl&quot; &quot;slatex&quot; &quot;slideshow&quot; &quot;srfi&quot; &quo=
 t;stepper&quot;<br>
 &gt;&gt; &quot;string-constants&quot; &quot;swindle&quot; &quot;syntax&quot=
 ; &quot;syntax-color&quot; &quot;teachpack&quot;<br>
 &gt;&gt; &quot;test-engine&quot; &quot;texpict&quot; &quot;trace&quot; &quo=
 t;typed&quot; &quot;typed-racket&quot; &quot;typed-scheme&quot;<br>
 &gt;&gt; &quot;unstable&quot; &quot;version&quot; &quot;web-server&quot; &q=
 uot;wxme&quot; &quot;xml&quot; &quot;xrepl&quot;))<br>
 &gt;&gt;<br>
 &gt;&gt; Computer Language: ((&quot;Determine language from source&quot;) (=
 #(#t print<br>
 &gt;&gt; mixed-fraction-e #f #t none) (default) #() &quot;#lang racket\n&qu=
 ot; #f #f ((main)<br>
 &gt;&gt; (test))))<br>
 &gt;&gt;<br>
 &gt;<br>
 </div></div></blockquote></div><br></div>
 
 --001a1133458e3ca77104e43ef14f--
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Gustavo Massaccesi <gustavo@oma.org.ar>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/13972: No source location highlighting for
 errors inside begin-for-syntax
Date: Sun, 18 Aug 2013 16:16:13 -0600

 Debugging by `errortrace' works by first macro-expanding a module and
 then instrumenting the expanded program.
 
 Unfortunately, that means that if an error occurs during expansion,
 then `errortrace' hasn't get a chance to add instrumentation.
 
 At Sun, 18 Aug 2013 15:48:13 -0500, Robby Findler wrote:
 > Thanks for your efforts!
 > 
 > FWIW, this transcript seems to indicate that the exn is missing the info:
 > 
 > [robby@yanpu] ~$ cat > ~/tmp.rkt
 > #lang racket
 > (begin-for-syntax bad)
 > 
 > [robby@yanpu] ~$ racket
 > Welcome to Racket v5.90.0.7.
 > > (dynamic-require "tmp.rkt" #f)
 > bad: undefined;
 >  cannot reference an identifier before its definition
 >   in module: 'tmp
 >   phase: 1
 >   context...:
 >    standard-module-name-resolver
 >    /Users/robby/git/plt/racket/collects/racket/private/misc.rkt:87:7
 > 
 > 
 > [robby@yanpu] ~$ racket
 > Welcome to Racket v5.90.0.7.
 > > (require errortrace)
 > > (dynamic-require "tmp.rkt" #f)
 > bad: undefined;
 >  cannot reference an identifier before its definition
 >   in module: 'tmp
 >   phase: 1
 >   errortrace...:
 >   context...:
 > 
 >  
 > /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/errortrace-l
 > ib.rkt:434:2:
 > errortrace-annotate
 > 
 >  
 > /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/errortrace-l
 > ib.rkt:480:4
 >    standard-module-name-resolver
 >    /Users/robby/git/plt/racket/collects/racket/private/misc.rkt:87:7
 > 
 > 
 > 
 > 
 > 
 > 
 > On Sun, Aug 18, 2013 at 9:36 AM, Gustavo Massaccesi <gustavo@oma.org.ar>wrote:
 > 
 > > I agree. My uninformed guess is that the problem is related to
 > > begin-for-syntax and not with DrRacket.
 > >
 > > I tried to write an example that doesn't depend on DrRacket using
 > > with-handlers and exn-continuation-marks but the code too long and
 > > complex and I was not even sure that I was dealing with all the
 > > details correctly. (For example: Should I use error-trace? The
 > > debugging/no-debugging and preserve stacktrace language options change
 > > the information in the error.)
 > >
 > > So finally I decided to send the firsts versions, that are small and
 > > simple.
 > >
 > > Gustavo
 > >
 > > On Sat, Aug 17, 2013 at 6:35 PM, Robby Findler
 > > <robby@eecs.northwestern.edu> wrote:
 > > > These don't seem to be specific to DrRacket: I see the same behavior in
 > > > racket at the command-line. As far as I can tell, the information to
 > > display
 > > > is not in the exn records.
 > > >
 > > > Robby
 > > >
 > > >
 > > >
 > > > On Sat, Aug 17, 2013 at 3:56 PM, <gustavo@oma.org.ar> wrote:
 > > >>
 > > >> A new problem report is waiting at
 > > >>   http://bugs.racket-lang.org/query/?cmd=view&pr=13972
 > > >>
 > > >> Reported by Gustavo Massaccesi for release: 5.3.6
 > > >>
 > > >> *** Description:
 > > >> (This is more a feature request than a bug report.)
 > > >>
 > > >> When there is an exceptions from code in phase > 0 (for example inside a
 > > >> begin-for-syntax block) the source location of the error aren't
 > > highlighted,
 > > >> and there is no go-to-error-button
 > > >>
 > > >> *** How to repeat:
 > > >> Run  these programs in DrRacket
 > > >>
 > > >> ;---- error at compile-time
 > > >> #lang racket
 > > >> (begin-for-syntax bad)
 > > >> ;==> <error>
 > > >> ;bad: undefined;
 > > >> ; cannot reference an identifier before its definition
 > > >> ;  phase: 1;
 > > >> ;----
 > > >> ; expected: stop-sign-icon
 > > >>
 > > >>
 > > >> ;---- error at run-time
 > > >> ;#lang racket
 > > >> ;(begin-for-syntax (display))
 > > >> ;==> <error>
 > > >> ;display: arity mismatch;
 > > >> ; the expected number of arguments does not match the given number
 > > >> ;  expected: 1 to 2
 > > >> ;  given: 0
 > > >> ;----
 > > >> ;expected: stop-signs-icon
 > > >>
 > > >> *** Environment:
 > > >> windows "Windows NT 5.1 (Build 2600) Service Pack 3" (win32\i386\3m)
 > > >> (get-display-depth) = 32
 > > >> Human Language: english
 > > >> (current-memory-use) 209179864
 > > >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = ();
 > > >> (links #:user? #f #:root? #t) = ()
 > > >> raco pkg (show):
 > > >> Installation-wide:
 > > >>  [none]
 > > >> User-specific, all-version:
 > > >>  [none]
 > > >> User-specific, version-specific (5.3.6):
 > > >>  [none]
 > > >>
 > > >>
 > > >>
 > > >> Collections:
 > > >> ("C:\\Documents and Settings\\User\\Datos de
 > > >> programa\\Racket\\5.3.6\\collects"
 > > >>  ("info-domain"))
 > > >> ("C:\\Archivos de programa\\Racket\\collects"
 > > >>  ("2htdp" "algol60" "at-exp" "browser" "compatibility" "compiler"
 > > "config"
 > > >> "data" "datalog" "db" "defaults" "deinprogramm" "drracket" "drscheme"
 > > >> "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework"
 > > >> "frtime" "future-visualizer" "games" "graphics" "gui-debugger" "help"
 > > >> "hierlist" "htdp" "html" "icons" "images" "info-domain" "json" "lang"
 > > >> "launcher" "lazy" "macro-debugger" "make" "math" "mred" "mrlib"
 > > "mysterx"
 > > >> "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 > > >> "picturing-programs" "pkg" "plai" "planet" "plot" "preprocessor"
 > > "profile"
 > > >> "r5rs" "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline"
 > > >> "realm" "redex" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 > > >> "scribblings" "scriblib" "setup" "sgl" "slatex" "slideshow" "srfi"
 > > "stepper"
 > > >> "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 > > >> "test-engine" "texpict" "trace" "typed" "typed-racket" "typed-scheme"
 > > >> "unstable" "version" "web-server" "wxme" "xml" "xrepl"))
 > > >>
 > > >> Computer Language: (("Determine language from source") (#(#t print
 > > >> mixed-fraction-e #f #t none) (default) #() "#lang racket\n" #f #f
 > > ((main)
 > > >> (test))))
 > > >>
 > > >
 > >
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: Gustavo Massaccesi <gustavo@oma.org.ar>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/13972: No source location highlighting for
 errors inside begin-for-syntax
Date: Sun, 18 Aug 2013 17:20:32 -0500

 --089e011606786e7c7904e4403b61
 Content-Type: text/plain; charset=UTF-8
 
 Oh, duh. Sorry. And I see that this one actually does have a stacktrace:
 
 #lang racket
 (begin-for-syntax
   (define (f x)
     (if (zero? x)
         (car)
         (+ 1 (f (- x 1)))))
 
   (f 1000))
 
 
 On Sun, Aug 18, 2013 at 5:16 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 
 > Debugging by `errortrace' works by first macro-expanding a module and
 > then instrumenting the expanded program.
 >
 > Unfortunately, that means that if an error occurs during expansion,
 > then `errortrace' hasn't get a chance to add instrumentation.
 >
 > At Sun, 18 Aug 2013 15:48:13 -0500, Robby Findler wrote:
 > > Thanks for your efforts!
 > >
 > > FWIW, this transcript seems to indicate that the exn is missing the info:
 > >
 > > [robby@yanpu] ~$ cat > ~/tmp.rkt
 > > #lang racket
 > > (begin-for-syntax bad)
 > >
 > > [robby@yanpu] ~$ racket
 > > Welcome to Racket v5.90.0.7.
 > > > (dynamic-require "tmp.rkt" #f)
 > > bad: undefined;
 > >  cannot reference an identifier before its definition
 > >   in module: 'tmp
 > >   phase: 1
 > >   context...:
 > >    standard-module-name-resolver
 > >    /Users/robby/git/plt/racket/collects/racket/private/misc.rkt:87:7
 > >
 > >
 > > [robby@yanpu] ~$ racket
 > > Welcome to Racket v5.90.0.7.
 > > > (require errortrace)
 > > > (dynamic-require "tmp.rkt" #f)
 > > bad: undefined;
 > >  cannot reference an identifier before its definition
 > >   in module: 'tmp
 > >   phase: 1
 > >   errortrace...:
 > >   context...:
 > >
 > >
 > >
 > /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/errortrace-l
 > > ib.rkt:434:2:
 > > errortrace-annotate
 > >
 > >
 > >
 > /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/errortrace-l
 > > ib.rkt:480:4
 > >    standard-module-name-resolver
 > >    /Users/robby/git/plt/racket/collects/racket/private/misc.rkt:87:7
 > >
 > >
 > >
 > >
 > >
 > >
 > > On Sun, Aug 18, 2013 at 9:36 AM, Gustavo Massaccesi <gustavo@oma.org.ar
 > >wrote:
 > >
 > > > I agree. My uninformed guess is that the problem is related to
 > > > begin-for-syntax and not with DrRacket.
 > > >
 > > > I tried to write an example that doesn't depend on DrRacket using
 > > > with-handlers and exn-continuation-marks but the code too long and
 > > > complex and I was not even sure that I was dealing with all the
 > > > details correctly. (For example: Should I use error-trace? The
 > > > debugging/no-debugging and preserve stacktrace language options change
 > > > the information in the error.)
 > > >
 > > > So finally I decided to send the firsts versions, that are small and
 > > > simple.
 > > >
 > > > Gustavo
 > > >
 > > > On Sat, Aug 17, 2013 at 6:35 PM, Robby Findler
 > > > <robby@eecs.northwestern.edu> wrote:
 > > > > These don't seem to be specific to DrRacket: I see the same behavior
 > in
 > > > > racket at the command-line. As far as I can tell, the information to
 > > > display
 > > > > is not in the exn records.
 > > > >
 > > > > Robby
 > > > >
 > > > >
 > > > >
 > > > > On Sat, Aug 17, 2013 at 3:56 PM, <gustavo@oma.org.ar> wrote:
 > > > >>
 > > > >> A new problem report is waiting at
 > > > >>   http://bugs.racket-lang.org/query/?cmd=view&pr=13972
 > > > >>
 > > > >> Reported by Gustavo Massaccesi for release: 5.3.6
 > > > >>
 > > > >> *** Description:
 > > > >> (This is more a feature request than a bug report.)
 > > > >>
 > > > >> When there is an exceptions from code in phase > 0 (for example
 > inside a
 > > > >> begin-for-syntax block) the source location of the error aren't
 > > > highlighted,
 > > > >> and there is no go-to-error-button
 > > > >>
 > > > >> *** How to repeat:
 > > > >> Run  these programs in DrRacket
 > > > >>
 > > > >> ;---- error at compile-time
 > > > >> #lang racket
 > > > >> (begin-for-syntax bad)
 > > > >> ;==> <error>
 > > > >> ;bad: undefined;
 > > > >> ; cannot reference an identifier before its definition
 > > > >> ;  phase: 1;
 > > > >> ;----
 > > > >> ; expected: stop-sign-icon
 > > > >>
 > > > >>
 > > > >> ;---- error at run-time
 > > > >> ;#lang racket
 > > > >> ;(begin-for-syntax (display))
 > > > >> ;==> <error>
 > > > >> ;display: arity mismatch;
 > > > >> ; the expected number of arguments does not match the given number
 > > > >> ;  expected: 1 to 2
 > > > >> ;  given: 0
 > > > >> ;----
 > > > >> ;expected: stop-signs-icon
 > > > >>
 > > > >> *** Environment:
 > > > >> windows "Windows NT 5.1 (Build 2600) Service Pack 3" (win32\i386\3m)
 > > > >> (get-display-depth) = 32
 > > > >> Human Language: english
 > > > >> (current-memory-use) 209179864
 > > > >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) =
 > ();
 > > > >> (links #:user? #f #:root? #t) = ()
 > > > >> raco pkg (show):
 > > > >> Installation-wide:
 > > > >>  [none]
 > > > >> User-specific, all-version:
 > > > >>  [none]
 > > > >> User-specific, version-specific (5.3.6):
 > > > >>  [none]
 > > > >>
 > > > >>
 > > > >>
 > > > >> Collections:
 > > > >> ("C:\\Documents and Settings\\User\\Datos de
 > > > >> programa\\Racket\\5.3.6\\collects"
 > > > >>  ("info-domain"))
 > > > >> ("C:\\Archivos de programa\\Racket\\collects"
 > > > >>  ("2htdp" "algol60" "at-exp" "browser" "compatibility" "compiler"
 > > > "config"
 > > > >> "data" "datalog" "db" "defaults" "deinprogramm" "drracket"
 > "drscheme"
 > > > >> "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework"
 > > > >> "frtime" "future-visualizer" "games" "graphics" "gui-debugger"
 > "help"
 > > > >> "hierlist" "htdp" "html" "icons" "images" "info-domain" "json"
 > "lang"
 > > > >> "launcher" "lazy" "macro-debugger" "make" "math" "mred" "mrlib"
 > > > "mysterx"
 > > > >> "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 > > > >> "picturing-programs" "pkg" "plai" "planet" "plot" "preprocessor"
 > > > "profile"
 > > > >> "r5rs" "r6rs" "racket" "racklog" "rackunit" "raco" "reader"
 > "readline"
 > > > >> "realm" "redex" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 > > > >> "scribblings" "scriblib" "setup" "sgl" "slatex" "slideshow" "srfi"
 > > > "stepper"
 > > > >> "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 > > > >> "test-engine" "texpict" "trace" "typed" "typed-racket"
 > "typed-scheme"
 > > > >> "unstable" "version" "web-server" "wxme" "xml" "xrepl"))
 > > > >>
 > > > >> Computer Language: (("Determine language from source") (#(#t print
 > > > >> mixed-fraction-e #f #t none) (default) #() "#lang racket\n" #f #f
 > > > ((main)
 > > > >> (test))))
 > > > >>
 > > > >
 > > >
 >
 
 --089e011606786e7c7904e4403b61
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div dir=3D"ltr">Oh, duh. Sorry. And I see that this one actually does have=
  a stacktrace:<div><br></div><div><div>#lang racket</div><div>(begin-for-sy=
 ntax</div><div>=C2=A0 (define (f x)</div><div>=C2=A0 =C2=A0 (if (zero? x)</=
 div><div>=C2=A0 =C2=A0 =C2=A0 =C2=A0 (car)</div>
 <div>=C2=A0 =C2=A0 =C2=A0 =C2=A0 (+ 1 (f (- x 1)))))</div><div>=C2=A0=C2=A0=
 </div><div>=C2=A0 (f 1000))</div></div></div><div class=3D"gmail_extra"><br=
 ><br><div class=3D"gmail_quote">On Sun, Aug 18, 2013 at 5:16 PM, Matthew Fl=
 att <span dir=3D"ltr">&lt;<a href=3D"mailto:mflatt@cs.utah.edu" target=3D"_=
 blank">mflatt@cs.utah.edu</a>&gt;</span> wrote:<br>
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex">Debugging by `errortrace&#39; works by first=
  macro-expanding a module and<br>
 then instrumenting the expanded program.<br>
 <br>
 Unfortunately, that means that if an error occurs during expansion,<br>
 then `errortrace&#39; hasn&#39;t get a chance to add instrumentation.<br>
 <div class=3D"HOEnZb"><div class=3D"h5"><br>
 At Sun, 18 Aug 2013 15:48:13 -0500, Robby Findler wrote:<br>
 &gt; Thanks for your efforts!<br>
 &gt;<br>
 &gt; FWIW, this transcript seems to indicate that the exn is missing the in=
 fo:<br>
 &gt;<br>
 &gt; [robby@yanpu] ~$ cat &gt; ~/tmp.rkt<br>
 &gt; #lang racket<br>
 &gt; (begin-for-syntax bad)<br>
 &gt;<br>
 &gt; [robby@yanpu] ~$ racket<br>
 &gt; Welcome to Racket v5.90.0.7.<br>
 &gt; &gt; (dynamic-require &quot;tmp.rkt&quot; #f)<br>
 &gt; bad: undefined;<br>
 &gt; =C2=A0cannot reference an identifier before its definition<br>
 &gt; =C2=A0 in module: &#39;tmp<br>
 &gt; =C2=A0 phase: 1<br>
 &gt; =C2=A0 context...:<br>
 &gt; =C2=A0 =C2=A0standard-module-name-resolver<br>
 &gt; =C2=A0 =C2=A0/Users/robby/git/plt/racket/collects/racket/private/misc.=
 rkt:87:7<br>
 &gt;<br>
 &gt;<br>
 &gt; [robby@yanpu] ~$ racket<br>
 &gt; Welcome to Racket v5.90.0.7.<br>
 &gt; &gt; (require errortrace)<br>
 &gt; &gt; (dynamic-require &quot;tmp.rkt&quot; #f)<br>
 &gt; bad: undefined;<br>
 &gt; =C2=A0cannot reference an identifier before its definition<br>
 &gt; =C2=A0 in module: &#39;tmp<br>
 &gt; =C2=A0 phase: 1<br>
 &gt; =C2=A0 errortrace...:<br>
 &gt; =C2=A0 context...:<br>
 &gt;<br>
 &gt;<br>
 &gt; /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/er=
 rortrace-l<br>
 &gt; ib.rkt:434:2:<br>
 &gt; errortrace-annotate<br>
 &gt;<br>
 &gt;<br>
 &gt; /Users/robby/git/plt/pkgs/errortrace-pkgs/errortrace-lib/errortrace/er=
 rortrace-l<br>
 &gt; ib.rkt:480:4<br>
 &gt; =C2=A0 =C2=A0standard-module-name-resolver<br>
 &gt; =C2=A0 =C2=A0/Users/robby/git/plt/racket/collects/racket/private/misc.=
 rkt:87:7<br>
 &gt;<br>
 &gt;<br>
 &gt;<br>
 &gt;<br>
 &gt;<br>
 &gt;<br>
 &gt; On Sun, Aug 18, 2013 at 9:36 AM, Gustavo Massaccesi &lt;<a href=3D"mai=
 lto:gustavo@oma.org.ar">gustavo@oma.org.ar</a>&gt;wrote:<br>
 &gt;<br>
 &gt; &gt; I agree. My uninformed guess is that the problem is related to<br=
 >
 &gt; &gt; begin-for-syntax and not with DrRacket.<br>
 &gt; &gt;<br>
 &gt; &gt; I tried to write an example that doesn&#39;t depend on DrRacket u=
 sing<br>
 &gt; &gt; with-handlers and exn-continuation-marks but the code too long an=
 d<br>
 &gt; &gt; complex and I was not even sure that I was dealing with all the<b=
 r>
 &gt; &gt; details correctly. (For example: Should I use error-trace? The<br=
 >
 &gt; &gt; debugging/no-debugging and preserve stacktrace language options c=
 hange<br>
 &gt; &gt; the information in the error.)<br>
 &gt; &gt;<br>
 &gt; &gt; So finally I decided to send the firsts versions, that are small =
 and<br>
 &gt; &gt; simple.<br>
 &gt; &gt;<br>
 &gt; &gt; Gustavo<br>
 &gt; &gt;<br>
 &gt; &gt; On Sat, Aug 17, 2013 at 6:35 PM, Robby Findler<br>
 &gt; &gt; &lt;<a href=3D"mailto:robby@eecs.northwestern.edu">robby@eecs.nor=
 thwestern.edu</a>&gt; wrote:<br>
 &gt; &gt; &gt; These don&#39;t seem to be specific to DrRacket: I see the s=
 ame behavior in<br>
 &gt; &gt; &gt; racket at the command-line. As far as I can tell, the inform=
 ation to<br>
 &gt; &gt; display<br>
 &gt; &gt; &gt; is not in the exn records.<br>
 &gt; &gt; &gt;<br>
 &gt; &gt; &gt; Robby<br>
 &gt; &gt; &gt;<br>
 &gt; &gt; &gt;<br>
 &gt; &gt; &gt;<br>
 &gt; &gt; &gt; On Sat, Aug 17, 2013 at 3:56 PM, &lt;<a href=3D"mailto:gusta=
 vo@oma.org.ar">gustavo@oma.org.ar</a>&gt; wrote:<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; A new problem report is waiting at<br>
 &gt; &gt; &gt;&gt; =C2=A0 <a href=3D"http://bugs.racket-lang.org/query/?cmd=
 =3Dview&amp;pr=3D13972" target=3D"_blank">http://bugs.racket-lang.org/query=
 /?cmd=3Dview&amp;pr=3D13972</a><br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; Reported by Gustavo Massaccesi for release: 5.3.6<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; *** Description:<br>
 &gt; &gt; &gt;&gt; (This is more a feature request than a bug report.)<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; When there is an exceptions from code in phase &gt; 0 (f=
 or example inside a<br>
 &gt; &gt; &gt;&gt; begin-for-syntax block) the source location of the error=
  aren&#39;t<br>
 &gt; &gt; highlighted,<br>
 &gt; &gt; &gt;&gt; and there is no go-to-error-button<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; *** How to repeat:<br>
 &gt; &gt; &gt;&gt; Run =C2=A0these programs in DrRacket<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; ;---- error at compile-time<br>
 &gt; &gt; &gt;&gt; #lang racket<br>
 &gt; &gt; &gt;&gt; (begin-for-syntax bad)<br>
 &gt; &gt; &gt;&gt; ;=3D=3D&gt; &lt;error&gt;<br>
 &gt; &gt; &gt;&gt; ;bad: undefined;<br>
 &gt; &gt; &gt;&gt; ; cannot reference an identifier before its definition<b=
 r>
 &gt; &gt; &gt;&gt; ; =C2=A0phase: 1;<br>
 &gt; &gt; &gt;&gt; ;----<br>
 &gt; &gt; &gt;&gt; ; expected: stop-sign-icon<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; ;---- error at run-time<br>
 &gt; &gt; &gt;&gt; ;#lang racket<br>
 &gt; &gt; &gt;&gt; ;(begin-for-syntax (display))<br>
 &gt; &gt; &gt;&gt; ;=3D=3D&gt; &lt;error&gt;<br>
 &gt; &gt; &gt;&gt; ;display: arity mismatch;<br>
 &gt; &gt; &gt;&gt; ; the expected number of arguments does not match the gi=
 ven number<br>
 &gt; &gt; &gt;&gt; ; =C2=A0expected: 1 to 2<br>
 &gt; &gt; &gt;&gt; ; =C2=A0given: 0<br>
 &gt; &gt; &gt;&gt; ;----<br>
 &gt; &gt; &gt;&gt; ;expected: stop-signs-icon<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; *** Environment:<br>
 &gt; &gt; &gt;&gt; windows &quot;Windows NT 5.1 (Build 2600) Service Pack 3=
 &quot; (win32\i386\3m)<br>
 &gt; &gt; &gt;&gt; (get-display-depth) =3D 32<br>
 &gt; &gt; &gt;&gt; Human Language: english<br>
 &gt; &gt; &gt;&gt; (current-memory-use) 209179864<br>
 &gt; &gt; &gt;&gt; Links: (links) =3D (); (links #:user? #f) =3D (); (links=
  #:root? #t) =3D ();<br>
 &gt; &gt; &gt;&gt; (links #:user? #f #:root? #t) =3D ()<br>
 &gt; &gt; &gt;&gt; raco pkg (show):<br>
 &gt; &gt; &gt;&gt; Installation-wide:<br>
 &gt; &gt; &gt;&gt; =C2=A0[none]<br>
 &gt; &gt; &gt;&gt; User-specific, all-version:<br>
 &gt; &gt; &gt;&gt; =C2=A0[none]<br>
 &gt; &gt; &gt;&gt; User-specific, version-specific (5.3.6):<br>
 &gt; &gt; &gt;&gt; =C2=A0[none]<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; Collections:<br>
 &gt; &gt; &gt;&gt; (&quot;C:\\Documents and Settings\\User\\Datos de<br>
 &gt; &gt; &gt;&gt; programa\\Racket\\5.3.6\\collects&quot;<br>
 &gt; &gt; &gt;&gt; =C2=A0(&quot;info-domain&quot;))<br>
 &gt; &gt; &gt;&gt; (&quot;C:\\Archivos de programa\\Racket\\collects&quot;<=
 br>
 &gt; &gt; &gt;&gt; =C2=A0(&quot;2htdp&quot; &quot;algol60&quot; &quot;at-ex=
 p&quot; &quot;browser&quot; &quot;compatibility&quot; &quot;compiler&quot;<=
 br>
 &gt; &gt; &quot;config&quot;<br>
 &gt; &gt; &gt;&gt; &quot;data&quot; &quot;datalog&quot; &quot;db&quot; &quo=
 t;defaults&quot; &quot;deinprogramm&quot; &quot;drracket&quot; &quot;drsche=
 me&quot;<br>
 &gt; &gt; &gt;&gt; &quot;dynext&quot; &quot;embedded-gui&quot; &quot;eopl&q=
 uot; &quot;errortrace&quot; &quot;ffi&quot; &quot;file&quot; &quot;framewor=
 k&quot;<br>
 &gt; &gt; &gt;&gt; &quot;frtime&quot; &quot;future-visualizer&quot; &quot;g=
 ames&quot; &quot;graphics&quot; &quot;gui-debugger&quot; &quot;help&quot;<b=
 r>
 &gt; &gt; &gt;&gt; &quot;hierlist&quot; &quot;htdp&quot; &quot;html&quot; &=
 quot;icons&quot; &quot;images&quot; &quot;info-domain&quot; &quot;json&quot=
 ; &quot;lang&quot;<br>
 &gt; &gt; &gt;&gt; &quot;launcher&quot; &quot;lazy&quot; &quot;macro-debugg=
 er&quot; &quot;make&quot; &quot;math&quot; &quot;mred&quot; &quot;mrlib&quo=
 t;<br>
 &gt; &gt; &quot;mysterx&quot;<br>
 &gt; &gt; &gt;&gt; &quot;mzcom&quot; &quot;mzlib&quot; &quot;mzscheme&quot;=
  &quot;net&quot; &quot;openssl&quot; &quot;parser-tools&quot;<br>
 &gt; &gt; &gt;&gt; &quot;picturing-programs&quot; &quot;pkg&quot; &quot;pla=
 i&quot; &quot;planet&quot; &quot;plot&quot; &quot;preprocessor&quot;<br>
 &gt; &gt; &quot;profile&quot;<br>
 &gt; &gt; &gt;&gt; &quot;r5rs&quot; &quot;r6rs&quot; &quot;racket&quot; &qu=
 ot;racklog&quot; &quot;rackunit&quot; &quot;raco&quot; &quot;reader&quot; &=
 quot;readline&quot;<br>
 &gt; &gt; &gt;&gt; &quot;realm&quot; &quot;redex&quot; &quot;rnrs&quot; &qu=
 ot;s-exp&quot; &quot;scheme&quot; &quot;schemeunit&quot; &quot;scribble&quo=
 t;<br>
 &gt; &gt; &gt;&gt; &quot;scribblings&quot; &quot;scriblib&quot; &quot;setup=
 &quot; &quot;sgl&quot; &quot;slatex&quot; &quot;slideshow&quot; &quot;srfi&=
 quot;<br>
 &gt; &gt; &quot;stepper&quot;<br>
 &gt; &gt; &gt;&gt; &quot;string-constants&quot; &quot;swindle&quot; &quot;s=
 yntax&quot; &quot;syntax-color&quot; &quot;teachpack&quot;<br>
 &gt; &gt; &gt;&gt; &quot;test-engine&quot; &quot;texpict&quot; &quot;trace&=
 quot; &quot;typed&quot; &quot;typed-racket&quot; &quot;typed-scheme&quot;<b=
 r>
 &gt; &gt; &gt;&gt; &quot;unstable&quot; &quot;version&quot; &quot;web-serve=
 r&quot; &quot;wxme&quot; &quot;xml&quot; &quot;xrepl&quot;))<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;&gt; Computer Language: ((&quot;Determine language from sourc=
 e&quot;) (#(#t print<br>
 &gt; &gt; &gt;&gt; mixed-fraction-e #f #t none) (default) #() &quot;#lang r=
 acket\n&quot; #f #f<br>
 &gt; &gt; ((main)<br>
 &gt; &gt; &gt;&gt; (test))))<br>
 &gt; &gt; &gt;&gt;<br>
 &gt; &gt; &gt;<br>
 &gt; &gt;<br>
 </div></div></blockquote></div><br></div>
 
 --089e011606786e7c7904e4403b61--

State changed from "open" to "closed" by samth at Mon, 21 Oct 2013 10:13:37 -0400
Reason>>> This is a fundamental limitation of errortrace.

