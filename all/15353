From bugs+caf_=bugs=bugs.plt-scheme.org@plt-scheme.org Thu Sep 15 17:53:29 2016
Received: from mail-io0-f178.google.com (mail-io0-f178.google.com [209.85.223.178])
	by winooski.ccs.neu.edu (8.14.7/8.14.7) with ESMTP id u8FLrRNR030117
	for <bugs@bugs.plt-scheme.org>; Thu, 15 Sep 2016 17:53:27 -0400
Message-Id: <201609152153.u8FLrOEN030110@winooski.ccs.neu.edu>
Date: Thu, 15 Sep 2016 17:53:24 -0400
From: gary.fuehrer@gmail.com
To: bugs@racket-lang.org
Subject: Windows DrRacket crashes with typed/racket Fixnum

>Number:         15353
>Category:       all
>Synopsis:       Windows DrRacket crashes with typed/racket Fixnum
>Class:          sw-bug
>Responsible:    nobody
>Severity:       non-critical
>Priority:       medium
>State:          open
>Confidential:   no
>Arrival-Date:   Thu Sep 15 17:56:01 -0400 2016
>Last-Modified:  Mon Oct 03 16:36:01 -0400 2016
>Originator:     Gary Fuehrer
>Organization:
plt
>Submitter-Id:   unknown
>Release:        6.6
>Environment:
windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m) (get-display-depth) = 32
Human Language: english
(current-memory-use) 613973668
raco pkg (show):
Installation-wide:
 Package            Checksum             Source
 main-distribution  e24e5af07557ac0f...  catalog...tribution
 racket-lib         21b7fee99c95a8d7...  catalog racket-lib
 [191 auto-installed packages not shown]
User-specific for installation "6.6":
 [none]



Collections:
("C:\\Users\\gfuehrer\\AppData\\Roaming\\Racket\\6.6\\collects"
 (non-existent-path))
("C:\\Program Files\\Racket\\collects"
 ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))

Recent Internal Errors: 
Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((test) (main)) #t))
>Description:
This crashes DrRacket on Windows 10 ver. 1511 both x64 and x86. I couldn't minimize it any further (but I'm a noob) -- make any one of the following changes and it will no longer crash:
- Change Fixnum to something larger like Integer.
- Insert any expression between the two defines.
- Replace "(+ x 0)" with a constant or with fx+ (but not unsafe-fx+).
>How-To-Repeat:
#lang typed/racket

(define (crash!) : Void
  (define x : Fixnum 0)
  (define y : Fixnum (+ x 0))
  (set! x 0)
  (set! y 0)
  )

(crash!)
>Fix:
>Audit-Trail:
From: Vincent St-Amour <stamourv@eecs.northwestern.edu>
To: gary.fuehrer@gmail.com, bugs@racket-lang.org
Cc: nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with typed/racket Fixnum
Date: Wed, 28 Sep 2016 13:57:53 -0500

 FWIW, I can't reproduce that crash with Racket from HEAD on Mac.
 
 I looked at the code generated by TR, and nothing looks out of place.
 
 Gary, could you try the following version, which doesn't use Typed
 Racket (but should otherwise be equivalent)?
 
     #lang racket/base
 
     (define (crash!)
       (define x 0)
       (define y (unsafe-fx+ x 0))
       (set! x 0)
       (set! y 0)
       )
 
     (crash!)
 
 
 Vincent
 
 
 
 On Thu, 15 Sep 2016 16:56:02 -0500,
 gary.fuehrer@gmail.com wrote:
 > 
 > A new problem report is waiting at
 >   http://bugs.racket-lang.org/query/?cmd=view&pr=15353
 > 
 > Reported by Gary Fuehrer for release: 6.6
 > 
 > *** Description:
 > This crashes DrRacket on Windows 10 ver. 1511 both x64 and x86. I couldn't minimize it any further (but I'm a noob) -- make any one of the following changes and it will no longer crash:
 > - Change Fixnum to something larger like Integer.
 > - Insert any expression between the two defines.
 > - Replace "(+ x 0)" with a constant or with fx+ (but not unsafe-fx+).
 > 
 > *** How to repeat:
 > #lang typed/racket
 > 
 > (define (crash!) : Void
 >   (define x : Fixnum 0)
 >   (define y : Fixnum (+ x 0))
 >   (set! x 0)
 >   (set! y 0)
 >   )
 > 
 > (crash!)
 > 
 > *** Environment:
 > windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m) (get-display-depth) = 32
 > Human Language: english
 > (current-memory-use) 613973668
 > raco pkg (show):
 > Installation-wide:
 >  Package            Checksum             Source
 >  main-distribution  e24e5af07557ac0f...  catalog...tribution
 >  racket-lib         21b7fee99c95a8d7...  catalog racket-lib
 >  [191 auto-installed packages not shown]
 > User-specific for installation "6.6":
 >  [none]
 > 
 > 
 > 
 > Collections:
 > ("C:\\Users\\gfuehrer\\AppData\\Roaming\\Racket\\6.6\\collects"
 >  (non-existent-path))
 > ("C:\\Program Files\\Racket\\collects"
 >  ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))
 > 
 > Recent Internal Errors: 
 > Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((test) (main)) #t))
From: Gary Fuehrer <gary.fuehrer@gmail.com>
To: Vincent St-Amour <stamourv@eecs.northwestern.edu>
Cc: "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with
 typed/racket Fixnum
Date: Wed, 28 Sep 2016 13:04:16 -0600

 --001a1145056615bb80053d960719
 Content-Type: text/plain; charset=UTF-8
 
 I subsumed that case in my report -- the untyped version is using Integer,
 not Fixnum, so like the typed version using Integer it does not crash.
 
 On Wednesday, September 28, 2016, Vincent St-Amour <
 stamourv@eecs.northwestern.edu> wrote:
 
 > FWIW, I can't reproduce that crash with Racket from HEAD on Mac.
 >
 > I looked at the code generated by TR, and nothing looks out of place.
 >
 > Gary, could you try the following version, which doesn't use Typed
 > Racket (but should otherwise be equivalent)?
 >
 >     #lang racket/base
 >
 >     (define (crash!)
 >       (define x 0)
 >       (define y (unsafe-fx+ x 0))
 >       (set! x 0)
 >       (set! y 0)
 >       )
 >
 >     (crash!)
 >
 >
 > Vincent
 >
 >
 >
 > On Thu, 15 Sep 2016 16:56:02 -0500,
 > gary.fuehrer@gmail.com <javascript:;> wrote:
 > >
 > > A new problem report is waiting at
 > >   http://bugs.racket-lang.org/query/?cmd=view&pr=15353
 > >
 > > Reported by Gary Fuehrer for release: 6.6
 > >
 > > *** Description:
 > > This crashes DrRacket on Windows 10 ver. 1511 both x64 and x86. I
 > couldn't minimize it any further (but I'm a noob) -- make any one of the
 > following changes and it will no longer crash:
 > > - Change Fixnum to something larger like Integer.
 > > - Insert any expression between the two defines.
 > > - Replace "(+ x 0)" with a constant or with fx+ (but not unsafe-fx+).
 > >
 > > *** How to repeat:
 > > #lang typed/racket
 > >
 > > (define (crash!) : Void
 > >   (define x : Fixnum 0)
 > >   (define y : Fixnum (+ x 0))
 > >   (set! x 0)
 > >   (set! y 0)
 > >   )
 > >
 > > (crash!)
 > >
 > > *** Environment:
 > > windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m)
 > (get-display-depth) = 32
 > > Human Language: english
 > > (current-memory-use) 613973668
 > > raco pkg (show):
 > > Installation-wide:
 > >  Package            Checksum             Source
 > >  main-distribution  e24e5af07557ac0f...  catalog...tribution
 > >  racket-lib         21b7fee99c95a8d7...  catalog racket-lib
 > >  [191 auto-installed packages not shown]
 > > User-specific for installation "6.6":
 > >  [none]
 > >
 > >
 > >
 > > Collections:
 > > ("C:\\Users\\gfuehrer\\AppData\\Roaming\\Racket\\6.6\\collects"
 > >  (non-existent-path))
 > > ("C:\\Program Files\\Racket\\collects"
 > >  ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info"
 > "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket"
 > "raco" "reader" "realm" "s-exp" "setup" "syntax" "version" "xml"))
 > >
 > > Recent Internal Errors:
 > > Computer Language: (("Determine language from source") (#(#t print
 > mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((test)
 > (main)) #t))
 >
 
 --001a1145056615bb80053d960719
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 I subsumed=C2=A0that case in my report -- the=C2=A0untyped version is using=
  Integer, not Fix<span></span>num, so like the typed version using Integer =
 it does not crash.<br><br>On Wednesday, September 28, 2016, Vincent St-Amou=
 r &lt;<a href=3D"mailto:stamourv@eecs.northwestern.edu">stamourv@eecs.north=
 western.edu</a>&gt; wrote:<br><blockquote class=3D"gmail_quote" style=3D"ma=
 rgin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">FWIW, I can&#3=
 9;t reproduce that crash with Racket from HEAD on Mac.<br>
 <br>
 I looked at the code generated by TR, and nothing looks out of place.<br>
 <br>
 Gary, could you try the following version, which doesn&#39;t use Typed<br>
 Racket (but should otherwise be equivalent)?<br>
 <br>
 =C2=A0 =C2=A0 #lang racket/base<br>
 <br>
 =C2=A0 =C2=A0 (define (crash!)<br>
 =C2=A0 =C2=A0 =C2=A0 (define x 0)<br>
 =C2=A0 =C2=A0 =C2=A0 (define y (unsafe-fx+ x 0))<br>
 =C2=A0 =C2=A0 =C2=A0 (set! x 0)<br>
 =C2=A0 =C2=A0 =C2=A0 (set! y 0)<br>
 =C2=A0 =C2=A0 =C2=A0 )<br>
 <br>
 =C2=A0 =C2=A0 (crash!)<br>
 <br>
 <br>
 Vincent<br>
 <br>
 <br>
 <br>
 On Thu, 15 Sep 2016 16:56:02 -0500,<br>
 <a href=3D"javascript:;" onclick=3D"_e(event, &#39;cvml&#39;, &#39;gary.fue=
 hrer@gmail.com&#39;)">gary.fuehrer@gmail.com</a>=C2=A0wrote:<br>
 &gt;<br>
 &gt; A new problem report is waiting at<br>
 &gt;=C2=A0 =C2=A0<a href=3D"http://bugs.racket-lang.org/query/?cmd=3Dview&a=
 mp;pr=3D15353" target=3D"_blank">http://bugs.racket-lang.org/<wbr>query/?cm=
 d=3Dview&amp;pr=3D15353</a><br>
 &gt;<br>
 &gt; Reported by Gary Fuehrer for release: 6.6<br>
 &gt;<br>
 &gt; *** Description:<br>
 &gt; This crashes DrRacket on Windows 10 ver. 1511 both x64 and x86. I coul=
 dn&#39;t minimize it any further (but I&#39;m a noob) -- make any one of th=
 e following changes and it will no longer crash:<br>
 &gt; - Change Fixnum to something larger like Integer.<br>
 &gt; - Insert any expression between the two defines.<br>
 &gt; - Replace &quot;(+ x 0)&quot; with a constant or with fx+ (but not uns=
 afe-fx+).<br>
 &gt;<br>
 &gt; *** How to repeat:<br>
 &gt; #lang typed/racket<br>
 &gt;<br>
 &gt; (define (crash!) : Void<br>
 &gt;=C2=A0 =C2=A0(define x : Fixnum 0)<br>
 &gt;=C2=A0 =C2=A0(define y : Fixnum (+ x 0))<br>
 &gt;=C2=A0 =C2=A0(set! x 0)<br>
 &gt;=C2=A0 =C2=A0(set! y 0)<br>
 &gt;=C2=A0 =C2=A0)<br>
 &gt;<br>
 &gt; (crash!)<br>
 &gt;<br>
 &gt; *** Environment:<br>
 &gt; windows &quot;Windows NT 6.2 (Build 9200)&quot; (win32\x86_64\3m) (get=
 -display-depth) =3D 32<br>
 &gt; Human Language: english<br>
 &gt; (current-memory-use) 613973668<br>
 &gt; raco pkg (show):<br>
 &gt; Installation-wide:<br>
 &gt;=C2=A0 Package=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Checksum=C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Source<br>
 &gt;=C2=A0 main-distribution=C2=A0 e24e5af07557ac0f...=C2=A0 catalog...trib=
 ution<br>
 &gt;=C2=A0 racket-lib=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A021b7fee99c95a8d7...=
 =C2=A0 catalog racket-lib<br>
 &gt;=C2=A0 [191 auto-installed packages not shown]<br>
 &gt; User-specific for installation &quot;6.6&quot;:<br>
 &gt;=C2=A0 [none]<br>
 &gt;<br>
 &gt;<br>
 &gt;<br>
 &gt; Collections:<br>
 &gt; (&quot;C:\\Users\\gfuehrer\\<wbr>AppData\\Roaming\\Racket\\6.6\<wbr>\c=
 ollects&quot;<br>
 &gt;=C2=A0 (non-existent-path))<br>
 &gt; (&quot;C:\\Program Files\\Racket\\collects&quot;<br>
 &gt;=C2=A0 (&quot;acks&quot; &quot;compiler&quot; &quot;data&quot; &quot;db=
 &quot; &quot;dynext&quot; &quot;ffi&quot; &quot;file&quot; &quot;info&quot;=
  &quot;info-domain&quot; &quot;json&quot; &quot;launcher&quot; &quot;net&qu=
 ot; &quot;openssl&quot; &quot;pkg&quot; &quot;planet&quot; &quot;racket&quo=
 t; &quot;raco&quot; &quot;reader&quot; &quot;realm&quot; &quot;s-exp&quot; =
 &quot;setup&quot; &quot;syntax&quot; &quot;version&quot; &quot;xml&quot;))<=
 br>
 &gt;<br>
 &gt; Recent Internal Errors:<br>
 &gt; Computer Language: ((&quot;Determine language from source&quot;) (#(#t=
  print mixed-fraction-e #f #t debug) (default) #() &quot;#lang racket\n&quo=
 t; #t #t ((test) (main)) #t))<br>
 </blockquote>
 
 --001a1145056615bb80053d960719--
From: Vincent St-Amour <stamourv@eecs.northwestern.edu>
To: Gary Fuehrer <gary.fuehrer@gmail.com>
Cc: Vincent St-Amour <stamourv@eecs.northwestern.edu>,
        "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with typed/racket Fixnum
Date: Wed, 28 Sep 2016 15:01:14 -0500

 Right, if the untyped version was using the generic `+` function, then
 it would be equivalent to a typed version using `Integer`. The version I
 sent uses `unsafe-fx+`, which is equivalent to using `Fixnum` in the
 typed version.
 
 The important detail here is that TR doesn't use type information to
 affect representation *directly*. That is, the type `Fixnum` does not
 mean "represent this variable as an unboxed fixnum" but rather "this
 variable may not exceed fixnum range". Instead, it's the *operations*
 (like `unsafe-fx+`) that give hints to the Racket compiler that it may
 be productive to change the representation. All TR does is replace
 generic operations like `+` with unsafe, specialized operations like
 `unsafe-fx+`.
 
 Does that make sense?
 
 Vincent
 
 
 
 On Wed, 28 Sep 2016 14:04:16 -0500,
 Gary Fuehrer wrote:
 > 
 > I subsumed that case in my report -- the untyped version is using
 > Integer, not Fixnum, so like the typed version using Integer it does not
 > crash.
 > 
 > On Wednesday, September 28, 2016, Vincent St-Amour
 > <stamourv@eecs.northwestern.edu> wrote:
 > 
 >     FWIW, I can't reproduce that crash with Racket from HEAD on Mac.
 >     
 >     I looked at the code generated by TR, and nothing looks out of
 >     place.
 >     
 >     Gary, could you try the following version, which doesn't use Typed
 >     Racket (but should otherwise be equivalent)?
 >     
 >     #lang racket/base
 >     
 >     (define (crash!)
 >     (define x 0)
 >     (define y (unsafe-fx+ x 0))
 >     (set! x 0)
 >     (set! y 0)
 >     )
 >     
 >     (crash!)
 >     
 >     
 >     Vincent
 >     
 >     
 >     
 >     On Thu, 15 Sep 2016 16:56:02 -0500,
 >     gary.fuehrer@gmail.com wrote:
 >     >
 >     > A new problem report is waiting at
 >     > http://bugs.racket-lang.org/query/?cmd=view&pr=15353
 >     >
 >     > Reported by Gary Fuehrer for release: 6.6
 >     >
 >     > *** Description:
 >     > This crashes DrRacket on Windows 10 ver. 1511 both x64 and x86. I
 >     couldn't minimize it any further (but I'm a noob) -- make any one of
 >     the following changes and it will no longer crash:
 >     > - Change Fixnum to something larger like Integer.
 >     > - Insert any expression between the two defines.
 >     > - Replace "(+ x 0)" with a constant or with fx+ (but not
 >     unsafe-fx+).
 >     >
 >     > *** How to repeat:
 >     > #lang typed/racket
 >     >
 >     > (define (crash!) : Void
 >     > (define x : Fixnum 0)
 >     > (define y : Fixnum (+ x 0))
 >     > (set! x 0)
 >     > (set! y 0)
 >     > )
 >     >
 >     > (crash!)
 >     >
 >     > *** Environment:
 >     > windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m)
 >     (get-display-depth) = 32
 >     > Human Language: english
 >     > (current-memory-use) 613973668
 >     > raco pkg (show):
 >     > Installation-wide:
 >     > Package Checksum Source
 >     > main-distribution e24e5af07557ac0f... catalog...tribution
 >     > racket-lib 21b7fee99c95a8d7... catalog racket-lib
 >     > [191 auto-installed packages not shown]
 >     > User-specific for installation "6.6":
 >     > [none]
 >     >
 >     >
 >     >
 >     > Collections:
 >     > ("C:\\Users\\gfuehrer\\AppData\\Roaming\\Racket\\6.6\\collects"
 >     > (non-existent-path))
 >     > ("C:\\Program Files\\Racket\\collects"
 >     > ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info"
 >     "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet"
 >     "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version"
 >     "xml"))
 >     >
 >     > Recent Internal Errors:
 >     > Computer Language: (("Determine language from source") (#(#t print
 >     mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t
 >     ((test) (main)) #t))
From: Gary Fuehrer <gary.fuehrer@gmail.com>
To: Vincent St-Amour <stamourv@eecs.northwestern.edu>
Cc: "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with
 typed/racket Fixnum
Date: Wed, 28 Sep 2016 14:28:42 -0600

 --94eb2c14b1aa14fade053d973579
 Content-Type: text/plain; charset=UTF-8
 
 Yes, I get it now. Thanks for taking the time to explain.
 
 I ran exactly your version, adding
 (require racket/unsafe/ops), and it does not crash. So my typed version
 using unsafe-fx crashes, as I reported (and just now verified again), but
 not your untyped equivalent.
 
 -Gary
 
 On Wednesday, September 28, 2016, Vincent St-Amour <
 stamourv@eecs.northwestern.edu> wrote:
 
 > Right, if the untyped version was using the generic `+` function, then
 > it would be equivalent to a typed version using `Integer`. The version I
 > sent uses `unsafe-fx+`, which is equivalent to using `Fixnum` in the
 > typed version.
 >
 > The important detail here is that TR doesn't use type information to
 > affect representation *directly*. That is, the type `Fixnum` does not
 > mean "represent this variable as an unboxed fixnum" but rather "this
 > variable may not exceed fixnum range". Instead, it's the *operations*
 > (like `unsafe-fx+`) that give hints to the Racket compiler that it may
 > be productive to change the representation. All TR does is replace
 > generic operations like `+` with unsafe, specialized operations like
 > `unsafe-fx+`.
 >
 > Does that make sense?
 >
 > Vincent
 >
 >
 >
 > On Wed, 28 Sep 2016 14:04:16 -0500,
 > Gary Fuehrer wrote:
 > >
 > > I subsumed that case in my report -- the untyped version is using
 > > Integer, not Fixnum, so like the typed version using Integer it does not
 > > crash.
 > >
 > > On Wednesday, September 28, 2016, Vincent St-Amour
 > > <stamourv@eecs.northwestern.edu <javascript:;>> wrote:
 > >
 > >     FWIW, I can't reproduce that crash with Racket from HEAD on Mac.
 > >
 > >     I looked at the code generated by TR, and nothing looks out of
 > >     place.
 > >
 > >     Gary, could you try the following version, which doesn't use Typed
 > >     Racket (but should otherwise be equivalent)?
 > >
 > >     #lang racket/base
 > >
 > >     (define (crash!)
 > >     (define x 0)
 > >     (define y (unsafe-fx+ x 0))
 > >     (set! x 0)
 > >     (set! y 0)
 > >     )
 > >
 > >     (crash!)
 > >
 > >
 > >     Vincent
 > >
 > >
 > >
 > >     On Thu, 15 Sep 2016 16:56:02 -0500,
 > >     gary.fuehrer@gmail.com <javascript:;> wrote:
 > >     >
 > >     > A new problem report is waiting at
 > >     > http://bugs.racket-lang.org/query/?cmd=view&pr=15353
 > >     >
 > >     > Reported by Gary Fuehrer for release: 6.6
 > >     >
 > >     > *** Description:
 > >     > This crashes DrRacket on Windows 10 ver. 1511 both x64 and x86. I
 > >     couldn't minimize it any further (but I'm a noob) -- make any one of
 > >     the following changes and it will no longer crash:
 > >     > - Change Fixnum to something larger like Integer.
 > >     > - Insert any expression between the two defines.
 > >     > - Replace "(+ x 0)" with a constant or with fx+ (but not
 > >     unsafe-fx+).
 > >     >
 > >     > *** How to repeat:
 > >     > #lang typed/racket
 > >     >
 > >     > (define (crash!) : Void
 > >     > (define x : Fixnum 0)
 > >     > (define y : Fixnum (+ x 0))
 > >     > (set! x 0)
 > >     > (set! y 0)
 > >     > )
 > >     >
 > >     > (crash!)
 > >     >
 > >     > *** Environment:
 > >     > windows "Windows NT 6.2 (Build 9200)" (win32\x86_64\3m)
 > >     (get-display-depth) = 32
 > >     > Human Language: english
 > >     > (current-memory-use) 613973668
 > >     > raco pkg (show):
 > >     > Installation-wide:
 > >     > Package Checksum Source
 > >     > main-distribution e24e5af07557ac0f... catalog...tribution
 > >     > racket-lib 21b7fee99c95a8d7... catalog racket-lib
 > >     > [191 auto-installed packages not shown]
 > >     > User-specific for installation "6.6":
 > >     > [none]
 > >     >
 > >     >
 > >     >
 > >     > Collections:
 > >     > ("C:\\Users\\gfuehrer\\AppData\\Roaming\\Racket\\6.6\\collects"
 > >     > (non-existent-path))
 > >     > ("C:\\Program Files\\Racket\\collects"
 > >     > ("acks" "compiler" "data" "db" "dynext" "ffi" "file" "info"
 > >     "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet"
 > >     "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "version"
 > >     "xml"))
 > >     >
 > >     > Recent Internal Errors:
 > >     > Computer Language: (("Determine language from source") (#(#t print
 > >     mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t
 > >     ((test) (main)) #t))
 >
 
 --94eb2c14b1aa14fade053d973579
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 Yes, I get it now. Thanks for taking the time to explain.<div><br></div><di=
 v>I ran exactly your version,=C2=A0adding</div><div>(require racket/unsafe/=
 ops), and it=C2=A0does not crash. So my=C2=A0typed version using unsafe-fx =
 crashes, as I reported (and just now verified again),=C2=A0but not your=C2=
 =A0untyped equivalent.<div><br></div><div>-Gary</div><div><br>On Wednesday,=
  September 28, 2016, Vincent St-Amour &lt;<a href=3D"mailto:stamourv@eecs.n=
 orthwestern.edu">stamourv@eecs.northwestern.edu</a>&gt; wrote:<br><blockquo=
 te class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
 lid;padding-left:1ex">Right, if the untyped version was using the generic `=
 +` function, then<br>
 it would be equivalent to a typed version using `Integer`. The version I<br=
 >
 sent uses `unsafe-fx+`, which is equivalent to using `Fixnum` in the<br>
 typed version.<br>
 <br>
 The important detail here is that TR doesn&#39;t use type information to<br=
 >
 affect representation *directly*. That is, the type `Fixnum` does not<br>
 mean &quot;represent this variable as an unboxed fixnum&quot; but rather &q=
 uot;this<br>
 variable may not exceed fixnum range&quot;. Instead, it&#39;s the *operatio=
 ns*<br>
 (like `unsafe-fx+`) that give hints to the Racket compiler that it may<br>
 be productive to change the representation. All TR does is replace<br>
 generic operations like `+` with unsafe, specialized operations like<br>
 `unsafe-fx+`.<br>
 <br>
 Does that make sense?<br>
 <br>
 Vincent<br>
 <br>
 <br>
 <br>
 On Wed, 28 Sep 2016 14:04:16 -0500,<br>
 Gary Fuehrer wrote:<br>
 &gt;<br>
 &gt; I subsumed that case in my report -- the untyped version is using<br>
 &gt; Integer, not Fixnum, so like the typed version using Integer it does n=
 ot<br>
 &gt; crash.<br>
 &gt;<br>
 &gt; On Wednesday, September 28, 2016, Vincent St-Amour<br>
 &gt; &lt;<a href=3D"javascript:;" onclick=3D"_e(event, &#39;cvml&#39;, &#39=
 ;stamourv@eecs.northwestern.edu&#39;)">stamourv@eecs.northwestern.edu</a>&g=
 t; wrote:<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0FWIW, I can&#39;t reproduce that crash with Racket =
 from HEAD on Mac.<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0I looked at the code generated by TR, and nothing l=
 ooks out of<br>
 &gt;=C2=A0 =C2=A0 =C2=A0place.<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0Gary, could you try the following version, which do=
 esn&#39;t use Typed<br>
 &gt;=C2=A0 =C2=A0 =C2=A0Racket (but should otherwise be equivalent)?<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0#lang racket/base<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0(define (crash!)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0(define x 0)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0(define y (unsafe-fx+ x 0))<br>
 &gt;=C2=A0 =C2=A0 =C2=A0(set! x 0)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0(set! y 0)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0)<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0(crash!)<br>
 &gt;<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0Vincent<br>
 &gt;<br>
 &gt;<br>
 &gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0On Thu, 15 Sep 2016 16:56:02 -0500,<br>
 &gt;=C2=A0 =C2=A0 =C2=A0<a href=3D"javascript:;" onclick=3D"_e(event, &#39;=
 cvml&#39;, &#39;gary.fuehrer@gmail.com&#39;)">gary.fuehrer@gmail.com</a> wr=
 ote:<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; A new problem report is waiting at<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; <a href=3D"http://bugs.racket-lang.org/query/?=
 cmd=3Dview&amp;pr=3D15353" target=3D"_blank">http://bugs.racket-lang.org/<w=
 br>query/?cmd=3Dview&amp;pr=3D15353</a><br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; Reported by Gary Fuehrer for release: 6.6<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; *** Description:<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; This crashes DrRacket on Windows 10 ver. 1511 =
 both x64 and x86. I<br>
 &gt;=C2=A0 =C2=A0 =C2=A0couldn&#39;t minimize it any further (but I&#39;m a=
  noob) -- make any one of<br>
 &gt;=C2=A0 =C2=A0 =C2=A0the following changes and it will no longer crash:<=
 br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; - Change Fixnum to something larger like Integ=
 er.<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; - Insert any expression between the two define=
 s.<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; - Replace &quot;(+ x 0)&quot; with a constant =
 or with fx+ (but not<br>
 &gt;=C2=A0 =C2=A0 =C2=A0unsafe-fx+).<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; *** How to repeat:<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; #lang typed/racket<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (define (crash!) : Void<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (define x : Fixnum 0)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (define y : Fixnum (+ x 0))<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (set! x 0)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (set! y 0)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; )<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (crash!)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; *** Environment:<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; windows &quot;Windows NT 6.2 (Build 9200)&quot=
 ; (win32\x86_64\3m)<br>
 &gt;=C2=A0 =C2=A0 =C2=A0(get-display-depth) =3D 32<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; Human Language: english<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (current-memory-use) 613973668<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; raco pkg (show):<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; Installation-wide:<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; Package Checksum Source<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; main-distribution e24e5af07557ac0f... catalog.=
 ..tribution<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; racket-lib 21b7fee99c95a8d7... catalog racket-=
 lib<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; [191 auto-installed packages not shown]<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; User-specific for installation &quot;6.6&quot;=
 :<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; [none]<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; Collections:<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (&quot;C:\\Users\\gfuehrer\\<wbr>AppData\\Roam=
 ing\\Racket\\6.6\<wbr>\collects&quot;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (non-existent-path))<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (&quot;C:\\Program Files\\Racket\\collects&quo=
 t;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; (&quot;acks&quot; &quot;compiler&quot; &quot;d=
 ata&quot; &quot;db&quot; &quot;dynext&quot; &quot;ffi&quot; &quot;file&quot=
 ; &quot;info&quot;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&quot;info-domain&quot; &quot;json&quot; &quot;laun=
 cher&quot; &quot;net&quot; &quot;openssl&quot; &quot;pkg&quot; &quot;planet=
 &quot;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&quot;racket&quot; &quot;raco&quot; &quot;reader&qu=
 ot; &quot;realm&quot; &quot;s-exp&quot; &quot;setup&quot; &quot;syntax&quot=
 ; &quot;version&quot;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&quot;xml&quot;))<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt;<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; Recent Internal Errors:<br>
 &gt;=C2=A0 =C2=A0 =C2=A0&gt; Computer Language: ((&quot;Determine language =
 from source&quot;) (#(#t print<br>
 &gt;=C2=A0 =C2=A0 =C2=A0mixed-fraction-e #f #t debug) (default) #() &quot;#=
 lang racket\n&quot; #t #t<br>
 &gt;=C2=A0 =C2=A0 =C2=A0((test) (main)) #t))<br>
 </blockquote></div></div>
 
 --94eb2c14b1aa14fade053d973579--
From: Vincent St-Amour <stamourv@eecs.northwestern.edu>
To: Gary Fuehrer <gary.fuehrer@gmail.com>
Cc: Vincent St-Amour <stamourv@eecs.northwestern.edu>,
        "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with typed/racket Fixnum
Date: Thu, 29 Sep 2016 13:37:31 -0500

 On Wed, 28 Sep 2016 15:28:42 -0500,
 Gary Fuehrer wrote:
 > 
 > Yes, I get it now. Thanks for taking the time to explain.
 > 
 > I ran exactly your version, adding
 > (require racket/unsafe/ops), and it does not crash. So my typed version
 > using unsafe-fx crashes, as I reported (and just now verified again),
 > but not your untyped equivalent.
 
 Hmm, that's weird.
 
 To rule out a segfault inside the TR implementation, could you check
 whether compiling (raco make) the program leads to a crash?
 
 Vincent
From: Gary Fuehrer <gary.fuehrer@gmail.com>
To: Vincent St-Amour <stamourv@eecs.northwestern.edu>
Cc: "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with
 typed/racket Fixnum
Date: Thu, 29 Sep 2016 13:14:51 -0600

 --001a1145784ecefc04053daa4a79
 Content-Type: text/plain; charset=UTF-8
 
 > To rule out a segfault inside the TR
 > implementation, could you check
 > whether compiling (raco make) the
 > program leads to a crash?
 
 Both build and run from the command line fine, neither crashes. I added at
 the end of both a "(print "no crash!") and built them in Dr. Racket
 with "Create Executable" as "Stand-alone".
 
 Your untyped exe is 1MB, and 7MB if compiled against the full (#lang
 racket). Build times are 2s and 12s. My typed exe is 15MB and builds
 in 44s. I'm rounding up to the nearest MB.
 
 -Gary
 
 --001a1145784ecefc04053daa4a79
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div><span style=3D"background-color:rgba(255,255,255,0);font-size:small">&=
 gt;=C2=A0To rule out a segfault inside the TR</span><br></div><div><font si=
 ze=3D"2"><span style=3D"background-color:rgba(255,255,255,0)"></span></font=
 ><span style=3D"background-color:rgba(255,255,255,0);font-size:small">&gt;=
 =C2=A0implementation, could you check</span></div><div><span style=3D"backg=
 round-color:rgba(255,255,255,0);font-size:small"></span><span style=3D"back=
 ground-color:rgba(255,255,255,0);font-size:small">&gt; whether compiling (r=
 aco make) the</span></div><div><span style=3D"background-color:rgba(255,255=
 ,255,0);font-size:small">&gt;=C2=A0program leads to a crash?</span></div><d=
 iv><font size=3D"2"><span style=3D"background-color:rgba(255,255,255,0)"><b=
 r></span></font></div>Both build and run from the command line fine, neithe=
 r crashes.=C2=A0I added at the end of both a &quot;(print &quot;no crash!&q=
 uot;) and built them=C2=A0in Dr. Racket with=C2=A0&quot;Create Executable&q=
 uot; as=C2=A0&quot;Stand-alone&quot;.<div><br></div><div>Your untyped exe i=
 s 1MB, and 7MB if compiled against the full=C2=A0(#lang racket). Build time=
 s are 2s and 12s. My typed exe is 15MB and builds in=C2=A044s. I&#39;m=C2=
 =A0rounding=C2=A0up to the nearest MB.<br><br></div><div>-Gary<span></span>=
 </div>
 
 --001a1145784ecefc04053daa4a79--
From: Vincent St-Amour <stamourv@eecs.northwestern.edu>
To: Gary Fuehrer <gary.fuehrer@gmail.com>
Cc: Vincent St-Amour <stamourv@eecs.northwestern.edu>,
        "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with typed/racket Fixnum
Date: Sat, 01 Oct 2016 18:01:13 -0500

 On Thu, 29 Sep 2016 14:14:51 -0500,
 Gary Fuehrer wrote:
 > 
 > > To rule out a segfault inside the TR
 > > implementation, could you check
 > > whether compiling (raco make) the
 > > program leads to a crash?
 > 
 > Both build and run from the command line fine, neither crashes. I added
 > at the end of both a "(print "no crash!") and built them in Dr. Racket
 > with "Create Executable" as "Stand-alone".
 
 Wait, I'm confused. Are you saying that if you build *then* run the TR
 version, it doesn't crash, but if you just run it without building it,
 it crashes? That's very strange.
 
 Vincent
From: Gary Fuehrer <gary.fuehrer@gmail.com>
To: Vincent St-Amour <stamourv@eecs.northwestern.edu>
Cc: "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with
 typed/racket Fixnum
Date: Mon, 3 Oct 2016 09:46:28 -0600

 --001a11437b1ee582ca053df7d8f7
 Content-Type: text/plain; charset=UTF-8
 
 Yes, that is what happens.
 
 On Saturday, October 1, 2016, Vincent St-Amour <
 stamourv@eecs.northwestern.edu> wrote:
 
 > On Thu, 29 Sep 2016 14:14:51 -0500,
 > Gary Fuehrer wrote:
 > >
 > > > To rule out a segfault inside the TR
 > > > implementation, could you check
 > > > whether compiling (raco make) the
 > > > program leads to a crash?
 > >
 > > Both build and run from the command line fine, neither crashes. I added
 > > at the end of both a "(print "no crash!") and built them in Dr. Racket
 > > with "Create Executable" as "Stand-alone".
 >
 > Wait, I'm confused. Are you saying that if you build *then* run the TR
 > version, it doesn't crash, but if you just run it without building it,
 > it crashes? That's very strange.
 >
 > Vincent
 >
 
 --001a11437b1ee582ca053df7d8f7
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 Yes, that is what happens.<br><br>On Saturday, October 1, 2016, Vincent St-=
 Amour &lt;<a href=3D"mailto:stamourv@eecs.northwestern.edu">stamourv@eecs.n=
 orthwestern.edu</a>&gt; wrote:<br><blockquote class=3D"gmail_quote" style=
 =3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">On Thu, =
 29 Sep 2016 14:14:51 -0500,<br>
 Gary Fuehrer wrote:<br>
 &gt;<br>
 &gt; &gt; To rule out a segfault inside the TR<br>
 &gt; &gt; implementation, could you check<br>
 &gt; &gt; whether compiling (raco make) the<br>
 &gt; &gt; program leads to a crash?<br>
 &gt;<br>
 &gt; Both build and run from the command line fine, neither crashes. I adde=
 d<br>
 &gt; at the end of both a &quot;(print &quot;no crash!&quot;) and built the=
 m in Dr. Racket<br>
 &gt; with &quot;Create Executable&quot; as &quot;Stand-alone&quot;.<br>
 <br>
 Wait, I&#39;m confused. Are you saying that if you build *then* run the TR<=
 br>
 version, it doesn&#39;t crash, but if you just run it without building it,<=
 br>
 it crashes? That&#39;s very strange.<br>
 <br>
 Vincent<br>
 </blockquote>
 
 --001a11437b1ee582ca053df7d8f7--
From: Vincent St-Amour <stamourv@eecs.northwestern.edu>
To: Gary Fuehrer <gary.fuehrer@gmail.com>
Cc: Vincent St-Amour <stamourv@eecs.northwestern.edu>,
        "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with typed/racket Fixnum
Date: Mon, 03 Oct 2016 14:42:21 -0500

 OK, so at this point, it looks like you're seeing a bug in TR that only
 manifests when not compiling to zo files.
 
 This set of circumstances looks like the opposite from a recent bug from
 the mailing list (worked from command-line racket, crashed when
 compiling to zo), which was introduced in 6.3. Could you try with Racket
 6.2?
 
 Otherwise, I think I'm out of ideas. Sam? Matthew?
 
 Vincent
 
 
 
 On Mon, 03 Oct 2016 10:46:28 -0500,
 Gary Fuehrer wrote:
 > 
 > Yes, that is what happens.
 > 
 > On Saturday, October 1, 2016, Vincent St-Amour
 > <stamourv@eecs.northwestern.edu> wrote:
 > 
 >     On Thu, 29 Sep 2016 14:14:51 -0500,
 >     Gary Fuehrer wrote:
 >     >
 >     > > To rule out a segfault inside the TR
 >     > > implementation, could you check
 >     > > whether compiling (raco make) the
 >     > > program leads to a crash?
 >     >
 >     > Both build and run from the command line fine, neither crashes. I
 >     added
 >     > at the end of both a "(print "no crash!") and built them in Dr.
 >     Racket
 >     > with "Create Executable" as "Stand-alone".
 >     
 >     Wait, I'm confused. Are you saying that if you build *then* run the
 >     TR
 >     version, it doesn't crash, but if you just run it without building
 >     it,
 >     it crashes? That's very strange.
 >     
 >     Vincent
From: Robby Findler <robby@eecs.northwestern.edu>
To: Vincent St-Amour <stamourv@eecs.northwestern.edu>
Cc: Gary Fuehrer <gary.fuehrer@gmail.com>,
        "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>,
        Matthew Flatt <mflatt@cs.utah.edu>
Subject: Re: [racket-bug] all/15353: Windows DrRacket crashes with
 typed/racket Fixnum
Date: Mon, 3 Oct 2016 15:37:25 -0500

 Vincent and I looked into this on a Windows VM. Here's one way to reproduce it:
 
 racket -l errortrace -t tmp.rkt
 
 where tmp.rkt has no .zo file and contains Gary's original program:
 
 #lang typed/racket
 
 (define (crash!) : Void
   (define x : Fixnum 0)
   (define y : Fixnum (+ x 0))
   (set! x 0)
   (set! y 0)
   )
 
 (crash!)
 
 The crash report mentions trying to dereference the fixnum bits for
 the number 0 (we changed the constants and it is trying to dereference
 the value in the variable `x`). Disabling the JIT shows that the crash
 happens in the interpreter in the case for scheme_local_unbox_type (on
 line 3534 in eval.c (as of version 6.4.0.14 anyway....)). Looking at
 the decompiled code, there is no longer a set! in the code so probably
 something somewhere is getting confused about whether or not `x` is in
 a boxed stack slot or not.
 
 Robby
