From bugs+caf_=bugs=bugs.plt-scheme.org@plt-scheme.org Tue Oct 22 13:21:48 2013
Received: from mail-ob0-f179.google.com (mail-ob0-f179.google.com [209.85.214.179])
	by winooski.ccs.neu.edu (8.14.7/8.14.7) with ESMTP id r9MHLipb014184
	for <bugs@bugs.plt-scheme.org>; Tue, 22 Oct 2013 13:21:44 -0400
Message-Id: <201310221721.r9MHLfUQ014177@winooski.ccs.neu.edu>
Date: Tue, 22 Oct 2013 13:21:41 -0400
From: samth@cs.indiana.edu
To: bugs@racket-lang.org
Subject: internal drracket error: query-rows: no such table: modules

>Number:         14115
>Category:       drscheme
>Synopsis:       internal drracket error: query-rows: no such table: modules
>Class:          sw-bug
>Responsible:    jay
>Severity:       serious
>Priority:       medium
>State:          open
>Confidential:   no
>Arrival-Date:   Tue Oct 22 13:24:01 -0400 2013
>Last-Modified:  Fri Dec 20 18:04:01 -0500 2013
>Originator:     Sam Tobin-Hochstadt
>Organization:
plt
>Submitter-Id:   unknown
>Release:        5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)
>Environment:
unix "Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux" (x86_64-linux/3m) (get-display-depth) = 32
Human Language: english
(current-memory-use) 550321896
Links: (links) = (); (links #:user? #f) = ("explorer" "drracket-solarized" "meta" "find-pkg-deps"); (links #:root? #t) = (); (links #:user? #f #:root? #t) = (#<path:/home/samth/sw/raco-find-collection> #<path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark> #<path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach>)
raco pkg (show):
/home/samth/sw/plt/racket/share/devel-pkgs:
 Package              Checksum    Source
 main-distribution    #f          (static-link ../../../pkgs/main-distribution)
 plt-services         #f          (static-link ../../../pkgs/plt-services)
 racket-lib           #f          (static-link ../../../pkgs/racket-pkgs/racket-lib)
 [199 auto-installed packages not shown]
Installation-wide:
 Package                 Checksum                                    Source
 drracket-solarized      3c7ac56e3bde4f52653c08ad1058188f9bc10184    (catalog drracket-solarized)
 explorer                edc1bde6799c2d9db536c7a844f916359c1a9d21    (catalog explorer)
 find-pkg-deps           #f                                          (link ../../../../../tmp/find-pkg-deps)
 new-web                 #f                                          (link ../../../../../work/new-web)
 optimization-coach      ee002fa7483a5357b7b88a254d3f28e034e4765f    (catalog optimization-coach)
 racket-benchmark        9c3ab066997c34f5832a8e270f4c9a1222e5e1d0    (url git://github.com/joshmcgrath08/racket-benchmark)
 raco-find-collection    #f                                          (link ../../../../raco-find-collection)
User-specific for installation "development":
 [none]



Collections:
("/home/samth/sw/plt/add-on/development/collects"
 (non-existent-path))
("/home/samth/sw/plt/racket/collects"
 (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file" "info" "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket" "raco" "reader" "realm" "s-exp" "setup" "syntax" "unstable" "version" "xml"))

Recent Internal Errors: 
Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((main) (test)) #t))
>Description:
I managed to get the below error in DrRacket, by doing something like the following:

1. Start editing the internals of `match`
2. At some point, the internal error dialog pops up on every insert/delete event in the bugger with the below error.

query-rows: no such table: modules
  context...:
   /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0: handle-status*
   /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
   /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4: prepare1* method in connection%
   /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0: query-rows8
   /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
   /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0: pkg-catalog-suggestions-for-module351
   /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1222:6: update-frame-expand-error method in .../module-language.rkt:1153:4
   /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1523:6: on-highlighted-errors method in .../module-language.rkt:1521:4
   /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/unit.rkt:454:14: after-delete method in ...ket/private/unit.rkt:438:12
   /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rkt:4264:4: after-delete method in ...ork/private/text.rkt:4072:2
   /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:2616:6: after-delete method in .../module-language.rkt:2610:4
   /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rkt:1808:2: core1131
   /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rkt:68:4: undo method in insert-record%
   /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:947:8: loop
   /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:943:2: perform-undos method in editor%
   /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:832:2: undo method in editor%...
>How-To-Repeat:
>Fix:
>Audit-Trail:
From: Robby Findler <robby@eecs.northwestern.edu>
To: Sam Tobin-Hochstadt <samth@cs.indiana.edu>, bugs <bugs@racket-lang.org>
Cc: nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Tue, 22 Oct 2013 14:06:09 -0500

 --089e0117601fed5d7e04e95917eb
 Content-Type: text/plain; charset=UTF-8
 
 From the drr perspective, this lookslike a bug in the pkg library since drr
 doesn't expect pkg-catalog-suggestions-for-module to ever signal an error
 (unless its contract is violated), which isn't happening in this case.
 
 If that's not the case, then I can change drr to check whatever assumption
 needs to hold, tho.
 
 Robby
 
 
 On Tue, Oct 22, 2013 at 12:24 PM, <samth@cs.indiana.edu> wrote:
 
 > A new problem report is waiting at
 >   http://bugs.racket-lang.org/query/?cmd=view&pr=14115
 >
 > Reported by Sam Tobin-Hochstadt for release:
 > 5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)
 >
 > *** Description:
 > I managed to get the below error in DrRacket, by doing something like the
 > following:
 >
 > 1. Start editing the internals of `match`
 > 2. At some point, the internal error dialog pops up on every insert/delete
 > event in the bugger with the below error.
 >
 > query-rows: no such table: modules
 >   context...:
 >
 >  /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 > handle-status*
 >
 >  /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 >
 >  /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 > prepare1* method in connection%
 >
 >  /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 > query-rows8
 >    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 >    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 > pkg-catalog-suggestions-for-module351
 >
 >  /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1222:6:
 > update-frame-expand-error method in .../module-language.rkt:1153:4
 >
 >  /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1523:6:
 > on-highlighted-errors method in .../module-language.rkt:1521:4
 >
 >  /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/unit.rkt:454:14:
 > after-delete method in ...ket/private/unit.rkt:438:12
 >
 >  /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rkt:4264:4:
 > after-delete method in ...ork/private/text.rkt:4072:2
 >
 >  /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:2616:6:
 > after-delete method in .../module-language.rkt:2610:4
 >
 >  /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rkt:1808:2:
 > core1131
 >
 >  /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rkt:68:4:
 > undo method in insert-record%
 >
 >  /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:947:8:
 > loop
 >
 >  /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:943:2:
 > perform-undos method in editor%
 >
 >  /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:832:2:
 > undo method in editor%...
 >
 > *** How to repeat:
 >
 >
 > *** Environment:
 > unix "Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28 UTC
 > 2013 x86_64 x86_64 x86_64 GNU/Linux" (x86_64-linux/3m) (get-display-depth)
 > = 32
 > Human Language: english
 > (current-memory-use) 550321896
 > Links: (links) = (); (links #:user? #f) = ("explorer" "drracket-solarized"
 > "meta" "find-pkg-deps"); (links #:root? #t) = (); (links #:user? #f #:root?
 > #t) = (#<path:/home/samth/sw/raco-find-collection>
 > #<path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark>
 > #<path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach>)
 > raco pkg (show):
 > /home/samth/sw/plt/racket/share/devel-pkgs:
 >  Package              Checksum    Source
 >  main-distribution    #f          (static-link
 > ../../../pkgs/main-distribution)
 >  plt-services         #f          (static-link ../../../pkgs/plt-services)
 >  racket-lib           #f          (static-link
 > ../../../pkgs/racket-pkgs/racket-lib)
 >  [199 auto-installed packages not shown]
 > Installation-wide:
 >  Package                 Checksum                                    Source
 >  drracket-solarized      3c7ac56e3bde4f52653c08ad1058188f9bc10184
 >  (catalog drracket-solarized)
 >  explorer                edc1bde6799c2d9db536c7a844f916359c1a9d21
 >  (catalog explorer)
 >  find-pkg-deps           #f                                          (link
 > ../../../../../tmp/find-pkg-deps)
 >  new-web                 #f                                          (link
 > ../../../../../work/new-web)
 >  optimization-coach      ee002fa7483a5357b7b88a254d3f28e034e4765f
 >  (catalog optimization-coach)
 >  racket-benchmark        9c3ab066997c34f5832a8e270f4c9a1222e5e1d0    (url
 > git://github.com/joshmcgrath08/racket-benchmark)
 >  raco-find-collection    #f                                          (link
 > ../../../../raco-find-collection)
 > User-specific for installation "development":
 >  [none]
 >
 >
 >
 > Collections:
 > ("/home/samth/sw/plt/add-on/development/collects"
 >  (non-existent-path))
 > ("/home/samth/sw/plt/racket/collects"
 >  (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file" "info"
 > "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket"
 > "raco" "reader" "realm" "s-exp" "setup" "syntax" "unstable" "version"
 > "xml"))
 >
 > Recent Internal Errors:
 > Computer Language: (("Determine language from source") (#(#t print
 > mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((main)
 > (test)) #t))
 >
 >
 
 --089e0117601fed5d7e04e95917eb
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div dir=3D"ltr">From the drr perspective, this lookslike a bug in the pkg =
 library since drr doesn&#39;t expect pkg-catalog-suggestions-for-module to =
 ever signal an error (unless its contract is violated), which isn&#39;t hap=
 pening in this case.<br>
 <div><br></div><div>If that&#39;s not the case, then I can change drr to ch=
 eck whatever assumption needs to hold, tho.<br><br></div><div>Robby</div></=
 div><div class=3D"gmail_extra"><br><br><div class=3D"gmail_quote">On Tue, O=
 ct 22, 2013 at 12:24 PM,  <span dir=3D"ltr">&lt;<a href=3D"mailto:samth@cs.=
 indiana.edu" target=3D"_blank">samth@cs.indiana.edu</a>&gt;</span> wrote:<b=
 r>
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex">A new problem report is waiting at<br>
 =C2=A0 <a href=3D"http://bugs.racket-lang.org/query/?cmd=3Dview&amp;pr=3D14=
 115" target=3D"_blank">http://bugs.racket-lang.org/query/?cmd=3Dview&amp;pr=
 =3D14115</a><br>
 <br>
 Reported by Sam Tobin-Hochstadt for release: 5.90.0.9--2013-10-22(2fa0b53b/=
 d/better-subtype)<br>
 <br>
 *** Description:<br>
 I managed to get the below error in DrRacket, by doing something like the f=
 ollowing:<br>
 <br>
 1. Start editing the internals of `match`<br>
 2. At some point, the internal error dialog pops up on every insert/delete =
 event in the bugger with the below error.<br>
 <br>
 query-rows: no such table: modules<br>
 =C2=A0 context...:<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/sqlite3/connecti=
 on.rkt:369:0: handle-status*<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/sqlite3/connecti=
 on.rkt:330:8<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/sqlite3/connecti=
 on.rkt:187:4: prepare1* method in connection%<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/generic/function=
 s.rkt:165:0: query-rows8<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0: pkg-cat=
 alog-suggestions-for-module351<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/privat=
 e/module-language.rkt:1222:6: update-frame-expand-error method in .../modul=
 e-language.rkt:1153:4<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/privat=
 e/module-language.rkt:1523:6: on-highlighted-errors method in .../module-la=
 nguage.rkt:1521:4<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/privat=
 e/unit.rkt:454:14: after-delete method in ...ket/private/unit.rkt:438:12<br=
 >
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/tex=
 t.rkt:4264:4: after-delete method in ...ork/private/text.rkt:4072:2<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/privat=
 e/module-language.rkt:2616:6: after-delete method in .../module-language.rk=
 t:2610:4<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/tex=
 t.rkt:1808:2: core1131<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/und=
 o.rkt:68:4: undo method in insert-record%<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/edi=
 tor.rkt:947:8: loop<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/edi=
 tor.rkt:943:2: perform-undos method in editor%<br>
 =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/edi=
 tor.rkt:832:2: undo method in editor%...<br>
 <br>
 *** How to repeat:<br>
 <br>
 <br>
 *** Environment:<br>
 unix &quot;Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28 U=
 TC 2013 x86_64 x86_64 x86_64 GNU/Linux&quot; (x86_64-linux/3m) (get-display=
 -depth) =3D 32<br>
 Human Language: english<br>
 (current-memory-use) 550321896<br>
 Links: (links) =3D (); (links #:user? #f) =3D (&quot;explorer&quot; &quot;d=
 rracket-solarized&quot; &quot;meta&quot; &quot;find-pkg-deps&quot;); (links=
  #:root? #t) =3D (); (links #:user? #f #:root? #t) =3D (#&lt;path:/home/sam=
 th/sw/raco-find-collection&gt; #&lt;path:/home/samth/sw/plt/racket/share/pk=
 gs/racket-benchmark&gt; #&lt;path:/home/samth/sw/plt/racket/share/pkgs/opti=
 mization-coach&gt;)<br>
 
 raco pkg (show):<br>
 /home/samth/sw/plt/racket/share/devel-pkgs:<br>
 =C2=A0Package =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Checksum =C2=
 =A0 =C2=A0Source<br>
 =C2=A0main-distribution =C2=A0 =C2=A0#f =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(=
 static-link ../../../pkgs/main-distribution)<br>
 =C2=A0plt-services =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0(static-link ../../../pkgs/plt-services)<br>
 =C2=A0racket-lib =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =C2=A0 =C2=A0=
  =C2=A0 =C2=A0(static-link ../../../pkgs/racket-pkgs/racket-lib)<br>
 =C2=A0[199 auto-installed packages not shown]<br>
 Installation-wide:<br>
 =C2=A0Package =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Check=
 sum =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Source<br>
 =C2=A0drracket-solarized =C2=A0 =C2=A0 =C2=A03c7ac56e3bde4f52653c08ad105818=
 8f9bc10184 =C2=A0 =C2=A0(catalog drracket-solarized)<br>
 =C2=A0explorer =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0edc1b=
 de6799c2d9db536c7a844f916359c1a9d21 =C2=A0 =C2=A0(catalog explorer)<br>
 =C2=A0find-pkg-deps =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(link ../../../../..=
 /tmp/find-pkg-deps)<br>
 =C2=A0new-web =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(l=
 ink ../../../../../work/new-web)<br>
 =C2=A0optimization-coach =C2=A0 =C2=A0 =C2=A0ee002fa7483a5357b7b88a254d3f28=
 e034e4765f =C2=A0 =C2=A0(catalog optimization-coach)<br>
 =C2=A0racket-benchmark =C2=A0 =C2=A0 =C2=A0 =C2=A09c3ab066997c34f5832a8e270=
 f4c9a1222e5e1d0 =C2=A0 =C2=A0(url git://<a href=3D"http://github.com/joshmc=
 grath08/racket-benchmark" target=3D"_blank">github.com/joshmcgrath08/racket=
 -benchmark</a>)<br>
 =C2=A0raco-find-collection =C2=A0 =C2=A0#f =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(link ../../../../raco-find-collec=
 tion)<br>
 User-specific for installation &quot;development&quot;:<br>
 =C2=A0[none]<br>
 <br>
 <br>
 <br>
 Collections:<br>
 (&quot;/home/samth/sw/plt/add-on/development/collects&quot;<br>
 =C2=A0(non-existent-path))<br>
 (&quot;/home/samth/sw/plt/racket/collects&quot;<br>
 =C2=A0(&quot;.gitignore&quot; &quot;acks&quot; &quot;compiler&quot; &quot;d=
 ata&quot; &quot;db&quot; &quot;dynext&quot; &quot;ffi&quot; &quot;file&quot=
 ; &quot;info&quot; &quot;info-domain&quot; &quot;json&quot; &quot;launcher&=
 quot; &quot;net&quot; &quot;openssl&quot; &quot;pkg&quot; &quot;planet&quot=
 ; &quot;racket&quot; &quot;raco&quot; &quot;reader&quot; &quot;realm&quot; =
 &quot;s-exp&quot; &quot;setup&quot; &quot;syntax&quot; &quot;unstable&quot;=
  &quot;version&quot; &quot;xml&quot;))<br>
 
 <br>
 Recent Internal Errors:<br>
 Computer Language: ((&quot;Determine language from source&quot;) (#(#t prin=
 t mixed-fraction-e #f #t debug) (default) #() &quot;#lang racket\n&quot; #t=
  #t ((main) (test)) #t))<br>
 <br>
 </blockquote></div><br></div>
 
 --089e0117601fed5d7e04e95917eb--
From: Sam Tobin-Hochstadt <samth@cs.indiana.edu>
To: Robby Findler <robby@eecs.northwestern.edu>,
        Jay McCarthy <jay.mccarthy@gmail.com>
Cc: bugs <bugs@racket-lang.org>, nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Wed, 23 Oct 2013 16:05:16 -0400

 I still haven't figured out how to reliably trigger this, but when it
 does happen, it seems quite bad.  In particular, the internal error
 happens on every keystroke in the tab, rendering the tab useless. Even
 disabling online compilation doesn't cause the error to stop
 happening.
 
 Robby, could DrRacket recover better here?
 
 Jay, any thoughts on what might be going on?
 
 Sam
 
 On Tue, Oct 22, 2013 at 3:06 PM, Robby Findler
 <robby@eecs.northwestern.edu> wrote:
 > From the drr perspective, this lookslike a bug in the pkg library since drr
 > doesn't expect pkg-catalog-suggestions-for-module to ever signal an error
 > (unless its contract is violated), which isn't happening in this case.
 >
 > If that's not the case, then I can change drr to check whatever assumption
 > needs to hold, tho.
 >
 > Robby
 >
 >
 > On Tue, Oct 22, 2013 at 12:24 PM, <samth@cs.indiana.edu> wrote:
 >>
 >> A new problem report is waiting at
 >>   http://bugs.racket-lang.org/query/?cmd=view&pr=14115
 >>
 >> Reported by Sam Tobin-Hochstadt for release:
 >> 5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)
 >>
 >> *** Description:
 >> I managed to get the below error in DrRacket, by doing something like the
 >> following:
 >>
 >> 1. Start editing the internals of `match`
 >> 2. At some point, the internal error dialog pops up on every insert/delete
 >> event in the bugger with the below error.
 >>
 >> query-rows: no such table: modules
 >>   context...:
 >>
 >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 >> handle-status*
 >>
 >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 >>
 >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 >> prepare1* method in connection%
 >>
 >> /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 >> query-rows8
 >>    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 >>    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 >> pkg-catalog-suggestions-for-module351
 >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1222:6:
 >> update-frame-expand-error method in .../module-language.rkt:1153:4
 >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1523:6:
 >> on-highlighted-errors method in .../module-language.rkt:1521:4
 >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/unit.rkt:454:14:
 >> after-delete method in ...ket/private/unit.rkt:438:12
 >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rkt:4264:4:
 >> after-delete method in ...ork/private/text.rkt:4072:2
 >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:2616:6:
 >> after-delete method in .../module-language.rkt:2610:4
 >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rkt:1808:2:
 >> core1131
 >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rkt:68:4:
 >> undo method in insert-record%
 >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:947:8:
 >> loop
 >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:943:2:
 >> perform-undos method in editor%
 >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:832:2:
 >> undo method in editor%...
 >>
 >> *** How to repeat:
 >>
 >>
 >> *** Environment:
 >> unix "Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28 UTC
 >> 2013 x86_64 x86_64 x86_64 GNU/Linux" (x86_64-linux/3m) (get-display-depth) =
 >> 32
 >> Human Language: english
 >> (current-memory-use) 550321896
 >> Links: (links) = (); (links #:user? #f) = ("explorer" "drracket-solarized"
 >> "meta" "find-pkg-deps"); (links #:root? #t) = (); (links #:user? #f #:root?
 >> #t) = (#<path:/home/samth/sw/raco-find-collection>
 >> #<path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark>
 >> #<path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach>)
 >> raco pkg (show):
 >> /home/samth/sw/plt/racket/share/devel-pkgs:
 >>  Package              Checksum    Source
 >>  main-distribution    #f          (static-link
 >> ../../../pkgs/main-distribution)
 >>  plt-services         #f          (static-link ../../../pkgs/plt-services)
 >>  racket-lib           #f          (static-link
 >> ../../../pkgs/racket-pkgs/racket-lib)
 >>  [199 auto-installed packages not shown]
 >> Installation-wide:
 >>  Package                 Checksum
 >> Source
 >>  drracket-solarized      3c7ac56e3bde4f52653c08ad1058188f9bc10184
 >> (catalog drracket-solarized)
 >>  explorer                edc1bde6799c2d9db536c7a844f916359c1a9d21
 >> (catalog explorer)
 >>  find-pkg-deps           #f                                          (link
 >> ../../../../../tmp/find-pkg-deps)
 >>  new-web                 #f                                          (link
 >> ../../../../../work/new-web)
 >>  optimization-coach      ee002fa7483a5357b7b88a254d3f28e034e4765f
 >> (catalog optimization-coach)
 >>  racket-benchmark        9c3ab066997c34f5832a8e270f4c9a1222e5e1d0    (url
 >> git://github.com/joshmcgrath08/racket-benchmark)
 >>  raco-find-collection    #f                                          (link
 >> ../../../../raco-find-collection)
 >> User-specific for installation "development":
 >>  [none]
 >>
 >>
 >>
 >> Collections:
 >> ("/home/samth/sw/plt/add-on/development/collects"
 >>  (non-existent-path))
 >> ("/home/samth/sw/plt/racket/collects"
 >>  (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file" "info"
 >> "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket"
 >> "raco" "reader" "realm" "s-exp" "setup" "syntax" "unstable" "version"
 >> "xml"))
 >>
 >> Recent Internal Errors:
 >> Computer Language: (("Determine language from source") (#(#t print
 >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t ((main)
 >> (test)) #t))
 >>
 >
From: Robby Findler <robby@eecs.northwestern.edu>
To: Sam Tobin-Hochstadt <samth@cs.indiana.edu>
Cc: Jay McCarthy <jay.mccarthy@gmail.com>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Wed, 23 Oct 2013 15:15:56 -0500

 --089e013cc3a65245e704e96e2f0c
 Content-Type: text/plain; charset=UTF-8
 
 On Wed, Oct 23, 2013 at 3:05 PM, Sam Tobin-Hochstadt
 <samth@cs.indiana.edu>wrote:
 
 > I still haven't figured out how to reliably trigger this, but when it
 > does happen, it seems quite bad.  In particular, the internal error
 > happens on every keystroke in the tab, rendering the tab useless. Even
 > disabling online compilation doesn't cause the error to stop
 > happening.
 >
 > Robby, could DrRacket recover better here?
 >
 >
 The sensible place to put error recovery here seems like it should be
 inside the pkg manager, but I'll put something into drracket for now that
 will swallow the errors. It doesn't seem great, but better than a disabled
 drracket.
 
 Robby
 
 
 > Jay, any thoughts on what might be going on?
 >
 > Sam
 >
 > On Tue, Oct 22, 2013 at 3:06 PM, Robby Findler
 > <robby@eecs.northwestern.edu> wrote:
 > > From the drr perspective, this lookslike a bug in the pkg library since
 > drr
 > > doesn't expect pkg-catalog-suggestions-for-module to ever signal an error
 > > (unless its contract is violated), which isn't happening in this case.
 > >
 > > If that's not the case, then I can change drr to check whatever
 > assumption
 > > needs to hold, tho.
 > >
 > > Robby
 > >
 > >
 > > On Tue, Oct 22, 2013 at 12:24 PM, <samth@cs.indiana.edu> wrote:
 > >>
 > >> A new problem report is waiting at
 > >>   http://bugs.racket-lang.org/query/?cmd=view&pr=14115
 > >>
 > >> Reported by Sam Tobin-Hochstadt for release:
 > >> 5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)
 > >>
 > >> *** Description:
 > >> I managed to get the below error in DrRacket, by doing something like
 > the
 > >> following:
 > >>
 > >> 1. Start editing the internals of `match`
 > >> 2. At some point, the internal error dialog pops up on every
 > insert/delete
 > >> event in the bugger with the below error.
 > >>
 > >> query-rows: no such table: modules
 > >>   context...:
 > >>
 > >>
 > /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 > >> handle-status*
 > >>
 > >>
 > /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 > >>
 > >>
 > /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 > >> prepare1* method in connection%
 > >>
 > >>
 > /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 > >> query-rows8
 > >>    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 > >>    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 > >> pkg-catalog-suggestions-for-module351
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1222:6:
 > >> update-frame-expand-error method in .../module-language.rkt:1153:4
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1523:6:
 > >> on-highlighted-errors method in .../module-language.rkt:1521:4
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/unit.rkt:454:14:
 > >> after-delete method in ...ket/private/unit.rkt:438:12
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rkt:4264:4:
 > >> after-delete method in ...ork/private/text.rkt:4072:2
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:2616:6:
 > >> after-delete method in .../module-language.rkt:2610:4
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rkt:1808:2:
 > >> core1131
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rkt:68:4:
 > >> undo method in insert-record%
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:947:8:
 > >> loop
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:943:2:
 > >> perform-undos method in editor%
 > >>
 > >>
 > /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:832:2:
 > >> undo method in editor%...
 > >>
 > >> *** How to repeat:
 > >>
 > >>
 > >> *** Environment:
 > >> unix "Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28 UTC
 > >> 2013 x86_64 x86_64 x86_64 GNU/Linux" (x86_64-linux/3m)
 > (get-display-depth) =
 > >> 32
 > >> Human Language: english
 > >> (current-memory-use) 550321896
 > >> Links: (links) = (); (links #:user? #f) = ("explorer"
 > "drracket-solarized"
 > >> "meta" "find-pkg-deps"); (links #:root? #t) = (); (links #:user? #f
 > #:root?
 > >> #t) = (#<path:/home/samth/sw/raco-find-collection>
 > >> #<path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark>
 > >> #<path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach>)
 > >> raco pkg (show):
 > >> /home/samth/sw/plt/racket/share/devel-pkgs:
 > >>  Package              Checksum    Source
 > >>  main-distribution    #f          (static-link
 > >> ../../../pkgs/main-distribution)
 > >>  plt-services         #f          (static-link
 > ../../../pkgs/plt-services)
 > >>  racket-lib           #f          (static-link
 > >> ../../../pkgs/racket-pkgs/racket-lib)
 > >>  [199 auto-installed packages not shown]
 > >> Installation-wide:
 > >>  Package                 Checksum
 > >> Source
 > >>  drracket-solarized      3c7ac56e3bde4f52653c08ad1058188f9bc10184
 > >> (catalog drracket-solarized)
 > >>  explorer                edc1bde6799c2d9db536c7a844f916359c1a9d21
 > >> (catalog explorer)
 > >>  find-pkg-deps           #f
 >  (link
 > >> ../../../../../tmp/find-pkg-deps)
 > >>  new-web                 #f
 >  (link
 > >> ../../../../../work/new-web)
 > >>  optimization-coach      ee002fa7483a5357b7b88a254d3f28e034e4765f
 > >> (catalog optimization-coach)
 > >>  racket-benchmark        9c3ab066997c34f5832a8e270f4c9a1222e5e1d0
 >  (url
 > >> git://github.com/joshmcgrath08/racket-benchmark)
 > >>  raco-find-collection    #f
 >  (link
 > >> ../../../../raco-find-collection)
 > >> User-specific for installation "development":
 > >>  [none]
 > >>
 > >>
 > >>
 > >> Collections:
 > >> ("/home/samth/sw/plt/add-on/development/collects"
 > >>  (non-existent-path))
 > >> ("/home/samth/sw/plt/racket/collects"
 > >>  (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file"
 > "info"
 > >> "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket"
 > >> "raco" "reader" "realm" "s-exp" "setup" "syntax" "unstable" "version"
 > >> "xml"))
 > >>
 > >> Recent Internal Errors:
 > >> Computer Language: (("Determine language from source") (#(#t print
 > >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t
 > ((main)
 > >> (test)) #t))
 > >>
 > >
 >
 
 --089e013cc3a65245e704e96e2f0c
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div dir=3D"ltr"><br><div class=3D"gmail_extra"><br><br><div class=3D"gmail=
 _quote">On Wed, Oct 23, 2013 at 3:05 PM, Sam Tobin-Hochstadt <span dir=3D"l=
 tr">&lt;<a href=3D"mailto:samth@cs.indiana.edu" target=3D"_blank">samth@cs.=
 indiana.edu</a>&gt;</span> wrote:<br>
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex">I still haven&#39;t figured out how to relia=
 bly trigger this, but when it<br>
 does happen, it seems quite bad. =C2=A0In particular, the internal error<br=
 >
 happens on every keystroke in the tab, rendering the tab useless. Even<br>
 disabling online compilation doesn&#39;t cause the error to stop<br>
 happening.<br>
 <br>
 Robby, could DrRacket recover better here?<br>
 <br></blockquote><div><br></div><div>The sensible place to put error recove=
 ry here seems like it should be inside the pkg manager, but I&#39;ll put so=
 mething into drracket for now that will swallow the errors. It doesn&#39;t =
 seem great, but better than a disabled drracket.</div>
 <div><br></div><div>Robby</div><div>=C2=A0</div><blockquote class=3D"gmail_=
 quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1=
 ex">
 Jay, any thoughts on what might be going on?<br>
 <span class=3D"HOEnZb"><font color=3D"#888888"><br>
 Sam<br>
 </font></span><div class=3D"HOEnZb"><div class=3D"h5"><br>
 On Tue, Oct 22, 2013 at 3:06 PM, Robby Findler<br>
 &lt;<a href=3D"mailto:robby@eecs.northwestern.edu">robby@eecs.northwestern.=
 edu</a>&gt; wrote:<br>
 &gt; From the drr perspective, this lookslike a bug in the pkg library sinc=
 e drr<br>
 &gt; doesn&#39;t expect pkg-catalog-suggestions-for-module to ever signal a=
 n error<br>
 &gt; (unless its contract is violated), which isn&#39;t happening in this c=
 ase.<br>
 &gt;<br>
 &gt; If that&#39;s not the case, then I can change drr to check whatever as=
 sumption<br>
 &gt; needs to hold, tho.<br>
 &gt;<br>
 &gt; Robby<br>
 &gt;<br>
 &gt;<br>
 &gt; On Tue, Oct 22, 2013 at 12:24 PM, &lt;<a href=3D"mailto:samth@cs.india=
 na.edu">samth@cs.indiana.edu</a>&gt; wrote:<br>
 &gt;&gt;<br>
 &gt;&gt; A new problem report is waiting at<br>
 &gt;&gt; =C2=A0 <a href=3D"http://bugs.racket-lang.org/query/?cmd=3Dview&am=
 p;pr=3D14115" target=3D"_blank">http://bugs.racket-lang.org/query/?cmd=3Dvi=
 ew&amp;pr=3D14115</a><br>
 &gt;&gt;<br>
 &gt;&gt; Reported by Sam Tobin-Hochstadt for release:<br>
 &gt;&gt; 5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)<br>
 &gt;&gt;<br>
 &gt;&gt; *** Description:<br>
 &gt;&gt; I managed to get the below error in DrRacket, by doing something l=
 ike the<br>
 &gt;&gt; following:<br>
 &gt;&gt;<br>
 &gt;&gt; 1. Start editing the internals of `match`<br>
 &gt;&gt; 2. At some point, the internal error dialog pops up on every inser=
 t/delete<br>
 &gt;&gt; event in the bugger with the below error.<br>
 &gt;&gt;<br>
 &gt;&gt; query-rows: no such table: modules<br>
 &gt;&gt; =C2=A0 context...:<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.r=
 kt:369:0:<br>
 &gt;&gt; handle-status*<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.r=
 kt:330:8<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.r=
 kt:187:4:<br>
 &gt;&gt; prepare1* method in connection%<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/generic/functions.rk=
 t:165:0:<br>
 &gt;&gt; query-rows8<br>
 &gt;&gt; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6<b=
 r>
 &gt;&gt; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0=
 :<br>
 &gt;&gt; pkg-catalog-suggestions-for-module351<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/mo=
 dule-language.rkt:1222:6:<br>
 &gt;&gt; update-frame-expand-error method in .../module-language.rkt:1153:4=
 <br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/mo=
 dule-language.rkt:1523:6:<br>
 &gt;&gt; on-highlighted-errors method in .../module-language.rkt:1521:4<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/un=
 it.rkt:454:14:<br>
 &gt;&gt; after-delete method in ...ket/private/unit.rkt:438:12<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rk=
 t:4264:4:<br>
 &gt;&gt; after-delete method in ...ork/private/text.rkt:4072:2<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/mo=
 dule-language.rkt:2616:6:<br>
 &gt;&gt; after-delete method in .../module-language.rkt:2610:4<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rk=
 t:1808:2:<br>
 &gt;&gt; core1131<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rk=
 t:68:4:<br>
 &gt;&gt; undo method in insert-record%<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.=
 rkt:947:8:<br>
 &gt;&gt; loop<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.=
 rkt:943:2:<br>
 &gt;&gt; perform-undos method in editor%<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.=
 rkt:832:2:<br>
 &gt;&gt; undo method in editor%...<br>
 &gt;&gt;<br>
 &gt;&gt; *** How to repeat:<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt; *** Environment:<br>
 &gt;&gt; unix &quot;Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 1=
 8:16:28 UTC<br>
 &gt;&gt; 2013 x86_64 x86_64 x86_64 GNU/Linux&quot; (x86_64-linux/3m) (get-d=
 isplay-depth) =3D<br>
 &gt;&gt; 32<br>
 &gt;&gt; Human Language: english<br>
 &gt;&gt; (current-memory-use) 550321896<br>
 &gt;&gt; Links: (links) =3D (); (links #:user? #f) =3D (&quot;explorer&quot=
 ; &quot;drracket-solarized&quot;<br>
 &gt;&gt; &quot;meta&quot; &quot;find-pkg-deps&quot;); (links #:root? #t) =
 =3D (); (links #:user? #f #:root?<br>
 &gt;&gt; #t) =3D (#&lt;path:/home/samth/sw/raco-find-collection&gt;<br>
 &gt;&gt; #&lt;path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark&gt=
 ;<br>
 &gt;&gt; #&lt;path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach&=
 gt;)<br>
 &gt;&gt; raco pkg (show):<br>
 &gt;&gt; /home/samth/sw/plt/racket/share/devel-pkgs:<br>
 &gt;&gt; =C2=A0Package =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Chec=
 ksum =C2=A0 =C2=A0Source<br>
 &gt;&gt; =C2=A0main-distribution =C2=A0 =C2=A0#f =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0(static-link<br>
 &gt;&gt; ../../../pkgs/main-distribution)<br>
 &gt;&gt; =C2=A0plt-services =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0(static-link ../../../pkgs/plt-services)<br>
 &gt;&gt; =C2=A0racket-lib =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0(static-link<br>
 &gt;&gt; ../../../pkgs/racket-pkgs/racket-lib)<br>
 &gt;&gt; =C2=A0[199 auto-installed packages not shown]<br>
 &gt;&gt; Installation-wide:<br>
 &gt;&gt; =C2=A0Package =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 Checksum<br>
 &gt;&gt; Source<br>
 &gt;&gt; =C2=A0drracket-solarized =C2=A0 =C2=A0 =C2=A03c7ac56e3bde4f52653c0=
 8ad1058188f9bc10184<br>
 &gt;&gt; (catalog drracket-solarized)<br>
 &gt;&gt; =C2=A0explorer =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0edc1bde6799c2d9db536c7a844f916359c1a9d21<br>
 &gt;&gt; (catalog explorer)<br>
 &gt;&gt; =C2=A0find-pkg-deps =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(link<br>
 &gt;&gt; ../../../../../tmp/find-pkg-deps)<br>
 &gt;&gt; =C2=A0new-web =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 #f =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0(link<br>
 &gt;&gt; ../../../../../work/new-web)<br>
 &gt;&gt; =C2=A0optimization-coach =C2=A0 =C2=A0 =C2=A0ee002fa7483a5357b7b88=
 a254d3f28e034e4765f<br>
 &gt;&gt; (catalog optimization-coach)<br>
 &gt;&gt; =C2=A0racket-benchmark =C2=A0 =C2=A0 =C2=A0 =C2=A09c3ab066997c34f5=
 832a8e270f4c9a1222e5e1d0 =C2=A0 =C2=A0(url<br>
 &gt;&gt; git://<a href=3D"http://github.com/joshmcgrath08/racket-benchmark"=
  target=3D"_blank">github.com/joshmcgrath08/racket-benchmark</a>)<br>
 &gt;&gt; =C2=A0raco-find-collection =C2=A0 =C2=A0#f =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(link<br>
 &gt;&gt; ../../../../raco-find-collection)<br>
 &gt;&gt; User-specific for installation &quot;development&quot;:<br>
 &gt;&gt; =C2=A0[none]<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt; Collections:<br>
 &gt;&gt; (&quot;/home/samth/sw/plt/add-on/development/collects&quot;<br>
 &gt;&gt; =C2=A0(non-existent-path))<br>
 &gt;&gt; (&quot;/home/samth/sw/plt/racket/collects&quot;<br>
 &gt;&gt; =C2=A0(&quot;.gitignore&quot; &quot;acks&quot; &quot;compiler&quot=
 ; &quot;data&quot; &quot;db&quot; &quot;dynext&quot; &quot;ffi&quot; &quot;=
 file&quot; &quot;info&quot;<br>
 &gt;&gt; &quot;info-domain&quot; &quot;json&quot; &quot;launcher&quot; &quo=
 t;net&quot; &quot;openssl&quot; &quot;pkg&quot; &quot;planet&quot; &quot;ra=
 cket&quot;<br>
 &gt;&gt; &quot;raco&quot; &quot;reader&quot; &quot;realm&quot; &quot;s-exp&=
 quot; &quot;setup&quot; &quot;syntax&quot; &quot;unstable&quot; &quot;versi=
 on&quot;<br>
 &gt;&gt; &quot;xml&quot;))<br>
 &gt;&gt;<br>
 &gt;&gt; Recent Internal Errors:<br>
 &gt;&gt; Computer Language: ((&quot;Determine language from source&quot;) (=
 #(#t print<br>
 &gt;&gt; mixed-fraction-e #f #t debug) (default) #() &quot;#lang racket\n&q=
 uot; #t #t ((main)<br>
 &gt;&gt; (test)) #t))<br>
 &gt;&gt;<br>
 &gt;<br>
 </div></div></blockquote></div><br></div></div>
 
 --089e013cc3a65245e704e96e2f0c--
From: Robby Findler <robby@eecs.northwestern.edu>
To: Sam Tobin-Hochstadt <samth@cs.indiana.edu>
Cc: Jay McCarthy <jay.mccarthy@gmail.com>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Wed, 23 Oct 2013 15:33:35 -0500

 --089e013a1e3c755d3304e96e6eef
 Content-Type: text/plain; charset=UTF-8
 
 BTW, I don't know who assigned this to me, but I don't think that is right.
 
 Maybe Sam can stick a printf right at the call to
 pkg-catalog-suggestions-for-module and then see if making those calls
 triggers the error or something, but I think DrRacket's involvement is
 minimal.
 
 Robby
 
 
 On Wed, Oct 23, 2013 at 3:15 PM, Robby Findler
 <robby@eecs.northwestern.edu>wrote:
 
 >
 >
 >
 > On Wed, Oct 23, 2013 at 3:05 PM, Sam Tobin-Hochstadt <samth@cs.indiana.edu
 > > wrote:
 >
 >> I still haven't figured out how to reliably trigger this, but when it
 >> does happen, it seems quite bad.  In particular, the internal error
 >> happens on every keystroke in the tab, rendering the tab useless. Even
 >> disabling online compilation doesn't cause the error to stop
 >> happening.
 >>
 >> Robby, could DrRacket recover better here?
 >>
 >>
 > The sensible place to put error recovery here seems like it should be
 > inside the pkg manager, but I'll put something into drracket for now that
 > will swallow the errors. It doesn't seem great, but better than a disabled
 > drracket.
 >
 > Robby
 >
 >
 >> Jay, any thoughts on what might be going on?
 >>
 >> Sam
 >>
 >> On Tue, Oct 22, 2013 at 3:06 PM, Robby Findler
 >> <robby@eecs.northwestern.edu> wrote:
 >> > From the drr perspective, this lookslike a bug in the pkg library since
 >> drr
 >> > doesn't expect pkg-catalog-suggestions-for-module to ever signal an
 >> error
 >> > (unless its contract is violated), which isn't happening in this case.
 >> >
 >> > If that's not the case, then I can change drr to check whatever
 >> assumption
 >> > needs to hold, tho.
 >> >
 >> > Robby
 >> >
 >> >
 >> > On Tue, Oct 22, 2013 at 12:24 PM, <samth@cs.indiana.edu> wrote:
 >> >>
 >> >> A new problem report is waiting at
 >> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=14115
 >> >>
 >> >> Reported by Sam Tobin-Hochstadt for release:
 >> >> 5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)
 >> >>
 >> >> *** Description:
 >> >> I managed to get the below error in DrRacket, by doing something like
 >> the
 >> >> following:
 >> >>
 >> >> 1. Start editing the internals of `match`
 >> >> 2. At some point, the internal error dialog pops up on every
 >> insert/delete
 >> >> event in the bugger with the below error.
 >> >>
 >> >> query-rows: no such table: modules
 >> >>   context...:
 >> >>
 >> >>
 >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 >> >> handle-status*
 >> >>
 >> >>
 >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 >> >>
 >> >>
 >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 >> >> prepare1* method in connection%
 >> >>
 >> >>
 >> /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 >> >> query-rows8
 >> >>    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 >> >>    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 >> >> pkg-catalog-suggestions-for-module351
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1222:6:
 >> >> update-frame-expand-error method in .../module-language.rkt:1153:4
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1523:6:
 >> >> on-highlighted-errors method in .../module-language.rkt:1521:4
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/unit.rkt:454:14:
 >> >> after-delete method in ...ket/private/unit.rkt:438:12
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rkt:4264:4:
 >> >> after-delete method in ...ork/private/text.rkt:4072:2
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:2616:6:
 >> >> after-delete method in .../module-language.rkt:2610:4
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rkt:1808:2:
 >> >> core1131
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rkt:68:4:
 >> >> undo method in insert-record%
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:947:8:
 >> >> loop
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:943:2:
 >> >> perform-undos method in editor%
 >> >>
 >> >>
 >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:832:2:
 >> >> undo method in editor%...
 >> >>
 >> >> *** How to repeat:
 >> >>
 >> >>
 >> >> *** Environment:
 >> >> unix "Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28
 >> UTC
 >> >> 2013 x86_64 x86_64 x86_64 GNU/Linux" (x86_64-linux/3m)
 >> (get-display-depth) =
 >> >> 32
 >> >> Human Language: english
 >> >> (current-memory-use) 550321896
 >> >> Links: (links) = (); (links #:user? #f) = ("explorer"
 >> "drracket-solarized"
 >> >> "meta" "find-pkg-deps"); (links #:root? #t) = (); (links #:user? #f
 >> #:root?
 >> >> #t) = (#<path:/home/samth/sw/raco-find-collection>
 >> >> #<path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark>
 >> >> #<path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach>)
 >> >> raco pkg (show):
 >> >> /home/samth/sw/plt/racket/share/devel-pkgs:
 >> >>  Package              Checksum    Source
 >> >>  main-distribution    #f          (static-link
 >> >> ../../../pkgs/main-distribution)
 >> >>  plt-services         #f          (static-link
 >> ../../../pkgs/plt-services)
 >> >>  racket-lib           #f          (static-link
 >> >> ../../../pkgs/racket-pkgs/racket-lib)
 >> >>  [199 auto-installed packages not shown]
 >> >> Installation-wide:
 >> >>  Package                 Checksum
 >> >> Source
 >> >>  drracket-solarized      3c7ac56e3bde4f52653c08ad1058188f9bc10184
 >> >> (catalog drracket-solarized)
 >> >>  explorer                edc1bde6799c2d9db536c7a844f916359c1a9d21
 >> >> (catalog explorer)
 >> >>  find-pkg-deps           #f
 >>  (link
 >> >> ../../../../../tmp/find-pkg-deps)
 >> >>  new-web                 #f
 >>  (link
 >> >> ../../../../../work/new-web)
 >> >>  optimization-coach      ee002fa7483a5357b7b88a254d3f28e034e4765f
 >> >> (catalog optimization-coach)
 >> >>  racket-benchmark        9c3ab066997c34f5832a8e270f4c9a1222e5e1d0
 >>  (url
 >> >> git://github.com/joshmcgrath08/racket-benchmark)
 >> >>  raco-find-collection    #f
 >>  (link
 >> >> ../../../../raco-find-collection)
 >> >> User-specific for installation "development":
 >> >>  [none]
 >> >>
 >> >>
 >> >>
 >> >> Collections:
 >> >> ("/home/samth/sw/plt/add-on/development/collects"
 >> >>  (non-existent-path))
 >> >> ("/home/samth/sw/plt/racket/collects"
 >> >>  (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file"
 >> "info"
 >> >> "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet" "racket"
 >> >> "raco" "reader" "realm" "s-exp" "setup" "syntax" "unstable" "version"
 >> >> "xml"))
 >> >>
 >> >> Recent Internal Errors:
 >> >> Computer Language: (("Determine language from source") (#(#t print
 >> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t
 >> ((main)
 >> >> (test)) #t))
 >> >>
 >> >
 >>
 >
 >
 
 --089e013a1e3c755d3304e96e6eef
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div dir=3D"ltr">BTW, I don&#39;t know who assigned this to me, but I don&#=
 39;t think that is right.<br><br>Maybe Sam can stick a printf right at the =
 call to pkg-catalog-suggestions-for-module and then see if making those cal=
 ls triggers the error or something, but I think DrRacket&#39;s involvement =
 is minimal.<br>
 <br>Robby<br></div><div class=3D"gmail_extra"><br><br><div class=3D"gmail_q=
 uote">On Wed, Oct 23, 2013 at 3:15 PM, Robby Findler <span dir=3D"ltr">&lt;=
 <a href=3D"mailto:robby@eecs.northwestern.edu" target=3D"_blank">robby@eecs=
 .northwestern.edu</a>&gt;</span> wrote:<br>
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex"><div dir=3D"ltr"><br><div class=3D"gmail_ext=
 ra"><br><br><div class=3D"gmail_quote"><div class=3D"im">On Wed, Oct 23, 20=
 13 at 3:05 PM, Sam Tobin-Hochstadt <span dir=3D"ltr">&lt;<a href=3D"mailto:=
 samth@cs.indiana.edu" target=3D"_blank">samth@cs.indiana.edu</a>&gt;</span>=
  wrote:<br>
 
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex">I still haven&#39;t figured out how to relia=
 bly trigger this, but when it<br>
 does happen, it seems quite bad. =C2=A0In particular, the internal error<br=
 >
 happens on every keystroke in the tab, rendering the tab useless. Even<br>
 disabling online compilation doesn&#39;t cause the error to stop<br>
 happening.<br>
 <br>
 Robby, could DrRacket recover better here?<br>
 <br></blockquote><div><br></div></div><div>The sensible place to put error =
 recovery here seems like it should be inside the pkg manager, but I&#39;ll =
 put something into drracket for now that will swallow the errors. It doesn&=
 #39;t seem great, but better than a disabled drracket.</div>
 <span class=3D"HOEnZb"><font color=3D"#888888">
 <div><br></div><div>Robby</div></font></span><div><div class=3D"h5"><div>=
 =C2=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;bo=
 rder-left:1px #ccc solid;padding-left:1ex">
 Jay, any thoughts on what might be going on?<br>
 <span><font color=3D"#888888"><br>
 Sam<br>
 </font></span><div><div><br>
 On Tue, Oct 22, 2013 at 3:06 PM, Robby Findler<br>
 &lt;<a href=3D"mailto:robby@eecs.northwestern.edu" target=3D"_blank">robby@=
 eecs.northwestern.edu</a>&gt; wrote:<br>
 &gt; From the drr perspective, this lookslike a bug in the pkg library sinc=
 e drr<br>
 &gt; doesn&#39;t expect pkg-catalog-suggestions-for-module to ever signal a=
 n error<br>
 &gt; (unless its contract is violated), which isn&#39;t happening in this c=
 ase.<br>
 &gt;<br>
 &gt; If that&#39;s not the case, then I can change drr to check whatever as=
 sumption<br>
 &gt; needs to hold, tho.<br>
 &gt;<br>
 &gt; Robby<br>
 &gt;<br>
 &gt;<br>
 &gt; On Tue, Oct 22, 2013 at 12:24 PM, &lt;<a href=3D"mailto:samth@cs.india=
 na.edu" target=3D"_blank">samth@cs.indiana.edu</a>&gt; wrote:<br>
 &gt;&gt;<br>
 &gt;&gt; A new problem report is waiting at<br>
 &gt;&gt; =C2=A0 <a href=3D"http://bugs.racket-lang.org/query/?cmd=3Dview&am=
 p;pr=3D14115" target=3D"_blank">http://bugs.racket-lang.org/query/?cmd=3Dvi=
 ew&amp;pr=3D14115</a><br>
 &gt;&gt;<br>
 &gt;&gt; Reported by Sam Tobin-Hochstadt for release:<br>
 &gt;&gt; 5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)<br>
 &gt;&gt;<br>
 &gt;&gt; *** Description:<br>
 &gt;&gt; I managed to get the below error in DrRacket, by doing something l=
 ike the<br>
 &gt;&gt; following:<br>
 &gt;&gt;<br>
 &gt;&gt; 1. Start editing the internals of `match`<br>
 &gt;&gt; 2. At some point, the internal error dialog pops up on every inser=
 t/delete<br>
 &gt;&gt; event in the bugger with the below error.<br>
 &gt;&gt;<br>
 &gt;&gt; query-rows: no such table: modules<br>
 &gt;&gt; =C2=A0 context...:<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.r=
 kt:369:0:<br>
 &gt;&gt; handle-status*<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.r=
 kt:330:8<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.r=
 kt:187:4:<br>
 &gt;&gt; prepare1* method in connection%<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/racket/collects/db/private/generic/functions.rk=
 t:165:0:<br>
 &gt;&gt; query-rows8<br>
 &gt;&gt; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6<b=
 r>
 &gt;&gt; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0=
 :<br>
 &gt;&gt; pkg-catalog-suggestions-for-module351<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/mo=
 dule-language.rkt:1222:6:<br>
 &gt;&gt; update-frame-expand-error method in .../module-language.rkt:1153:4=
 <br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/mo=
 dule-language.rkt:1523:6:<br>
 &gt;&gt; on-highlighted-errors method in .../module-language.rkt:1521:4<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/un=
 it.rkt:454:14:<br>
 &gt;&gt; after-delete method in ...ket/private/unit.rkt:438:12<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rk=
 t:4264:4:<br>
 &gt;&gt; after-delete method in ...ork/private/text.rkt:4072:2<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/mo=
 dule-language.rkt:2616:6:<br>
 &gt;&gt; after-delete method in .../module-language.rkt:2610:4<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rk=
 t:1808:2:<br>
 &gt;&gt; core1131<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rk=
 t:68:4:<br>
 &gt;&gt; undo method in insert-record%<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.=
 rkt:947:8:<br>
 &gt;&gt; loop<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.=
 rkt:943:2:<br>
 &gt;&gt; perform-undos method in editor%<br>
 &gt;&gt;<br>
 &gt;&gt; /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.=
 rkt:832:2:<br>
 &gt;&gt; undo method in editor%...<br>
 &gt;&gt;<br>
 &gt;&gt; *** How to repeat:<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt; *** Environment:<br>
 &gt;&gt; unix &quot;Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 1=
 8:16:28 UTC<br>
 &gt;&gt; 2013 x86_64 x86_64 x86_64 GNU/Linux&quot; (x86_64-linux/3m) (get-d=
 isplay-depth) =3D<br>
 &gt;&gt; 32<br>
 &gt;&gt; Human Language: english<br>
 &gt;&gt; (current-memory-use) 550321896<br>
 &gt;&gt; Links: (links) =3D (); (links #:user? #f) =3D (&quot;explorer&quot=
 ; &quot;drracket-solarized&quot;<br>
 &gt;&gt; &quot;meta&quot; &quot;find-pkg-deps&quot;); (links #:root? #t) =
 =3D (); (links #:user? #f #:root?<br>
 &gt;&gt; #t) =3D (#&lt;path:/home/samth/sw/raco-find-collection&gt;<br>
 &gt;&gt; #&lt;path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark&gt=
 ;<br>
 &gt;&gt; #&lt;path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach&=
 gt;)<br>
 &gt;&gt; raco pkg (show):<br>
 &gt;&gt; /home/samth/sw/plt/racket/share/devel-pkgs:<br>
 &gt;&gt; =C2=A0Package =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Chec=
 ksum =C2=A0 =C2=A0Source<br>
 &gt;&gt; =C2=A0main-distribution =C2=A0 =C2=A0#f =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0(static-link<br>
 &gt;&gt; ../../../pkgs/main-distribution)<br>
 &gt;&gt; =C2=A0plt-services =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0(static-link ../../../pkgs/plt-services)<br>
 &gt;&gt; =C2=A0racket-lib =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0(static-link<br>
 &gt;&gt; ../../../pkgs/racket-pkgs/racket-lib)<br>
 &gt;&gt; =C2=A0[199 auto-installed packages not shown]<br>
 &gt;&gt; Installation-wide:<br>
 &gt;&gt; =C2=A0Package =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 Checksum<br>
 &gt;&gt; Source<br>
 &gt;&gt; =C2=A0drracket-solarized =C2=A0 =C2=A0 =C2=A03c7ac56e3bde4f52653c0=
 8ad1058188f9bc10184<br>
 &gt;&gt; (catalog drracket-solarized)<br>
 &gt;&gt; =C2=A0explorer =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0edc1bde6799c2d9db536c7a844f916359c1a9d21<br>
 &gt;&gt; (catalog explorer)<br>
 &gt;&gt; =C2=A0find-pkg-deps =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 #f =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(link<br>
 &gt;&gt; ../../../../../tmp/find-pkg-deps)<br>
 &gt;&gt; =C2=A0new-web =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 #f =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0(link<br>
 &gt;&gt; ../../../../../work/new-web)<br>
 &gt;&gt; =C2=A0optimization-coach =C2=A0 =C2=A0 =C2=A0ee002fa7483a5357b7b88=
 a254d3f28e034e4765f<br>
 &gt;&gt; (catalog optimization-coach)<br>
 &gt;&gt; =C2=A0racket-benchmark =C2=A0 =C2=A0 =C2=A0 =C2=A09c3ab066997c34f5=
 832a8e270f4c9a1222e5e1d0 =C2=A0 =C2=A0(url<br>
 &gt;&gt; git://<a href=3D"http://github.com/joshmcgrath08/racket-benchmark"=
  target=3D"_blank">github.com/joshmcgrath08/racket-benchmark</a>)<br>
 &gt;&gt; =C2=A0raco-find-collection =C2=A0 =C2=A0#f =C2=A0 =C2=A0 =C2=A0 =
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
 =A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0(link<br>
 &gt;&gt; ../../../../raco-find-collection)<br>
 &gt;&gt; User-specific for installation &quot;development&quot;:<br>
 &gt;&gt; =C2=A0[none]<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt;<br>
 &gt;&gt; Collections:<br>
 &gt;&gt; (&quot;/home/samth/sw/plt/add-on/development/collects&quot;<br>
 &gt;&gt; =C2=A0(non-existent-path))<br>
 &gt;&gt; (&quot;/home/samth/sw/plt/racket/collects&quot;<br>
 &gt;&gt; =C2=A0(&quot;.gitignore&quot; &quot;acks&quot; &quot;compiler&quot=
 ; &quot;data&quot; &quot;db&quot; &quot;dynext&quot; &quot;ffi&quot; &quot;=
 file&quot; &quot;info&quot;<br>
 &gt;&gt; &quot;info-domain&quot; &quot;json&quot; &quot;launcher&quot; &quo=
 t;net&quot; &quot;openssl&quot; &quot;pkg&quot; &quot;planet&quot; &quot;ra=
 cket&quot;<br>
 &gt;&gt; &quot;raco&quot; &quot;reader&quot; &quot;realm&quot; &quot;s-exp&=
 quot; &quot;setup&quot; &quot;syntax&quot; &quot;unstable&quot; &quot;versi=
 on&quot;<br>
 &gt;&gt; &quot;xml&quot;))<br>
 &gt;&gt;<br>
 &gt;&gt; Recent Internal Errors:<br>
 &gt;&gt; Computer Language: ((&quot;Determine language from source&quot;) (=
 #(#t print<br>
 &gt;&gt; mixed-fraction-e #f #t debug) (default) #() &quot;#lang racket\n&q=
 uot; #t #t ((main)<br>
 &gt;&gt; (test)) #t))<br>
 &gt;&gt;<br>
 &gt;<br>
 </div></div></blockquote></div></div></div><br></div></div>
 </blockquote></div><br></div>
 
 --089e013a1e3c755d3304e96e6eef--

----------
A commit by robby@racket-lang.org was marked as relevant
  http://git.racket-lang.org/plt/commit/2fc1942e26
  | don't die when pkg-catalog-suggestions-for-module raises an error
  | 
  | related to PR 14115

From: Sam Tobin-Hochstadt <samth@cs.indiana.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Jay McCarthy <jay.mccarthy@gmail.com>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Wed, 23 Oct 2013 16:40:43 -0400

 On Wed, Oct 23, 2013 at 4:33 PM, Robby Findler
 <robby@eecs.northwestern.edu> wrote:
 > BTW, I don't know who assigned this to me, but I don't think that is right.
 
 I think I assigned this to you immediately after reporting it, before
 I had any further idea what was wrong.
 
 You should always feel free to re-assign bugs -- the system won't
 really work if it relies on the initial triage getting the assignment
 right.
 
 > Maybe Sam can stick a printf right at the call to
 > pkg-catalog-suggestions-for-module and then see if making those calls
 > triggers the error or something, but I think DrRacket's involvement is
 > minimal.
 
 I can currently trigger the error by opening a new DrR, changing the
 #lang line to #lang racket/foo and hitting run (although then the
 error appears in the error output, not as an internal error). I'll try
 this next.
 
 Sam
 
 >
 > Robby
 >
 >
 > On Wed, Oct 23, 2013 at 3:15 PM, Robby Findler <robby@eecs.northwestern.edu>
 > wrote:
 >>
 >>
 >>
 >>
 >> On Wed, Oct 23, 2013 at 3:05 PM, Sam Tobin-Hochstadt
 >> <samth@cs.indiana.edu> wrote:
 >>>
 >>> I still haven't figured out how to reliably trigger this, but when it
 >>> does happen, it seems quite bad.  In particular, the internal error
 >>> happens on every keystroke in the tab, rendering the tab useless. Even
 >>> disabling online compilation doesn't cause the error to stop
 >>> happening.
 >>>
 >>> Robby, could DrRacket recover better here?
 >>>
 >>
 >> The sensible place to put error recovery here seems like it should be
 >> inside the pkg manager, but I'll put something into drracket for now that
 >> will swallow the errors. It doesn't seem great, but better than a disabled
 >> drracket.
 >>
 >> Robby
 >>
 >>>
 >>> Jay, any thoughts on what might be going on?
 >>>
 >>> Sam
 >>>
 >>> On Tue, Oct 22, 2013 at 3:06 PM, Robby Findler
 >>> <robby@eecs.northwestern.edu> wrote:
 >>> > From the drr perspective, this lookslike a bug in the pkg library since
 >>> > drr
 >>> > doesn't expect pkg-catalog-suggestions-for-module to ever signal an
 >>> > error
 >>> > (unless its contract is violated), which isn't happening in this case.
 >>> >
 >>> > If that's not the case, then I can change drr to check whatever
 >>> > assumption
 >>> > needs to hold, tho.
 >>> >
 >>> > Robby
 >>> >
 >>> >
 >>> > On Tue, Oct 22, 2013 at 12:24 PM, <samth@cs.indiana.edu> wrote:
 >>> >>
 >>> >> A new problem report is waiting at
 >>> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=14115
 >>> >>
 >>> >> Reported by Sam Tobin-Hochstadt for release:
 >>> >> 5.90.0.9--2013-10-22(2fa0b53b/d/better-subtype)
 >>> >>
 >>> >> *** Description:
 >>> >> I managed to get the below error in DrRacket, by doing something like
 >>> >> the
 >>> >> following:
 >>> >>
 >>> >> 1. Start editing the internals of `match`
 >>> >> 2. At some point, the internal error dialog pops up on every
 >>> >> insert/delete
 >>> >> event in the bugger with the below error.
 >>> >>
 >>> >> query-rows: no such table: modules
 >>> >>   context...:
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 >>> >> handle-status*
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 >>> >> prepare1* method in connection%
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 >>> >> query-rows8
 >>> >>    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 >>> >>    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 >>> >> pkg-catalog-suggestions-for-module351
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1222:6:
 >>> >> update-frame-expand-error method in .../module-language.rkt:1153:4
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:1523:6:
 >>> >> on-highlighted-errors method in .../module-language.rkt:1521:4
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/unit.rkt:454:14:
 >>> >> after-delete method in ...ket/private/unit.rkt:438:12
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/framework/private/text.rkt:4264:4:
 >>> >> after-delete method in ...ork/private/text.rkt:4072:2
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/drracket-pkgs/drracket/drracket/private/module-language.rkt:2616:6:
 >>> >> after-delete method in .../module-language.rkt:2610:4
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/text.rkt:1808:2:
 >>> >> core1131
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/undo.rkt:68:4:
 >>> >> undo method in insert-record%
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:947:8:
 >>> >> loop
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:943:2:
 >>> >> perform-undos method in editor%
 >>> >>
 >>> >>
 >>> >> /home/samth/sw/plt/pkgs/gui-pkgs/gui-lib/mred/private/wxme/editor.rkt:832:2:
 >>> >> undo method in editor%...
 >>> >>
 >>> >> *** How to repeat:
 >>> >>
 >>> >>
 >>> >> *** Environment:
 >>> >> unix "Linux huor 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28
 >>> >> UTC
 >>> >> 2013 x86_64 x86_64 x86_64 GNU/Linux" (x86_64-linux/3m)
 >>> >> (get-display-depth) =
 >>> >> 32
 >>> >> Human Language: english
 >>> >> (current-memory-use) 550321896
 >>> >> Links: (links) = (); (links #:user? #f) = ("explorer"
 >>> >> "drracket-solarized"
 >>> >> "meta" "find-pkg-deps"); (links #:root? #t) = (); (links #:user? #f
 >>> >> #:root?
 >>> >> #t) = (#<path:/home/samth/sw/raco-find-collection>
 >>> >> #<path:/home/samth/sw/plt/racket/share/pkgs/racket-benchmark>
 >>> >> #<path:/home/samth/sw/plt/racket/share/pkgs/optimization-coach>)
 >>> >> raco pkg (show):
 >>> >> /home/samth/sw/plt/racket/share/devel-pkgs:
 >>> >>  Package              Checksum    Source
 >>> >>  main-distribution    #f          (static-link
 >>> >> ../../../pkgs/main-distribution)
 >>> >>  plt-services         #f          (static-link
 >>> >> ../../../pkgs/plt-services)
 >>> >>  racket-lib           #f          (static-link
 >>> >> ../../../pkgs/racket-pkgs/racket-lib)
 >>> >>  [199 auto-installed packages not shown]
 >>> >> Installation-wide:
 >>> >>  Package                 Checksum
 >>> >> Source
 >>> >>  drracket-solarized      3c7ac56e3bde4f52653c08ad1058188f9bc10184
 >>> >> (catalog drracket-solarized)
 >>> >>  explorer                edc1bde6799c2d9db536c7a844f916359c1a9d21
 >>> >> (catalog explorer)
 >>> >>  find-pkg-deps           #f
 >>> >> (link
 >>> >> ../../../../../tmp/find-pkg-deps)
 >>> >>  new-web                 #f
 >>> >> (link
 >>> >> ../../../../../work/new-web)
 >>> >>  optimization-coach      ee002fa7483a5357b7b88a254d3f28e034e4765f
 >>> >> (catalog optimization-coach)
 >>> >>  racket-benchmark        9c3ab066997c34f5832a8e270f4c9a1222e5e1d0
 >>> >> (url
 >>> >> git://github.com/joshmcgrath08/racket-benchmark)
 >>> >>  raco-find-collection    #f
 >>> >> (link
 >>> >> ../../../../raco-find-collection)
 >>> >> User-specific for installation "development":
 >>> >>  [none]
 >>> >>
 >>> >>
 >>> >>
 >>> >> Collections:
 >>> >> ("/home/samth/sw/plt/add-on/development/collects"
 >>> >>  (non-existent-path))
 >>> >> ("/home/samth/sw/plt/racket/collects"
 >>> >>  (".gitignore" "acks" "compiler" "data" "db" "dynext" "ffi" "file"
 >>> >> "info"
 >>> >> "info-domain" "json" "launcher" "net" "openssl" "pkg" "planet"
 >>> >> "racket"
 >>> >> "raco" "reader" "realm" "s-exp" "setup" "syntax" "unstable" "version"
 >>> >> "xml"))
 >>> >>
 >>> >> Recent Internal Errors:
 >>> >> Computer Language: (("Determine language from source") (#(#t print
 >>> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t
 >>> >> ((main)
 >>> >> (test)) #t))
 >>> >>
 >>> >
 >>
 >>
 >
From: Sam Tobin-Hochstadt <samth@cs.indiana.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Jay McCarthy <jay.mccarthy@gmail.com>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Wed, 23 Oct 2013 16:52:29 -0400

 On Wed, Oct 23, 2013 at 4:40 PM, Sam Tobin-Hochstadt
 <samth@cs.indiana.edu> wrote:
 >
 >> Maybe Sam can stick a printf right at the call to
 >> pkg-catalog-suggestions-for-module and then see if making those calls
 >> triggers the error or something, but I think DrRacket's involvement is
 >> minimal.
 >
 > I can currently trigger the error by opening a new DrR, changing the
 > #lang line to #lang racket/foo and hitting run (although then the
 > error appears in the error output, not as an internal error). I'll try
 > this next.
 
 Yup, here's the error for me:
 
 Welcome to Racket v5.90.0.9.
 -> (require pkg/lib)
 -> (pkg-catalog-suggestions-for-module "racket/foo/lang/reader")
 >>> pkg-catalog-suggestions-for-module racket/foo/lang/reader /home/samth/sw/plt/add-on/5.90.0.9/pkgs/catalog.sqlite
 ; query-rows: no such table: modules [,bt for context]
 -> ,bt
 ; query-rows: no such table: modules
 ;   context...:
 ;    /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 handle-status*
 ;    /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 ;    /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 prepare1* method in connection%
 ;    /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 query-rows8
 ;    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 ;    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 pkg-catalog-suggestions-for-module351
 ;    /home/samth/sw/plt/pkgs/xrepl-pkgs/xrepl-lib/xrepl/xrepl.rkt:1346:0
 ;    /home/samth/sw/plt/racket/collects/racket/private/misc.rkt:87:7
 ->
 
 Sam
From: Sam Tobin-Hochstadt <samth@cs.indiana.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Jay McCarthy <jay.mccarthy@gmail.com>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Wed, 23 Oct 2013 17:02:42 -0400

 I'm unable to replicate this on a clean install, so it seems like I
 must have gotten my pkg db into a bad state. Which means that some
 sort of error handling is probably the right way to go.
 
 Sam
 
 On Wed, Oct 23, 2013 at 4:52 PM, Sam Tobin-Hochstadt
 <samth@cs.indiana.edu> wrote:
 > On Wed, Oct 23, 2013 at 4:40 PM, Sam Tobin-Hochstadt
 > <samth@cs.indiana.edu> wrote:
 >>
 >>> Maybe Sam can stick a printf right at the call to
 >>> pkg-catalog-suggestions-for-module and then see if making those calls
 >>> triggers the error or something, but I think DrRacket's involvement is
 >>> minimal.
 >>
 >> I can currently trigger the error by opening a new DrR, changing the
 >> #lang line to #lang racket/foo and hitting run (although then the
 >> error appears in the error output, not as an internal error). I'll try
 >> this next.
 >
 > Yup, here's the error for me:
 >
 > Welcome to Racket v5.90.0.9.
 > -> (require pkg/lib)
 > -> (pkg-catalog-suggestions-for-module "racket/foo/lang/reader")
 >>>> pkg-catalog-suggestions-for-module racket/foo/lang/reader /home/samth/sw/plt/add-on/5.90.0.9/pkgs/catalog.sqlite
 > ; query-rows: no such table: modules [,bt for context]
 > -> ,bt
 > ; query-rows: no such table: modules
 > ;   context...:
 > ;    /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 > handle-status*
 > ;    /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 > ;    /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 > prepare1* method in connection%
 > ;    /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 > query-rows8
 > ;    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 > ;    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 > pkg-catalog-suggestions-for-module351
 > ;    /home/samth/sw/plt/pkgs/xrepl-pkgs/xrepl-lib/xrepl/xrepl.rkt:1346:0
 > ;    /home/samth/sw/plt/racket/collects/racket/private/misc.rkt:87:7
 > ->
 >
 > Sam

Responsible changed from "robby" to "jay" by robby at Wed, 23 Oct 2013 17:14:35 -0400
Reason>>> pkg

From: Robby Findler <robby@eecs.northwestern.edu>
To: Sam Tobin-Hochstadt <samth@cs.indiana.edu>
Cc: Jay McCarthy <jay.mccarthy@gmail.com>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Wed, 23 Oct 2013 16:14:04 -0500

 --047d7b33cd74377cff04e96effdf
 Content-Type: text/plain; charset=UTF-8
 
 This sounds right to me, but I still think it belongs inside the pkg system
 as this function should not signal errors.
 
 Also, I don't know who should get this. I'll assign it to Jay, tho as a
 best guess.
 
 Robby
 
 
 On Wed, Oct 23, 2013 at 4:02 PM, Sam Tobin-Hochstadt
 <samth@cs.indiana.edu>wrote:
 
 > I'm unable to replicate this on a clean install, so it seems like I
 > must have gotten my pkg db into a bad state. Which means that some
 > sort of error handling is probably the right way to go.
 >
 > Sam
 >
 > On Wed, Oct 23, 2013 at 4:52 PM, Sam Tobin-Hochstadt
 > <samth@cs.indiana.edu> wrote:
 > > On Wed, Oct 23, 2013 at 4:40 PM, Sam Tobin-Hochstadt
 > > <samth@cs.indiana.edu> wrote:
 > >>
 > >>> Maybe Sam can stick a printf right at the call to
 > >>> pkg-catalog-suggestions-for-module and then see if making those calls
 > >>> triggers the error or something, but I think DrRacket's involvement is
 > >>> minimal.
 > >>
 > >> I can currently trigger the error by opening a new DrR, changing the
 > >> #lang line to #lang racket/foo and hitting run (although then the
 > >> error appears in the error output, not as an internal error). I'll try
 > >> this next.
 > >
 > > Yup, here's the error for me:
 > >
 > > Welcome to Racket v5.90.0.9.
 > > -> (require pkg/lib)
 > > -> (pkg-catalog-suggestions-for-module "racket/foo/lang/reader")
 > >>>> pkg-catalog-suggestions-for-module racket/foo/lang/reader
 > /home/samth/sw/plt/add-on/5.90.0.9/pkgs/catalog.sqlite
 > > ; query-rows: no such table: modules [,bt for context]
 > > -> ,bt
 > > ; query-rows: no such table: modules
 > > ;   context...:
 > > ;
 >  /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 > > handle-status*
 > > ;
 >  /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 > > ;
 >  /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 > > prepare1* method in connection%
 > > ;
 >  /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 > > query-rows8
 > > ;    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 > > ;    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 > > pkg-catalog-suggestions-for-module351
 > > ;    /home/samth/sw/plt/pkgs/xrepl-pkgs/xrepl-lib/xrepl/xrepl.rkt:1346:0
 > > ;    /home/samth/sw/plt/racket/collects/racket/private/misc.rkt:87:7
 > > ->
 > >
 > > Sam
 >
 
 --047d7b33cd74377cff04e96effdf
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <div dir=3D"ltr">This sounds right to me, but I still think it belongs insi=
 de the pkg system as this function should not signal errors.<div><br></div>=
 <div>Also, I don&#39;t know who should get this. I&#39;ll assign it to Jay,=
  tho as a best guess.</div>
 <div><br>Robby</div></div><div class=3D"gmail_extra"><br><br><div class=3D"=
 gmail_quote">On Wed, Oct 23, 2013 at 4:02 PM, Sam Tobin-Hochstadt <span dir=
 =3D"ltr">&lt;<a href=3D"mailto:samth@cs.indiana.edu" target=3D"_blank">samt=
 h@cs.indiana.edu</a>&gt;</span> wrote:<br>
 <blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
 x #ccc solid;padding-left:1ex">I&#39;m unable to replicate this on a clean =
 install, so it seems like I<br>
 must have gotten my pkg db into a bad state. Which means that some<br>
 sort of error handling is probably the right way to go.<br>
 <br>
 Sam<br>
 <br>
 On Wed, Oct 23, 2013 at 4:52 PM, Sam Tobin-Hochstadt<br>
 <div class=3D"HOEnZb"><div class=3D"h5">&lt;<a href=3D"mailto:samth@cs.indi=
 ana.edu">samth@cs.indiana.edu</a>&gt; wrote:<br>
 &gt; On Wed, Oct 23, 2013 at 4:40 PM, Sam Tobin-Hochstadt<br>
 &gt; &lt;<a href=3D"mailto:samth@cs.indiana.edu">samth@cs.indiana.edu</a>&g=
 t; wrote:<br>
 &gt;&gt;<br>
 &gt;&gt;&gt; Maybe Sam can stick a printf right at the call to<br>
 &gt;&gt;&gt; pkg-catalog-suggestions-for-module and then see if making thos=
 e calls<br>
 &gt;&gt;&gt; triggers the error or something, but I think DrRacket&#39;s in=
 volvement is<br>
 &gt;&gt;&gt; minimal.<br>
 &gt;&gt;<br>
 &gt;&gt; I can currently trigger the error by opening a new DrR, changing t=
 he<br>
 &gt;&gt; #lang line to #lang racket/foo and hitting run (although then the<=
 br>
 &gt;&gt; error appears in the error output, not as an internal error). I&#3=
 9;ll try<br>
 &gt;&gt; this next.<br>
 &gt;<br>
 &gt; Yup, here&#39;s the error for me:<br>
 &gt;<br>
 &gt; Welcome to Racket v5.90.0.9.<br>
 &gt; -&gt; (require pkg/lib)<br>
 &gt; -&gt; (pkg-catalog-suggestions-for-module &quot;racket/foo/lang/reader=
 &quot;)<br>
 &gt;&gt;&gt;&gt; pkg-catalog-suggestions-for-module racket/foo/lang/reader =
 /home/samth/sw/plt/add-on/<a href=3D"http://5.90.0.9/pkgs/catalog.sqlite" t=
 arget=3D"_blank">5.90.0.9/pkgs/catalog.sqlite</a><br>
 &gt; ; query-rows: no such table: modules [,bt for context]<br>
 &gt; -&gt; ,bt<br>
 &gt; ; query-rows: no such table: modules<br>
 &gt; ; =C2=A0 context...:<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/sqlite3/c=
 onnection.rkt:369:0:<br>
 &gt; handle-status*<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/sqlite3/c=
 onnection.rkt:330:8<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/sqlite3/c=
 onnection.rkt:187:4:<br>
 &gt; prepare1* method in connection%<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/db/private/generic/f=
 unctions.rkt:165:0:<br>
 &gt; query-rows8<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:<=
 br>
 &gt; pkg-catalog-suggestions-for-module351<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/pkgs/xrepl-pkgs/xrepl-lib/xrepl/xrep=
 l.rkt:1346:0<br>
 &gt; ; =C2=A0 =C2=A0/home/samth/sw/plt/racket/collects/racket/private/misc.=
 rkt:87:7<br>
 &gt; -&gt;<br>
 &gt;<br>
 &gt; Sam<br>
 </div></div></blockquote></div><br></div>
 
 --047d7b33cd74377cff04e96effdf--
From: Jay McCarthy <jay.mccarthy@gmail.com>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Sam Tobin-Hochstadt <samth@cs.indiana.edu>, bugs <bugs@racket-lang.org>,
        nobody <nobody@racket-lang.org>,
        bug-notification <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/14115: internal drracket error: query-rows: no
 such table: modules
Date: Fri, 20 Dec 2013 16:00:07 -0700

 It's taken me a long time to get to this, but I'm looking at it now.
 It looks to me like the problem is gone because the pkg/db module
 protects itself more from the database not being there and not being
 initialized for the current version. (I believe the original problem
 was that Sam's database was old and didn't have the module entry.)
 
 On Wed, Oct 23, 2013 at 3:14 PM, Robby Findler
 <robby@eecs.northwestern.edu> wrote:
 > This sounds right to me, but I still think it belongs inside the pkg system
 > as this function should not signal errors.
 >
 > Also, I don't know who should get this. I'll assign it to Jay, tho as a best
 > guess.
 >
 > Robby
 >
 >
 > On Wed, Oct 23, 2013 at 4:02 PM, Sam Tobin-Hochstadt <samth@cs.indiana.edu>
 > wrote:
 >>
 >> I'm unable to replicate this on a clean install, so it seems like I
 >> must have gotten my pkg db into a bad state. Which means that some
 >> sort of error handling is probably the right way to go.
 >>
 >> Sam
 >>
 >> On Wed, Oct 23, 2013 at 4:52 PM, Sam Tobin-Hochstadt
 >> <samth@cs.indiana.edu> wrote:
 >> > On Wed, Oct 23, 2013 at 4:40 PM, Sam Tobin-Hochstadt
 >> > <samth@cs.indiana.edu> wrote:
 >> >>
 >> >>> Maybe Sam can stick a printf right at the call to
 >> >>> pkg-catalog-suggestions-for-module and then see if making those calls
 >> >>> triggers the error or something, but I think DrRacket's involvement is
 >> >>> minimal.
 >> >>
 >> >> I can currently trigger the error by opening a new DrR, changing the
 >> >> #lang line to #lang racket/foo and hitting run (although then the
 >> >> error appears in the error output, not as an internal error). I'll try
 >> >> this next.
 >> >
 >> > Yup, here's the error for me:
 >> >
 >> > Welcome to Racket v5.90.0.9.
 >> > -> (require pkg/lib)
 >> > -> (pkg-catalog-suggestions-for-module "racket/foo/lang/reader")
 >> >>>> pkg-catalog-suggestions-for-module racket/foo/lang/reader
 >> >>>> /home/samth/sw/plt/add-on/5.90.0.9/pkgs/catalog.sqlite
 >> > ; query-rows: no such table: modules [,bt for context]
 >> > -> ,bt
 >> > ; query-rows: no such table: modules
 >> > ;   context...:
 >> > ;
 >> > /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:369:0:
 >> > handle-status*
 >> > ;
 >> > /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:330:8
 >> > ;
 >> > /home/samth/sw/plt/racket/collects/db/private/sqlite3/connection.rkt:187:4:
 >> > prepare1* method in connection%
 >> > ;
 >> > /home/samth/sw/plt/racket/collects/db/private/generic/functions.rkt:165:0:
 >> > query-rows8
 >> > ;    /home/samth/sw/plt/racket/collects/pkg/db.rkt:130:6
 >> > ;    /home/samth/sw/plt/racket/collects/pkg/lib.rkt:2801:0:
 >> > pkg-catalog-suggestions-for-module351
 >> > ;    /home/samth/sw/plt/pkgs/xrepl-pkgs/xrepl-lib/xrepl/xrepl.rkt:1346:0
 >> > ;    /home/samth/sw/plt/racket/collects/racket/private/misc.rkt:87:7
 >> > ->
 >> >
 >> > Sam
 >
 >
 
 
 
 -- 
 Jay McCarthy <jay@cs.byu.edu>
 Assistant Professor / Brigham Young University
 http://faculty.cs.byu.edu/~jay
 
 "The glory of God is Intelligence" - D&C 93
