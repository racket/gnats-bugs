From apache@plt-scheme.org Tue Nov 28 18:46:02 2006
Received: from py-out-1112.google.com (py-out-1112.google.com [64.233.166.182])
	by champlain.ccs.neu.edu (8.13.8/8.13.7) with ESMTP id kASNjuWv022601
	for <bugs@bugs.plt-scheme.org>; Tue, 28 Nov 2006 18:45:56 -0500
Message-Id: <200611282345.kASNjtw8022595@champlain.ccs.neu.edu>
Date: Tue, 28 Nov 2006 18:45:55 -0500
From: djd20@kent.ac.uk
To: bugs@plt-scheme.org
Subject: Segfault on solaris 9 sparc

>Number:         8409
>Category:       mzscheme
>Synopsis:       Segfault on solaris 9 sparc
>Class:          sw-bug
>Responsible:    mflatt
>Severity:       serious
>Priority:       medium
>State:          closed
>Confidential:   no
>Arrival-Date:   Tue Nov 28 18:50:01 -0500 2006
>Closed-Date:    Mon Jan 15 02:11:56 -0500 2007
>Last-Modified:  Mon Jan 15 02:11:56 -0500 2007
>Originator:     Damian
>Organization:
plt
>Submitter-Id:   unknown
>Release:        360
>Environment:
solaris-other
>Description:
In revisions 360 and 352 (and one or two intermediate ones) programs compiled with mzc --exe segfault on Solaris 9.  The same scripts executed by invoking mzscheme on them run fine.  The simplest hello world segfaults.

Here is a core dump and backtrace.

 gdb ./test core 
GNU gdb 6.4
Copyright 2005 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "sparc-sun-solaris2.9"...
Core was generated by `./test'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /usr/lib/libc.so.1...done.
Loaded symbols for /usr/lib/libc.so.1
Reading symbols from /usr/lib/libdl.so.1...done.
Loaded symbols for /usr/lib/libdl.so.1
Reading symbols from /usr/platform/SUNW,Sun-Fire-480R/lib/libc_psr.so.1...done.
Loaded symbols for /usr/platform/SUNW,Sun-Fire-480R/lib/libc_psr.so.1
#0  0xff2b455c in strlen () from /usr/lib/libc.so.1
(gdb) bt 
#0  0xff2b455c in strlen () from /usr/lib/libc.so.1
#1  0x00010a48 in path_append (s1=0x0, s2=0xffbffb64 "./test")
    at ../../../mzscheme/dynsrc/ustart.c:174
#2  0x00010be4 in main (argc=1, argv=0xffbffa74)
    at ../../../mzscheme/dynsrc/ustart.c:238
(gdb) 

And the source of test.ss (which was compiled with 'mzc --exe test test.ss'

cat test.ss 

(module test mzscheme
  (printf "heeelooo")
)
>How-To-Repeat:
>Fix:
>Audit-Trail:
State changed from "open" to "closed" by mflatt at Mon, 15 Jan 2007 02:11:56 -0500
Reason>>> Fixed, as reported for later PR. Sorry that I kept overlooking this one!

