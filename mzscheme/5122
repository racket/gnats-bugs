From nobody@champlain.ccs.neu.edu  Tue Dec 25 20:27:09 2001
Received: (from nobody@localhost)
	by champlain.ccs.neu.edu (8.9.3/8.8.7) id UAA20594
	for bugs@plt-scheme.org; Tue, 25 Dec 2001 20:27:09 -0500
Message-Id: <200112260127.UAA20594@champlain.ccs.neu.edu>
Date: Tue, 25 Dec 2001 20:27:09 -0500
From: robby@cs.rice.edu
To: bugs@plt-scheme.org
Cc:
Subject: mz crash with cmd-line flags and empty namespaces

>Number:         5122
>Category:       mzscheme
>Synopsis:       mz crash with cmd-line flags and empty namespaces
>Confidential:   no
>Severity:       serious
>Priority:       medium
>Responsible:    mflatt
>State:          closed
>Class:          sw-bug
>Submitter-Id:   unknown
>Arrival-Date:   Tue Dec 25 20:30:01 EST 2001
>Closed-Date:    Fri Dec 28 13:39:33 EST 2001
>Last-Modified:  Fri Dec 28 13:39:33 EST 2001
>Originator:     Robert Bruce Findler
>Release:        200alpha5
>Organization:
plt
>Environment:
linux-other
>Description:

>How-To-Repeat:
[seesen] ~> mzscheme -qe "(current-namespace (make-namespace 'empty))" -e '(load "tmp.ss")'
Welcome to MzScheme version 200alpha5, Copyright (c) 1995-2001 PLT
tmp.ss:1:1: compile: bad syntax; literal data is not allowed, because no #%datum syntax transformer is bound in: 1
dynamic-require: unknown module: mzscheme
Segmentation fault (core dumped)

this is with the number 1 in the file tmp.ss
>Fix:

>Release-Note:

>Audit-Trail:

From: Robert Bruce Findler <robby@cs.rice.edu>
To: bugs@plt-scheme.org
Cc: mflatt@cs.utah.edu
Subject: Re: all/5122: mz crash with cmd-line flags and empty namespaces
Date: Tue, 25 Dec 2001 19:36:14 -0600

 Forgot the stack:
 
 [seesen] ~> gdb cvs/plt/bin/mzscheme core
 GNU gdb 5.0
 Copyright 2000 Free Software Foundation, Inc.
 GDB is free software, covered by the GNU General Public License, and you are
 welcome to change it and/or distribute copies of it under certain conditions.
 Type "show copying" to see the conditions.
 There is absolutely no warranty for GDB.  Type "show warranty" for details.
 This GDB was configured as "ppc-redhat-linux"...
 Core was generated by `mzscheme -qe (current-namespace 
 (make-namespace 'empty)) -e (load "tmp.ss")'.
 Program terminated with signal 11, Segmentation fault.
 Reading symbols from /lib/libdl.so.2...done.
 Loaded symbols for /lib/libdl.so.2
 Reading symbols from /lib/libm.so.6...done.
 Loaded symbols for /lib/libm.so.6
 Reading symbols from /lib/libc.so.6...done.
 Loaded symbols for /lib/libc.so.6
 Reading symbols from /lib/ld.so.1...done.
 Loaded symbols for /lib/ld.so.1
 #0  0x10028ac8 in scheme_dynamic_wind (pre=0, act=0, post=0, 
 jmp_handler=0, data=0x0)
      at ./fun.c:2379
 2379          scheme_restore_env_stack_w_thread(dw->envss, p);
 (gdb) where
 #0  0x10028ac8 in scheme_dynamic_wind (pre=0, act=0, post=0, 
 jmp_handler=0, data=0x0)
      at ./fun.c:2379
 (gdb) quit

From: Matthew Flatt <mflatt@cs.utah.edu>
To: robby@cs.rice.edu
Cc: bugs@plt-scheme.org
Subject: Re: all/5122: mz crash with cmd-line flags and empty namespaces
Date: Fri, 28 Dec 2001 09:07:45 -0700 (MST)

 Quoting robby@cs.rice.edu:
 > [seesen] ~> mzscheme -qe "(current-namespace (make-namespace 'empty))" -e '(load "tmp.ss")'
 > Welcome to MzScheme version 200alpha5, Copyright (c) 1995-2001 PLT
 > tmp.ss:1:1: compile: bad syntax; literal data is not allowed, because no #%datum syntax transformer is bound in: 1
 > dynamic-require: unknown module: mzscheme
 > Segmentation fault (core dumped)
 
 Fixed and exp-tagged.
 
 Now it successfully calls `read-eval-print-loop'. The reason is that it
 looks in the original namespace to find the binding of
 `read-eval-print-loop', instead of the current namespace. I'm not
 entirely sure that's the right thing, but it seems handy.
 
 Matthew
 
Responsible-Changed-From-To: steck->mflatt
Responsible-Changed-By: mflatt
Responsible-Changed-When: Fri Dec 28 13:39:33 2001
Responsible-Changed-Why:
    mz
State-Changed-From-To: open->closed
State-Changed-By: mflatt
State-Changed-When: Fri Dec 28 13:39:33 2001
State-Changed-Why:
    fixed and exp-tagged
>Unformatted:

