From apache@plt-scheme.org Sat Apr  2 14:45:45 2005
Received: from champlain.ccs.neu.edu (champlain.ccs.neu.edu [127.0.0.1])
	by champlain.ccs.neu.edu (8.12.10/8.12.10) with ESMTP id j32JjinN032651
	for <bugs@plt-scheme.org>; Sat, 2 Apr 2005 14:45:45 -0500
Message-Id: <200504021945.j32JjivD032649@champlain.ccs.neu.edu>
Date: Sat, 2 Apr 2005 14:45:44 -0500
From: henry.lenzi@gmail.com
To: bugs@plt-scheme.org
Subject: plt-299.100 fails to compile on OpenBSD 3.6

>Number:         7310
>Category:       mzscheme
>Synopsis:       plt-299.100 fails to compile on OpenBSD 3.6
>Class:          sw-bug
>Responsible:    mflatt
>Severity:       serious
>Priority:       medium
>State:          closed
>Confidential:   no
>Arrival-Date:   Sat Apr 02 14:50:01 -0500 2005
>Last-Modified:  Sun Apr 17 22:31:16 -0400 2005
>Originator:     Henry Lenzi
>Organization:
plt
>Submitter-Id:   unknown
>Release:        299.100
>Environment:
unix-other
>Description:
Compile fails on OpenBSD 3.6



checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables... 
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking how to run the C preprocessor... gcc -E
checking for egrep... grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... no
checking for unistd.h... yes
checking for char... yes
checking size of char... 1
checking for short... yes
checking size of short... 2
checking for int... yes
checking size of int... 4
checking for long... yes
checking size of long... 4
checking for long long... yes
checking size of long long... 8
----> Installation will go to /home/user/:
---->   /home/user//collects/...
---->   /home/user//bin/...
---->   /home/user//lib/...
---->   /home/user//include/...
---->   /home/user//man/...
---->   /home/user//notes/...
checking for gcc... (cached) gcc
checking whether we are using the GNU C compiler... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for gcc option to accept ANSI C... (cached) none needed
checking how to run the C preprocessor... gcc -E
checking for g++... g++
checking whether we are using the GNU C++ compiler... yes
checking whether g++ accepts -g... yes
checking how to run the C++ preprocessor... g++ -E
checking for ranlib... ranlib
checking for X... libraries /usr/X11R6/lib, headers /usr/X11R6/include
checking for gethostbyname... yes
checking for connect... yes
checking for remove... yes
checking for shmat... yes
checking for IceConnectionNumber in -lICE... yes
checking for cos in -lm... yes
checking for dlopen in -ldl... no
checking for inline keyword... yes
checking iconv.h usability... no
checking iconv.h presence... no
checking for iconv.h... no
checking iconv is usable... no
checking for mbsrtowcs... no
checking whether C++ compiler works... yes
checking whether new and new[] are different... yes
checking whether need to use -fpermissive... no
checking whether X11/XKBlib.h is available... yes
checking GL/glx.h usability... yes
checking GL/glx.h presence... yes
checking for GL/glx.h... yes
checking for glXChooseVisual in -lGL... yes
checking X11/extensions/Xrender.h usability... yes
checking X11/extensions/Xrender.h presence... yes
checking for X11/extensions/Xrender.h... yes
checking for XRenderQueryExtension in -lXrender... yes
Using xft-config...
Xft flags: -I/usr/X11R6/include -I/usr/X11R6/include/freetype2 -I/usr/X11R6/include -I/usr/X11R6/include
Xft libs: -L/usr/X11R6/lib -lXft -L/usr/X11R6/lib -lfreetype -L/usr/X11R6/lib -lfontconfig -L/usr/X11R6/lib -lXrender
no information from pkg-config; Cairo support disabled
checking png.h usability... no
checking png.h presence... no
checking for png.h... no
no libpng headers installed; building from PLT copy
checking jpeglib.h usability... no
checking jpeglib.h presence... no
checking for jpeglib.h... no
no libjpeg headers installed; building from PLT copy
configure: creating ./config.status
config.status: creating Makefile
config.status: creating mzscheme/Makefile
config.status: creating mzscheme/src/Makefile
config.status: creating mzscheme/dynsrc/Makefile
config.status: creating mzscheme/gc/Makefile
config.status: creating mzscheme/sgc/Makefile
config.status: creating mzscheme/gc2/Makefile
config.status: creating mzscheme/guile/Makefile
config.status: creating mzscheme/palm/Makefile
config.status: creating foreign/Makefile
config.status: creating mred/Makefile
config.status: creating mred/wxs/Makefile
config.status: creating mred/wxme/Makefile
config.status: creating mred/gc2/Makefile
config.status: creating wxcommon/libpng/Makefile
config.status: creating wxcommon/zlib/Makefile
config.status: creating wxxt/src/Makefile
config.status: creating wxxt/src/x/Makefile
config.status: creating wxxt/utils/image/src/Makefile
config.status: creating wxxt/contrib/xpm/lib/Makefile
config.status: creating mzscheme/mzconfig.h
config.status: mzscheme/mzconfig.h is unchanged
configure: configuring in foreign/gcc/libffi
configure: running /bin/sh './configure' --prefix=/home/user/  '--prefix=/home/user/' --disable-multilib --cache-file=/dev/null --srcdir=.
checking build system type... i386-unknown-openbsd3.6
checking host system type... i386-unknown-openbsd3.6
checking target system type... i386-unknown-openbsd3.6
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for gawk... no
checking for mawk... no
checking for nawk... nawk
checking whether make sets $(MAKE)... yes
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables... 
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for style of include used by make... GNU
checking dependency style of gcc... none
checking whether gcc and cc understand -c and -o together... yes
checking for ld used by GCC... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for /usr/bin/ld option to reload object files... -r
checking for BSD-compatible nm... /usr/bin/nm -B
checking whether ln -s works... yes
checking how to recognise dependant libraries... unknown
checking for ranlib... ranlib
checking for strip... strip
checking whether -lc should be explicitly linked in... yes
checking for objdir... .libs
checking for gcc option to produce PIC... -fPIC -DPIC
checking if gcc PIC flag -fPIC -DPIC works... yes
checking if gcc static flag -static works... yes
finding the maximum length of command line arguments... 98305
checking if gcc supports -c -o file.o... yes
checking if gcc supports -fno-rtti -fno-exceptions ... yes
checking whether the linker (/usr/bin/ld) supports shared libraries... yes
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking dynamic linker characteristics... openbsd3.6 ld.so
checking command to parse /usr/bin/nm -B output... ok
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
creating libtool
updating cache /dev/null
checking whether to enable maintainer-specific portions of Makefiles... no
checking how to run the C preprocessor... gcc -E
checking for egrep... grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... no
checking for unistd.h... yes
checking sys/mman.h usability... yes
checking sys/mman.h presence... yes
checking for sys/mman.h... yes
checking for mmap... yes
checking for sys/mman.h... (cached) yes
checking for mmap... (cached) yes
checking whether read-only mmap of a plain file works... yes
checking whether mmap from /dev/zero works... yes
checking for MAP_ANON(YMOUS)... yes
checking whether mmap with MAP_ANON(YMOUS) works... yes

make mz
cd mzscheme; make
make g-c
cd gc; make ../libmzgc.a
`../libmzgc.a' is up to date.
make foreign-stuff
cd ../foreign; make all
make foreign.o
gcc -g -O2  -Wall     -DMZ_NO_ICONV -DNO_MBTOWC_FUNCTIONS  -I./../mzscheme  -I./../mzscheme/include -I./../mzscheme/src  -Igcc/libffi/include -c ./foreign.c -o foreign.o
*** Error code 1

Stop in /home/user/dloads/plt/src/foreign (line 27 of Makefile).
*** Error code 1

Stop in /home/user/dloads/plt/src/foreign (line 14 of Makefile).
*** Error code 1

Stop in /home/user/dloads/plt/src/mzscheme (line 95 of Makefile).
*** Error code 1

Stop in /home/user/dloads/plt/src/mzscheme (line 36 of Makefile).
*** Error code 1

Stop in /home/user/dloads/plt/src (line 51 of Makefile).
*** Error code 1

Stop in /home/user/dloads/plt/src (line 5 of Makefile).
>How-To-Repeat:
Use OpenBSD 3.6. Do not use GNUmake, only Make.
>Fix:
>Audit-Trail:
From: Matthew Flatt <mflatt@cs.utah.edu>
To: henry.lenzi@gmail.com, bugs@plt-scheme.org
Cc: eli@plt-scheme.org
Subject: Re: all/7310: plt-299.100 fails to compile on OpenBSD 3.6
Date: Sat, 2 Apr 2005 13:50:35 -0700

 At Sat, 2 Apr 2005 14:50:01 -0500, henry.lenzi@gmail.com wrote:
 > Use OpenBSD 3.6. Do not use GNUmake, only Make.
 
 Building PLT Scheme requires GNUmake as of version 299.
 
 I wish regular make worked, but the new "foreign" component needs
 GNUmake.
 
 Matthew
 
From: Eli Barzilay <eli@barzilay.org>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@plt-scheme.org
Subject: Re: all/7310: plt-299.100 fails to compile on OpenBSD 3.6
Date: Sat, 2 Apr 2005 18:24:09 -0500

 On Apr  2, Matthew Flatt wrote:
 > At Sat, 2 Apr 2005 14:50:01 -0500, henry.lenzi@gmail.com wrote:
 > > Use OpenBSD 3.6. Do not use GNUmake, only Make.
 > 
 > Building PLT Scheme requires GNUmake as of version 299.
 > 
 > I wish regular make worked, but the new "foreign" component needs
 > GNUmake.
 
 I didn't know that libffi requires that -- is there any way to `fix'
 it?
 
 -- 
           ((lambda (x) (x x)) (lambda (x) (x x)))          Eli Barzilay:
                   http://www.barzilay.org/                 Maze is Life!
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Eli Barzilay <eli@barzilay.org>
Cc: bugs@plt-scheme.org
Subject: Re: all/7310: plt-299.100 fails to compile on OpenBSD 3.6
Date: Thu, 7 Apr 2005 14:25:06 -0600

 At Sat, 2 Apr 2005 18:24:09 -0500, Eli Barzilay wrote:
 > On Apr  2, Matthew Flatt wrote:
 > > At Sat, 2 Apr 2005 14:50:01 -0500, henry.lenzi@gmail.com wrote:
 > > > Use OpenBSD 3.6. Do not use GNUmake, only Make.
 > > 
 > > Building PLT Scheme requires GNUmake as of version 299.
 > > 
 > > I wish regular make worked, but the new "foreign" component needs
 > > GNUmake.
 > 
 > I didn't know that libffi requires that -- is there any way to `fix'
 > it?
 
 I think the only solution is to rewrite the makefile. It's generated
 via automake; I don't know whether automake makefiles inherently
 require gmake, or whether "Makefile.am" could be adjusted to purge the
 gmake features.
 
 Matthews
 
From: Eli Barzilay <eli@barzilay.org>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@plt-scheme.org
Subject: Re: all/7310: plt-299.100 fails to compile on OpenBSD 3.6
Date: Thu, 7 Apr 2005 17:18:12 -0400

 On Apr  7, Matthew Flatt wrote:
 > At Sat, 2 Apr 2005 18:24:09 -0500, Eli Barzilay wrote:
 > > 
 > > I didn't know that libffi requires that -- is there any way to
 > > `fix' it?
 > 
 > I think the only solution is to rewrite the makefile. It's generated
 > via automake; I don't know whether automake makefiles inherently
 > require gmake, or whether "Makefile.am" could be adjusted to purge
 > the gmake features.
 
 Is there a specific point in the Makefile which demonstrates the
 problem?  If there is one, then I could try to send an email on the
 list.
 
 -- 
           ((lambda (x) (x x)) (lambda (x) (x x)))          Eli Barzilay:
                   http://www.barzilay.org/                 Maze is Life!

State changed from "open" to "closed" by eli at Sun, 17 Apr 2005 22:31:16 -0400
Reason>>> Answered.

