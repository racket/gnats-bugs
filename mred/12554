From bugs+caf_=bugs=bugs.plt-scheme.org@plt-scheme.org Wed Feb  8 17:42:20 2012
Received: from mail-vx0-f172.google.com (mail-vx0-f172.google.com [209.85.220.172])
	by champlain.ccs.neu.edu (8.14.4/8.14.4) with ESMTP id q18MgFLV001056
	for <bugs@bugs.plt-scheme.org>; Wed, 8 Feb 2012 17:42:15 -0500
Message-Id: <201202082242.q18MgAQ4001043@champlain.ccs.neu.edu>
Date: Wed, 8 Feb 2012 17:42:10 -0500
From: robby@eecs.northwestern.edu
To: bugs@racket-lang.org
Subject: picts: right edge of letters chopped off

>Number:         12554
>Category:       mred
>Synopsis:       picts: right edge of letters chopped off
>Class:          sw-bug
>Responsible:    robby
>Severity:       serious
>Priority:       medium
>State:          closed
>Confidential:   no
>Arrival-Date:   Wed Feb 08 17:44:01 -0500 2012
>Closed-Date:    Tue Feb 21 17:19:54 -0500 2012
>Last-Modified:  Tue Feb 21 18:12:01 -0500 2012
>Originator:     Robby Findler
>Organization:
plt
>Submitter-Id:   unknown
>Release:        5.2.1.5--2012-02-05(98a0b74/g)
>Environment:
macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64" (x86_64-macosx/3m) (get-display-depth) = 32
Human Language: english
(current-memory-use) 328333144
Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links #:user? #f #:root? #t) = ()


Collections:
("/Users/robby/Library/Racket/5.2.1.5/collects"
 (non-existent-path))
("/Users/robby/git/exp/plt/collects"
 (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser" "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm" "drracket" "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework" "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client" "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images" "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred" "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools" "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs" "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex" "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble" "scribblings" "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist" "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack" "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace" "typed" "typ!
 ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server" "wxme" "xml" "xrepl"))

Computer Language: (("Determine language from source") (#(#t print mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
>Description:
The pict below appears to have the right 10 or 15% or so of each letter chopped off. This only seems to happen with "Courier New", not with, e.g., "Courier". 

So perhaps the right fix here is to change the interpretation of 'modern so that it is "Courier New" instead of courier?

In the meantime, since this makes the pink stuff in Redex look bad, there is definition at the top of redex/private/core-layout.rkt that uses "Courier" when it is available and when the platform is mac os x. 

Depending on how this PR is resolved, that should also be changed.
>How-To-Repeat:
#lang racket/base
(require texpict/mrpict texpict/utils)
(scale/improve-new-text
  (text "equal?" "Courier New" 14)
 4)
>Fix:
>Audit-Trail:
From: Matthew Flatt <mflatt@cs.utah.edu>
To: robby@eecs.northwestern.edu, bugs@racket-lang.org
Cc: nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Thu, 9 Feb 2012 18:08:13 -0700

 This appears to be a limitation of Cairo's bitmap drawing, and I think
 the problem goes away if you use a bitmap from `make-screen-bitmap'
 instead of `make-bitmap'.
 
 At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 > A new problem report is waiting at
 >   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 > 
 > Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 > 
 > *** Description:
 > The pict below appears to have the right 10 or 15% or so of each letter chopped 
 > off. This only seems to happen with "Courier New", not with, e.g., "Courier". 
 > 
 > So perhaps the right fix here is to change the interpretation of 'modern so 
 > that it is "Courier New" instead of courier?
 > 
 > In the meantime, since this makes the pink stuff in Redex look bad, there is 
 > definition at the top of redex/private/core-layout.rkt that uses "Courier" when 
 > it is available and when the platform is mac os x. 
 > 
 > Depending on how this PR is resolved, that should also be changed.
 > 
 > *** How to repeat:
 > #lang racket/base
 > (require texpict/mrpict texpict/utils)
 > (scale/improve-new-text
 >   (text "equal?" "Courier New" 14)
 >  4)
 > 
 > *** Environment:
 > macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9 
 > 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64" 
 > (x86_64-macosx/3m) (get-display-depth) = 32
 > Human Language: english
 > (current-memory-use) 328333144
 > Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links 
 > #:user? #f #:root? #t) = ()
 > 
 > 
 > Collections:
 > ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >  (non-existent-path))
 > ("/Users/robby/git/exp/plt/collects"
 >  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser" 
 > "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm" "drracket" 
 > "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework" 
 > "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client" 
 > "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images" 
 > "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred" 
 > "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools" 
 > "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs" 
 > "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex" 
 > "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble" "scribblings" 
 > "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist" 
 > "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack" 
 > "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace" "typed" 
 > "typ!
 >  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server" 
 > "wxme" "xml" "xrepl"))
 > 
 > Computer Language: (("Determine language from source") (#(#t print 
 > mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Thu, 9 Feb 2012 19:15:01 -0600

 Do you have advice on what DrRacket's REPL and what the pict->png
 conversion should be doing? Maybe make-screen-bitmap on the mac and
 make-bitmap elsewhere?
 
 Robby
 
 On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > This appears to be a limitation of Cairo's bitmap drawing, and I think
 > the problem goes away if you use a bitmap from `make-screen-bitmap'
 > instead of `make-bitmap'.
 >
 > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >> A new problem report is waiting at
 >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 >>
 >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 >>
 >> *** Description:
 >> The pict below appears to have the right 10 or 15% or so of each letter chopped
 >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 >>
 >> So perhaps the right fix here is to change the interpretation of 'modern so
 >> that it is "Courier New" instead of courier?
 >>
 >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 >> definition at the top of redex/private/core-layout.rkt that uses "Courier" when
 >> it is available and when the platform is mac os x.
 >>
 >> Depending on how this PR is resolved, that should also be changed.
 >>
 >> *** How to repeat:
 >> #lang racket/base
 >> (require texpict/mrpict texpict/utils)
 >> (scale/improve-new-text
 >>   (text "equal?" "Courier New" 14)
 >>  4)
 >>
 >> *** Environment:
 >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 >> (x86_64-macosx/3m) (get-display-depth) = 32
 >> Human Language: english
 >> (current-memory-use) 328333144
 >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 >> #:user? #f #:root? #t) = ()
 >>
 >>
 >> Collections:
 >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >>  (non-existent-path))
 >> ("/Users/robby/git/exp/plt/collects"
 >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm" "drracket"
 >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" "framework"
 >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble" "scribblings"
 >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace" "typed"
 >> "typ!
 >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 >> "wxme" "xml" "xrepl"))
 >>
 >> Computer Language: (("Determine language from source") (#(#t print
 >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Thu, 9 Feb 2012 18:35:11 -0700

 I imagined that the DrRacket REPL would use `make-screen-bitmap'
 always, but a general pict->png conversion shouldn't rely on
 `racket/gui/base'.
 
 Win32 and Cocoa bitmaps are readily available without
 `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 and Cocoa and the same as `make-bitmap' elsewhere.
 
 At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 > Do you have advice on what DrRacket's REPL and what the pict->png
 > conversion should be doing? Maybe make-screen-bitmap on the mac and
 > make-bitmap elsewhere?
 > 
 > Robby
 > 
 > On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > > This appears to be a limitation of Cairo's bitmap drawing, and I think
 > > the problem goes away if you use a bitmap from `make-screen-bitmap'
 > > instead of `make-bitmap'.
 > >
 > > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 > >> A new problem report is waiting at
 > >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 > >>
 > >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 > >>
 > >> *** Description:
 > >> The pict below appears to have the right 10 or 15% or so of each letter 
 > chopped
 > >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 > >>
 > >> So perhaps the right fix here is to change the interpretation of 'modern so
 > >> that it is "Courier New" instead of courier?
 > >>
 > >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 > >> definition at the top of redex/private/core-layout.rkt that uses "Courier" 
 > when
 > >> it is available and when the platform is mac os x.
 > >>
 > >> Depending on how this PR is resolved, that should also be changed.
 > >>
 > >> *** How to repeat:
 > >> #lang racket/base
 > >> (require texpict/mrpict texpict/utils)
 > >> (scale/improve-new-text
 > >>   (text "equal?" "Courier New" 14)
 > >>  4)
 > >>
 > >> *** Environment:
 > >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 > >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 > >> (x86_64-macosx/3m) (get-display-depth) = 32
 > >> Human Language: english
 > >> (current-memory-use) 328333144
 > >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 > >> #:user? #f #:root? #t) = ()
 > >>
 > >>
 > >> Collections:
 > >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 > >>  (non-existent-path))
 > >> ("/Users/robby/git/exp/plt/collects"
 > >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 > >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm" 
 > "drracket"
 > >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file" 
 > "framework"
 > >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 > >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 > >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 > >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 > >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 > >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 > >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble" 
 > "scribblings"
 > >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 > >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 > >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace" 
 > "typed"
 > >> "typ!
 > >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 > >> "wxme" "xml" "xrepl"))
 > >>
 > >> Computer Language: (("Determine language from source") (#(#t print
 > >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Thu, 9 Feb 2012 20:16:45 -0600

 Why would make-platform-bitmap be able to avoid the dependency on
 racket/gui/base when make-screen-bitmap cannot? (Also, are we worried
 about using too many win32 resources?)
 
 Robby
 
 On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > I imagined that the DrRacket REPL would use `make-screen-bitmap'
 > always, but a general pict->png conversion shouldn't rely on
 > `racket/gui/base'.
 >
 > Win32 and Cocoa bitmaps are readily available without
 > `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 > `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 > and Cocoa and the same as `make-bitmap' elsewhere.
 >
 > At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 >> Do you have advice on what DrRacket's REPL and what the pict->png
 >> conversion should be doing? Maybe make-screen-bitmap on the mac and
 >> make-bitmap elsewhere?
 >>
 >> Robby
 >>
 >> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 >> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 >> > instead of `make-bitmap'.
 >> >
 >> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >> >> A new problem report is waiting at
 >> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 >> >>
 >> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 >> >>
 >> >> *** Description:
 >> >> The pict below appears to have the right 10 or 15% or so of each letter
 >> chopped
 >> >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 >> >>
 >> >> So perhaps the right fix here is to change the interpretation of 'modern so
 >> >> that it is "Courier New" instead of courier?
 >> >>
 >> >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 >> >> definition at the top of redex/private/core-layout.rkt that uses "Courier"
 >> when
 >> >> it is available and when the platform is mac os x.
 >> >>
 >> >> Depending on how this PR is resolved, that should also be changed.
 >> >>
 >> >> *** How to repeat:
 >> >> #lang racket/base
 >> >> (require texpict/mrpict texpict/utils)
 >> >> (scale/improve-new-text
 >> >>   (text "equal?" "Courier New" 14)
 >> >>  4)
 >> >>
 >> >> *** Environment:
 >> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 >> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 >> >> (x86_64-macosx/3m) (get-display-depth) = 32
 >> >> Human Language: english
 >> >> (current-memory-use) 328333144
 >> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 >> >> #:user? #f #:root? #t) = ()
 >> >>
 >> >>
 >> >> Collections:
 >> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >> >>  (non-existent-path))
 >> >> ("/Users/robby/git/exp/plt/collects"
 >> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 >> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 >> "drracket"
 >> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 >> "framework"
 >> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 >> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 >> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 >> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 >> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 >> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 >> "scribblings"
 >> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 >> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 >> "typed"
 >> >> "typ!
 >> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 >> >> "wxme" "xml" "xrepl"))
 >> >>
 >> >> Computer Language: (("Determine language from source") (#(#t print
 >> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 
From: Sam Tobin-Hochstadt <samth@ccs.neu.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Matthew Flatt <mflatt@cs.utah.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 08:06:35 -0500

 I imagine `make-platform-bitmap' would look something like this:
 
 (define (m-p-b . args)
   (if (gui-available?) (apply (m-s-b args)) (apply (m-b args))))
 
 On Thu, Feb 9, 2012 at 9:16 PM, Robby Findler
 <robby@eecs.northwestern.edu> wrote:
 > Why would make-platform-bitmap be able to avoid the dependency on
 > racket/gui/base when make-screen-bitmap cannot? (Also, are we worried
 > about using too many win32 resources?)
 >
 > Robby
 >
 > On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >> I imagined that the DrRacket REPL would use `make-screen-bitmap'
 >> always, but a general pict->png conversion shouldn't rely on
 >> `racket/gui/base'.
 >>
 >> Win32 and Cocoa bitmaps are readily available without
 >> `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 >> `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 >> and Cocoa and the same as `make-bitmap' elsewhere.
 >>
 >> At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 >>> Do you have advice on what DrRacket's REPL and what the pict->png
 >>> conversion should be doing? Maybe make-screen-bitmap on the mac and
 >>> make-bitmap elsewhere?
 >>>
 >>> Robby
 >>>
 >>> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 >>> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 >>> > instead of `make-bitmap'.
 >>> >
 >>> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >>> >> A new problem report is waiting at
 >>> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 >>> >>
 >>> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 >>> >>
 >>> >> *** Description:
 >>> >> The pict below appears to have the right 10 or 15% or so of each letter
 >>> chopped
 >>> >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 >>> >>
 >>> >> So perhaps the right fix here is to change the interpretation of 'modern so
 >>> >> that it is "Courier New" instead of courier?
 >>> >>
 >>> >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 >>> >> definition at the top of redex/private/core-layout.rkt that uses "Courier"
 >>> when
 >>> >> it is available and when the platform is mac os x.
 >>> >>
 >>> >> Depending on how this PR is resolved, that should also be changed.
 >>> >>
 >>> >> *** How to repeat:
 >>> >> #lang racket/base
 >>> >> (require texpict/mrpict texpict/utils)
 >>> >> (scale/improve-new-text
 >>> >>   (text "equal?" "Courier New" 14)
 >>> >>  4)
 >>> >>
 >>> >> *** Environment:
 >>> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 >>> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 >>> >> (x86_64-macosx/3m) (get-display-depth) = 32
 >>> >> Human Language: english
 >>> >> (current-memory-use) 328333144
 >>> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 >>> >> #:user? #f #:root? #t) = ()
 >>> >>
 >>> >>
 >>> >> Collections:
 >>> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >>> >>  (non-existent-path))
 >>> >> ("/Users/robby/git/exp/plt/collects"
 >>> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 >>> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 >>> "drracket"
 >>> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 >>> "framework"
 >>> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 >>> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 >>> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 >>> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >>> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 >>> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 >>> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 >>> "scribblings"
 >>> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 >>> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >>> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 >>> "typed"
 >>> >> "typ!
 >>> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 >>> >> "wxme" "xml" "xrepl"))
 >>> >>
 >>> >> Computer Language: (("Determine language from source") (#(#t print
 >>> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 
 
 
 -- 
 sam th
 samth@ccs.neu.edu
 
From: Robby Findler <robby@eecs.northwestern.edu>
To: Sam Tobin-Hochstadt <samth@ccs.neu.edu>
Cc: Matthew Flatt <mflatt@cs.utah.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 07:11:57 -0600

 That doesn't seem to be what Matthew wrote.
 
 On Fri, Feb 10, 2012 at 7:06 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> wrote:
 > I imagine `make-platform-bitmap' would look something like this:
 >
 > (define (m-p-b . args)
 >  (if (gui-available?) (apply (m-s-b args)) (apply (m-b args))))
 >
 > On Thu, Feb 9, 2012 at 9:16 PM, Robby Findler
 > <robby@eecs.northwestern.edu> wrote:
 >> Why would make-platform-bitmap be able to avoid the dependency on
 >> racket/gui/base when make-screen-bitmap cannot? (Also, are we worried
 >> about using too many win32 resources?)
 >>
 >> Robby
 >>
 >> On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>> I imagined that the DrRacket REPL would use `make-screen-bitmap'
 >>> always, but a general pict->png conversion shouldn't rely on
 >>> `racket/gui/base'.
 >>>
 >>> Win32 and Cocoa bitmaps are readily available without
 >>> `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 >>> `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 >>> and Cocoa and the same as `make-bitmap' elsewhere.
 >>>
 >>> At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 >>>> Do you have advice on what DrRacket's REPL and what the pict->png
 >>>> conversion should be doing? Maybe make-screen-bitmap on the mac and
 >>>> make-bitmap elsewhere?
 >>>>
 >>>> Robby
 >>>>
 >>>> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>>> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 >>>> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 >>>> > instead of `make-bitmap'.
 >>>> >
 >>>> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >>>> >> A new problem report is waiting at
 >>>> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 >>>> >>
 >>>> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 >>>> >>
 >>>> >> *** Description:
 >>>> >> The pict below appears to have the right 10 or 15% or so of each letter
 >>>> chopped
 >>>> >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 >>>> >>
 >>>> >> So perhaps the right fix here is to change the interpretation of 'modern so
 >>>> >> that it is "Courier New" instead of courier?
 >>>> >>
 >>>> >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 >>>> >> definition at the top of redex/private/core-layout.rkt that uses "Courier"
 >>>> when
 >>>> >> it is available and when the platform is mac os x.
 >>>> >>
 >>>> >> Depending on how this PR is resolved, that should also be changed.
 >>>> >>
 >>>> >> *** How to repeat:
 >>>> >> #lang racket/base
 >>>> >> (require texpict/mrpict texpict/utils)
 >>>> >> (scale/improve-new-text
 >>>> >>   (text "equal?" "Courier New" 14)
 >>>> >>  4)
 >>>> >>
 >>>> >> *** Environment:
 >>>> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 >>>> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 >>>> >> (x86_64-macosx/3m) (get-display-depth) = 32
 >>>> >> Human Language: english
 >>>> >> (current-memory-use) 328333144
 >>>> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 >>>> >> #:user? #f #:root? #t) = ()
 >>>> >>
 >>>> >>
 >>>> >> Collections:
 >>>> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >>>> >>  (non-existent-path))
 >>>> >> ("/Users/robby/git/exp/plt/collects"
 >>>> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 >>>> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 >>>> "drracket"
 >>>> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 >>>> "framework"
 >>>> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 >>>> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 >>>> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 >>>> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >>>> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 >>>> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 >>>> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 >>>> "scribblings"
 >>>> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 >>>> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >>>> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 >>>> "typed"
 >>>> >> "typ!
 >>>> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 >>>> >> "wxme" "xml" "xrepl"))
 >>>> >>
 >>>> >> Computer Language: (("Determine language from source") (#(#t print
 >>>> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 >
 >
 >
 > --
 > sam th
 > samth@ccs.neu.edu
 
From: Sam Tobin-Hochstadt <samth@ccs.neu.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Matthew Flatt <mflatt@cs.utah.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 08:22:46 -0500

 Right, but isn't `gui-available?' always true on Mac and Windows?
 
 On Fri, Feb 10, 2012 at 8:11 AM, Robby Findler
 <robby@eecs.northwestern.edu> wrote:
 > That doesn't seem to be what Matthew wrote.
 >
 > On Fri, Feb 10, 2012 at 7:06 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> wrote:
 >> I imagine `make-platform-bitmap' would look something like this:
 >>
 >> (define (m-p-b . args)
 >>  (if (gui-available?) (apply (m-s-b args)) (apply (m-b args))))
 >>
 >> On Thu, Feb 9, 2012 at 9:16 PM, Robby Findler
 >> <robby@eecs.northwestern.edu> wrote:
 >>> Why would make-platform-bitmap be able to avoid the dependency on
 >>> racket/gui/base when make-screen-bitmap cannot? (Also, are we worried
 >>> about using too many win32 resources?)
 >>>
 >>> Robby
 >>>
 >>> On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>>> I imagined that the DrRacket REPL would use `make-screen-bitmap'
 >>>> always, but a general pict->png conversion shouldn't rely on
 >>>> `racket/gui/base'.
 >>>>
 >>>> Win32 and Cocoa bitmaps are readily available without
 >>>> `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 >>>> `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 >>>> and Cocoa and the same as `make-bitmap' elsewhere.
 >>>>
 >>>> At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 >>>>> Do you have advice on what DrRacket's REPL and what the pict->png
 >>>>> conversion should be doing? Maybe make-screen-bitmap on the mac and
 >>>>> make-bitmap elsewhere?
 >>>>>
 >>>>> Robby
 >>>>>
 >>>>> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>>>> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 >>>>> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 >>>>> > instead of `make-bitmap'.
 >>>>> >
 >>>>> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >>>>> >> A new problem report is waiting at
 >>>>> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 >>>>> >>
 >>>>> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 >>>>> >>
 >>>>> >> *** Description:
 >>>>> >> The pict below appears to have the right 10 or 15% or so of each letter
 >>>>> chopped
 >>>>> >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 >>>>> >>
 >>>>> >> So perhaps the right fix here is to change the interpretation of 'modern so
 >>>>> >> that it is "Courier New" instead of courier?
 >>>>> >>
 >>>>> >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 >>>>> >> definition at the top of redex/private/core-layout.rkt that uses "Courier"
 >>>>> when
 >>>>> >> it is available and when the platform is mac os x.
 >>>>> >>
 >>>>> >> Depending on how this PR is resolved, that should also be changed.
 >>>>> >>
 >>>>> >> *** How to repeat:
 >>>>> >> #lang racket/base
 >>>>> >> (require texpict/mrpict texpict/utils)
 >>>>> >> (scale/improve-new-text
 >>>>> >>   (text "equal?" "Courier New" 14)
 >>>>> >>  4)
 >>>>> >>
 >>>>> >> *** Environment:
 >>>>> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 >>>>> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 >>>>> >> (x86_64-macosx/3m) (get-display-depth) = 32
 >>>>> >> Human Language: english
 >>>>> >> (current-memory-use) 328333144
 >>>>> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 >>>>> >> #:user? #f #:root? #t) = ()
 >>>>> >>
 >>>>> >>
 >>>>> >> Collections:
 >>>>> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >>>>> >>  (non-existent-path))
 >>>>> >> ("/Users/robby/git/exp/plt/collects"
 >>>>> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 >>>>> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 >>>>> "drracket"
 >>>>> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 >>>>> "framework"
 >>>>> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 >>>>> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 >>>>> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 >>>>> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >>>>> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 >>>>> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 >>>>> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 >>>>> "scribblings"
 >>>>> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 >>>>> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >>>>> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 >>>>> "typed"
 >>>>> >> "typ!
 >>>>> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 >>>>> >> "wxme" "xml" "xrepl"))
 >>>>> >>
 >>>>> >> Computer Language: (("Determine language from source") (#(#t print
 >>>>> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 >>
 >>
 >>
 >> --
 >> sam th
 >> samth@ccs.neu.edu
 
 
 
 -- 
 sam th
 samth@ccs.neu.edu
 
From: Robby Findler <robby@eecs.northwestern.edu>
To: Sam Tobin-Hochstadt <samth@ccs.neu.edu>
Cc: Matthew Flatt <mflatt@cs.utah.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 07:26:10 -0600

 No. It isn't true from 'racket'; it isn't true in a new namespace (the
 former because it hasn't been loaded, the latter because the GUI has
 to be shared with a new namespace "from the outside").
 
 Welcome to Racket v5.2.1.5.
 > (system-type)
 'macosx
 > (require racket/gui/dynamic)
 > (gui-available?)
 #f
 > (require racket/gui/base)
 > (gui-available?)
 #t
 > (parameterize ([current-namespace (make-base-namespace)])
    (namespace-require 'racket/gui/dynamic)
    (eval '(gui-available?)))
 #f
 > ^D
 
 
 Robby
 
 On Fri, Feb 10, 2012 at 7:22 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> wrote:
 > Right, but isn't `gui-available?' always true on Mac and Windows?
 >
 > On Fri, Feb 10, 2012 at 8:11 AM, Robby Findler
 > <robby@eecs.northwestern.edu> wrote:
 >> That doesn't seem to be what Matthew wrote.
 >>
 >> On Fri, Feb 10, 2012 at 7:06 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> wrote:
 >>> I imagine `make-platform-bitmap' would look something like this:
 >>>
 >>> (define (m-p-b . args)
 >>>  (if (gui-available?) (apply (m-s-b args)) (apply (m-b args))))
 >>>
 >>> On Thu, Feb 9, 2012 at 9:16 PM, Robby Findler
 >>> <robby@eecs.northwestern.edu> wrote:
 >>>> Why would make-platform-bitmap be able to avoid the dependency on
 >>>> racket/gui/base when make-screen-bitmap cannot? (Also, are we worried
 >>>> about using too many win32 resources?)
 >>>>
 >>>> Robby
 >>>>
 >>>> On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>>>> I imagined that the DrRacket REPL would use `make-screen-bitmap'
 >>>>> always, but a general pict->png conversion shouldn't rely on
 >>>>> `racket/gui/base'.
 >>>>>
 >>>>> Win32 and Cocoa bitmaps are readily available without
 >>>>> `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 >>>>> `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 >>>>> and Cocoa and the same as `make-bitmap' elsewhere.
 >>>>>
 >>>>> At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 >>>>>> Do you have advice on what DrRacket's REPL and what the pict->png
 >>>>>> conversion should be doing? Maybe make-screen-bitmap on the mac and
 >>>>>> make-bitmap elsewhere?
 >>>>>>
 >>>>>> Robby
 >>>>>>
 >>>>>> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>>>>> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 >>>>>> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 >>>>>> > instead of `make-bitmap'.
 >>>>>> >
 >>>>>> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >>>>>> >> A new problem report is waiting at
 >>>>>> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 >>>>>> >>
 >>>>>> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 >>>>>> >>
 >>>>>> >> *** Description:
 >>>>>> >> The pict below appears to have the right 10 or 15% or so of each letter
 >>>>>> chopped
 >>>>>> >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 >>>>>> >>
 >>>>>> >> So perhaps the right fix here is to change the interpretation of 'modern so
 >>>>>> >> that it is "Courier New" instead of courier?
 >>>>>> >>
 >>>>>> >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 >>>>>> >> definition at the top of redex/private/core-layout.rkt that uses "Courier"
 >>>>>> when
 >>>>>> >> it is available and when the platform is mac os x.
 >>>>>> >>
 >>>>>> >> Depending on how this PR is resolved, that should also be changed.
 >>>>>> >>
 >>>>>> >> *** How to repeat:
 >>>>>> >> #lang racket/base
 >>>>>> >> (require texpict/mrpict texpict/utils)
 >>>>>> >> (scale/improve-new-text
 >>>>>> >>   (text "equal?" "Courier New" 14)
 >>>>>> >>  4)
 >>>>>> >>
 >>>>>> >> *** Environment:
 >>>>>> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 >>>>>> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 >>>>>> >> (x86_64-macosx/3m) (get-display-depth) = 32
 >>>>>> >> Human Language: english
 >>>>>> >> (current-memory-use) 328333144
 >>>>>> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 >>>>>> >> #:user? #f #:root? #t) = ()
 >>>>>> >>
 >>>>>> >>
 >>>>>> >> Collections:
 >>>>>> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >>>>>> >>  (non-existent-path))
 >>>>>> >> ("/Users/robby/git/exp/plt/collects"
 >>>>>> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 >>>>>> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 >>>>>> "drracket"
 >>>>>> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 >>>>>> "framework"
 >>>>>> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 >>>>>> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 >>>>>> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 >>>>>> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >>>>>> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 >>>>>> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 >>>>>> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 >>>>>> "scribblings"
 >>>>>> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 >>>>>> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >>>>>> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 >>>>>> "typed"
 >>>>>> >> "typ!
 >>>>>> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 >>>>>> >> "wxme" "xml" "xrepl"))
 >>>>>> >>
 >>>>>> >> Computer Language: (("Determine language from source") (#(#t print
 >>>>>> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 >>>
 >>>
 >>>
 >>> --
 >>> sam th
 >>> samth@ccs.neu.edu
 >
 >
 >
 > --
 > sam th
 > samth@ccs.neu.edu
 
From: Sam Tobin-Hochstadt <samth@ccs.neu.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Matthew Flatt <mflatt@cs.utah.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 08:28:27 -0500

 I stand corrected, then.
 
 On Fri, Feb 10, 2012 at 8:26 AM, Robby Findler
 <robby@eecs.northwestern.edu> wrote:
 > No. It isn't true from 'racket'; it isn't true in a new namespace (the
 > former because it hasn't been loaded, the latter because the GUI has
 > to be shared with a new namespace "from the outside").
 >
 > Welcome to Racket v5.2.1.5.
 >> (system-type)
 > 'macosx
 >> (require racket/gui/dynamic)
 >> (gui-available?)
 > #f
 >> (require racket/gui/base)
 >> (gui-available?)
 > #t
 >> (parameterize ([current-namespace (make-base-namespace)])
 >   (namespace-require 'racket/gui/dynamic)
 >   (eval '(gui-available?)))
 > #f
 >> ^D
 >
 >
 > Robby
 >
 > On Fri, Feb 10, 2012 at 7:22 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> wrote:
 >> Right, but isn't `gui-available?' always true on Mac and Windows?
 >>
 >> On Fri, Feb 10, 2012 at 8:11 AM, Robby Findler
 >> <robby@eecs.northwestern.edu> wrote:
 >>> That doesn't seem to be what Matthew wrote.
 >>>
 >>> On Fri, Feb 10, 2012 at 7:06 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> wrote:
 >>>> I imagine `make-platform-bitmap' would look something like this:
 >>>>
 >>>> (define (m-p-b . args)
 >>>>  (if (gui-available?) (apply (m-s-b args)) (apply (m-b args))))
 >>>>
 >>>> On Thu, Feb 9, 2012 at 9:16 PM, Robby Findler
 >>>> <robby@eecs.northwestern.edu> wrote:
 >>>>> Why would make-platform-bitmap be able to avoid the dependency on
 >>>>> racket/gui/base when make-screen-bitmap cannot? (Also, are we worried
 >>>>> about using too many win32 resources?)
 >>>>>
 >>>>> Robby
 >>>>>
 >>>>> On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>>>>> I imagined that the DrRacket REPL would use `make-screen-bitmap'
 >>>>>> always, but a general pict->png conversion shouldn't rely on
 >>>>>> `racket/gui/base'.
 >>>>>>
 >>>>>> Win32 and Cocoa bitmaps are readily available without
 >>>>>> `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 >>>>>> `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 >>>>>> and Cocoa and the same as `make-bitmap' elsewhere.
 >>>>>>
 >>>>>> At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 >>>>>>> Do you have advice on what DrRacket's REPL and what the pict->png
 >>>>>>> conversion should be doing? Maybe make-screen-bitmap on the mac and
 >>>>>>> make-bitmap elsewhere?
 >>>>>>>
 >>>>>>> Robby
 >>>>>>>
 >>>>>>> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >>>>>>> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 >>>>>>> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 >>>>>>> > instead of `make-bitmap'.
 >>>>>>> >
 >>>>>>> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >>>>>>> >> A new problem report is waiting at
 >>>>>>> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 >>>>>>> >>
 >>>>>>> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 >>>>>>> >>
 >>>>>>> >> *** Description:
 >>>>>>> >> The pict below appears to have the right 10 or 15% or so of each letter
 >>>>>>> chopped
 >>>>>>> >> off. This only seems to happen with "Courier New", not with, e.g., "Courier".
 >>>>>>> >>
 >>>>>>> >> So perhaps the right fix here is to change the interpretation of 'modern so
 >>>>>>> >> that it is "Courier New" instead of courier?
 >>>>>>> >>
 >>>>>>> >> In the meantime, since this makes the pink stuff in Redex look bad, there is
 >>>>>>> >> definition at the top of redex/private/core-layout.rkt that uses "Courier"
 >>>>>>> when
 >>>>>>> >> it is available and when the platform is mac os x.
 >>>>>>> >>
 >>>>>>> >> Depending on how this PR is resolved, that should also be changed.
 >>>>>>> >>
 >>>>>>> >> *** How to repeat:
 >>>>>>> >> #lang racket/base
 >>>>>>> >> (require texpict/mrpict texpict/utils)
 >>>>>>> >> (scale/improve-new-text
 >>>>>>> >>   (text "equal?" "Courier New" 14)
 >>>>>>> >>  4)
 >>>>>>> >>
 >>>>>>> >> *** Environment:
 >>>>>>> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 >>>>>>> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 >>>>>>> >> (x86_64-macosx/3m) (get-display-depth) = 32
 >>>>>>> >> Human Language: english
 >>>>>>> >> (current-memory-use) 328333144
 >>>>>>> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); (links
 >>>>>>> >> #:user? #f #:root? #t) = ()
 >>>>>>> >>
 >>>>>>> >>
 >>>>>>> >> Collections:
 >>>>>>> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 >>>>>>> >>  (non-existent-path))
 >>>>>>> >> ("/Users/robby/git/exp/plt/collects"
 >>>>>>> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 >>>>>>> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 >>>>>>> "drracket"
 >>>>>>> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 >>>>>>> "framework"
 >>>>>>> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 >>>>>>> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 >>>>>>> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" "mred"
 >>>>>>> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" "parser-tools"
 >>>>>>> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" "r5rs"
 >>>>>>> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 >>>>>>> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 >>>>>>> "scribblings"
 >>>>>>> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 >>>>>>> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 >>>>>>> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 >>>>>>> "typed"
 >>>>>>> >> "typ!
 >>>>>>> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 >>>>>>> >> "wxme" "xml" "xrepl"))
 >>>>>>> >>
 >>>>>>> >> Computer Language: (("Determine language from source") (#(#t print
 >>>>>>> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 >>>>
 >>>>
 >>>>
 >>>> --
 >>>> sam th
 >>>> samth@ccs.neu.edu
 >>
 >>
 >>
 >> --
 >> sam th
 >> samth@ccs.neu.edu
 
 
 
 -- 
 sam th
 samth@ccs.neu.edu
 
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: Sam Tobin-Hochstadt <samth@ccs.neu.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 06:27:36 -0700

 I didn't mean using `gui-available?'. More soon....
 
 At Fri, 10 Feb 2012 07:26:10 -0600, Robby Findler wrote:
 > No. It isn't true from 'racket'; it isn't true in a new namespace (the
 > former because it hasn't been loaded, the latter because the GUI has
 > to be shared with a new namespace "from the outside").
 > 
 > Welcome to Racket v5.2.1.5.
 > > (system-type)
 > 'macosx
 > > (require racket/gui/dynamic)
 > > (gui-available?)
 > #f
 > > (require racket/gui/base)
 > > (gui-available?)
 > #t
 > > (parameterize ([current-namespace (make-base-namespace)])
 >    (namespace-require 'racket/gui/dynamic)
 >    (eval '(gui-available?)))
 > #f
 > > ^D
 > 
 > 
 > Robby
 > 
 > On Fri, Feb 10, 2012 at 7:22 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> wrote:
 > > Right, but isn't `gui-available?' always true on Mac and Windows?
 > >
 > > On Fri, Feb 10, 2012 at 8:11 AM, Robby Findler
 > > <robby@eecs.northwestern.edu> wrote:
 > >> That doesn't seem to be what Matthew wrote.
 > >>
 > >> On Fri, Feb 10, 2012 at 7:06 AM, Sam Tobin-Hochstadt <samth@ccs.neu.edu> 
 > wrote:
 > >>> I imagine `make-platform-bitmap' would look something like this:
 > >>>
 > >>> (define (m-p-b . args)
 > >>>  (if (gui-available?) (apply (m-s-b args)) (apply (m-b args))))
 > >>>
 > >>> On Thu, Feb 9, 2012 at 9:16 PM, Robby Findler
 > >>> <robby@eecs.northwestern.edu> wrote:
 > >>>> Why would make-platform-bitmap be able to avoid the dependency on
 > >>>> racket/gui/base when make-screen-bitmap cannot? (Also, are we worried
 > >>>> about using too many win32 resources?)
 > >>>>
 > >>>> Robby
 > >>>>
 > >>>> On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > >>>>> I imagined that the DrRacket REPL would use `make-screen-bitmap'
 > >>>>> always, but a general pict->png conversion shouldn't rely on
 > >>>>> `racket/gui/base'.
 > >>>>>
 > >>>>> Win32 and Cocoa bitmaps are readily available without
 > >>>>> `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 > >>>>> `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 > >>>>> and Cocoa and the same as `make-bitmap' elsewhere.
 > >>>>>
 > >>>>> At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 > >>>>>> Do you have advice on what DrRacket's REPL and what the pict->png
 > >>>>>> conversion should be doing? Maybe make-screen-bitmap on the mac and
 > >>>>>> make-bitmap elsewhere?
 > >>>>>>
 > >>>>>> Robby
 > >>>>>>
 > >>>>>> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > >>>>>> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 > >>>>>> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 > >>>>>> > instead of `make-bitmap'.
 > >>>>>> >
 > >>>>>> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 > >>>>>> >> A new problem report is waiting at
 > >>>>>> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 > >>>>>> >>
 > >>>>>> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 > >>>>>> >>
 > >>>>>> >> *** Description:
 > >>>>>> >> The pict below appears to have the right 10 or 15% or so of each 
 > letter
 > >>>>>> chopped
 > >>>>>> >> off. This only seems to happen with "Courier New", not with, e.g., 
 > "Courier".
 > >>>>>> >>
 > >>>>>> >> So perhaps the right fix here is to change the interpretation of 
 > 'modern so
 > >>>>>> >> that it is "Courier New" instead of courier?
 > >>>>>> >>
 > >>>>>> >> In the meantime, since this makes the pink stuff in Redex look bad, 
 > there is
 > >>>>>> >> definition at the top of redex/private/core-layout.rkt that uses 
 > "Courier"
 > >>>>>> when
 > >>>>>> >> it is available and when the platform is mac os x.
 > >>>>>> >>
 > >>>>>> >> Depending on how this PR is resolved, that should also be changed.
 > >>>>>> >>
 > >>>>>> >> *** How to repeat:
 > >>>>>> >> #lang racket/base
 > >>>>>> >> (require texpict/mrpict texpict/utils)
 > >>>>>> >> (scale/improve-new-text
 > >>>>>> >>   (text "equal?" "Courier New" 14)
 > >>>>>> >>  4)
 > >>>>>> >>
 > >>>>>> >> *** Environment:
 > >>>>>> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue 
 > Aug  9
 > >>>>>> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 > >>>>>> >> (x86_64-macosx/3m) (get-display-depth) = 32
 > >>>>>> >> Human Language: english
 > >>>>>> >> (current-memory-use) 328333144
 > >>>>>> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = 
 > (); (links
 > >>>>>> >> #:user? #f #:root? #t) = ()
 > >>>>>> >>
 > >>>>>> >>
 > >>>>>> >> Collections:
 > >>>>>> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 > >>>>>> >>  (non-existent-path))
 > >>>>>> >> ("/Users/robby/git/exp/plt/collects"
 > >>>>>> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" 
 > "combinator-parser"
 > >>>>>> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 > >>>>>> "drracket"
 > >>>>>> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 > >>>>>> "framework"
 > >>>>>> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" 
 > "handin-client"
 > >>>>>> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" 
 > "images"
 > >>>>>> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" 
 > "mred"
 > >>>>>> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" 
 > "parser-tools"
 > >>>>>> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" 
 > "r5rs"
 > >>>>>> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" 
 > "redex"
 > >>>>>> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 > >>>>>> "scribblings"
 > >>>>>> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" 
 > "srpersist"
 > >>>>>> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" 
 > "teachpack"
 > >>>>>> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 > >>>>>> "typed"
 > >>>>>> >> "typ!
 > >>>>>> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" 
 > "web-server"
 > >>>>>> >> "wxme" "xml" "xrepl"))
 > >>>>>> >>
 > >>>>>> >> Computer Language: (("Determine language from source") (#(#t print
 > >>>>>> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 > >>>
 > >>>
 > >>>
 > >>> --
 > >>> sam th
 > >>> samth@ccs.neu.edu
 > >
 > >
 > >
 > > --
 > > sam th
 > > samth@ccs.neu.edu
 
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 07:04:45 -0700

 At Thu, 9 Feb 2012 20:16:45 -0600, Robby Findler wrote:
 > Why would make-platform-bitmap be able to avoid the dependency on
 > racket/gui/base when make-screen-bitmap cannot? 
 
 On Gtk on X11, `make-screen-bitmap' requires an X connection, and so
 `make-screen-bitmap' really has to be exported from `racket/gui/base'.
 
 On Win32 and Cocoa, the primitives that `make-screen-bitmap' needs are
 all available in the dependencies of `racket/draw'.
 
 So, a new `make-platform-bitmap' could be exported from `racket/draw'
 and provide the same functionality on Windows and Mac OS X as
 Win32/Cocoa `make-screen-bitmap' --- but it can only provide the
 functionality of `make-bitmap' on Unix.
 
 
 > (Also, are we worried
 > about using too many win32 resources?)
 
 Good point. Maybe picts should be rendered to a platform bitmap and
 then copied to a plain bitmap, in which case the platform bitmap can be
 recycled immediately.
 
 
 > On Thu, Feb 9, 2012 at 7:35 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > > I imagined that the DrRacket REPL would use `make-screen-bitmap'
 > > always, but a general pict->png conversion shouldn't rely on
 > > `racket/gui/base'.
 > >
 > > Win32 and Cocoa bitmaps are readily available without
 > > `racket/gui/base'. Maybe there should be `make-platform-bitmap' in
 > > `racket/draw', which would be the same as `make-screen-bitmap' on Win32
 > > and Cocoa and the same as `make-bitmap' elsewhere.
 > >
 > > At Thu, 9 Feb 2012 19:15:01 -0600, Robby Findler wrote:
 > >> Do you have advice on what DrRacket's REPL and what the pict->png
 > >> conversion should be doing? Maybe make-screen-bitmap on the mac and
 > >> make-bitmap elsewhere?
 > >>
 > >> Robby
 > >>
 > >> On Thu, Feb 9, 2012 at 7:08 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > >> > This appears to be a limitation of Cairo's bitmap drawing, and I think
 > >> > the problem goes away if you use a bitmap from `make-screen-bitmap'
 > >> > instead of `make-bitmap'.
 > >> >
 > >> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 > >> >> A new problem report is waiting at
 > >> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 > >> >>
 > >> >> Reported by Robby Findler for release: 5.2.1.5--2012-02-05(98a0b74/g)
 > >> >>
 > >> >> *** Description:
 > >> >> The pict below appears to have the right 10 or 15% or so of each letter
 > >> chopped
 > >> >> off. This only seems to happen with "Courier New", not with, e.g., 
 > "Courier".
 > >> >>
 > >> >> So perhaps the right fix here is to change the interpretation of 'modern 
 > so
 > >> >> that it is "Courier New" instead of courier?
 > >> >>
 > >> >> In the meantime, since this makes the pink stuff in Redex look bad, there 
 > is
 > >> >> definition at the top of redex/private/core-layout.rkt that uses "Courier"
 > >> when
 > >> >> it is available and when the platform is mac os x.
 > >> >>
 > >> >> Depending on how this PR is resolved, that should also be changed.
 > >> >>
 > >> >> *** How to repeat:
 > >> >> #lang racket/base
 > >> >> (require texpict/mrpict texpict/utils)
 > >> >> (scale/improve-new-text
 > >> >>   (text "equal?" "Courier New" 14)
 > >> >>  4)
 > >> >>
 > >> >> *** Environment:
 > >> >> macosx "Darwin yanpu.local 11.2.0 Darwin Kernel Version 11.2.0: Tue Aug  9
 > >> >> 20:54:00 PDT 2011; root:xnu-1699.24.8~1/RELEASE_X86_64 x86_64"
 > >> >> (x86_64-macosx/3m) (get-display-depth) = 32
 > >> >> Human Language: english
 > >> >> (current-memory-use) 328333144
 > >> >> Links: (links) = (); (links #:user? #f) = (); (links #:root? #t) = (); 
 > (links
 > >> >> #:user? #f #:root? #t) = ()
 > >> >>
 > >> >>
 > >> >> Collections:
 > >> >> ("/Users/robby/Library/Racket/5.2.1.5/collects"
 > >> >>  (non-existent-path))
 > >> >> ("/Users/robby/git/exp/plt/collects"
 > >> >>  (".gitignore" "2htdp" "algol60" "at-exp" "browser" "combinator-parser"
 > >> >> "compiler" "config" "data" "datalog" "db" "defaults" "deinprogramm"
 > >> "drracket"
 > >> >> "drscheme" "dynext" "embedded-gui" "eopl" "errortrace" "ffi" "file"
 > >> "framework"
 > >> >> "frtime" "games" "graphics" "gui-debugger" "guibuilder" "handin-client"
 > >> >> "handin-server" "help" "hierlist" "honu" "htdp" "html" "icons" "images"
 > >> >> "info-domain" "lang" "launcher" "lazy" "macro-debugger" "make" "meta" 
 > "mred"
 > >> >> "mrlib" "mysterx" "mzcom" "mzlib" "mzscheme" "net" "openssl" 
 > "parser-tools"
 > >> >> "picturing-programs" "plai" "planet" "plot" "preprocessor" "profile" 
 > "r5rs"
 > >> >> "r6rs" "racket" "racklog" "rackunit" "raco" "reader" "readline" "redex"
 > >> >> "repo-time-stamp" "rnrs" "s-exp" "scheme" "schemeunit" "scribble"
 > >> "scribblings"
 > >> >> "scriblib" "setup" "sgl" "sirmail" "slatex" "slideshow" "srfi" "srpersist"
 > >> >> "stepper" "string-constants" "swindle" "syntax" "syntax-color" "teachpack"
 > >> >> "test-box-recovery" "test-engine" "tests" "tex2page" "texpict" "trace"
 > >> "typed"
 > >> >> "typ!
 > >> >>  ed-racket" "typed-scheme" "unstable" "version" "waterworld" "web-server"
 > >> >> "wxme" "xml" "xrepl"))
 > >> >>
 > >> >> Computer Language: (("Determine language from source") (#(#t print
 > >> >> mixed-fraction-e #f #t debug) (default) #() "#lang racket\n" #t #t))
 
From: Sam Tobin-Hochstadt <samth@ccs.neu.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: Robby Findler <robby@eecs.northwestern.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Fri, 10 Feb 2012 09:56:33 -0500

 On Fri, Feb 10, 2012 at 9:04 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > At Thu, 9 Feb 2012 20:16:45 -0600, Robby Findler wrote:
 >> Why would make-platform-bitmap be able to avoid the dependency on
 >> racket/gui/base when make-screen-bitmap cannot?
 >
 > On Gtk on X11, `make-screen-bitmap' requires an X connection, and so
 > `make-screen-bitmap' really has to be exported from `racket/gui/base'.
 >
 > On Win32 and Cocoa, the primitives that `make-screen-bitmap' needs are
 > all available in the dependencies of `racket/draw'.
 >
 > So, a new `make-platform-bitmap' could be exported from `racket/draw'
 > and provide the same functionality on Windows and Mac OS X as
 > Win32/Cocoa `make-screen-bitmap' --- but it can only provide the
 > functionality of `make-bitmap' on Unix.
 
 Would it be reasonable to use `make-screen-bitmap' on X if
 `gui-available?' is true, so that, for example, this bug is avoided on
 X when possible?
 -- 
 sam th
 samth@ccs.neu.edu
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Mon, 13 Feb 2012 13:03:00 -0600

 >> >> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 >> >> >> A new problem report is waiting at
 >> >> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 
 After a little thought, I'm not happy about the way this will work
 only on some platforms and not others. At least unhappy enough to ask
 another question.
 
 Is there a problem with changing the default font for 'modern to one
 that generally works with make-bitmap?
 
 Robby
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Mon, 13 Feb 2012 18:42:06 -0700

 At Mon, 13 Feb 2012 13:03:00 -0600, Robby Findler wrote:
 > >> >> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu wrote:
 > >> >> >> A new problem report is waiting at
 > >> >> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 > 
 > After a little thought, I'm not happy about the way this will work
 > only on some platforms and not others. At least unhappy enough to ask
 > another question.
 > 
 > Is there a problem with changing the default font for 'modern to one
 > that generally works with make-bitmap?
 
 I doubt that changing one of the fonts is the right solution. Fonts are
 the clearest case where platform-specific rendering is different than
 Cairo's built-in rendering, but that's not the only case.
 
 Unfortunately, I can't remember the significant cases. Bitmap scaling,
 maybe? Whatever the reasons, when I've run into this before, I've
 consistently arrived at the conclusion that platform-specific bitmaps
 are best when the eventual destination is the screen. The alternative
 of more portable rendering always sounds attractive, but it rarely
 seems to work out.
 
 
 Meanwhile, I'm not too worried about things working less well on X,
 because I've never noticed any particular difference between default
 bitmaps and screen bitmaps on X (unlike Mac and Windows). I think Cairo
 and modern X font systems share a lot of their design and
 implementation.
 
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: Robby Findler <robby@eecs.northwestern.edu>,
        "bugs@racket-lang.org" <bugs@racket-lang.org>,
        "nobody@racket-lang.org" <nobody@racket-lang.org>,
        "bug-notification@racket-lang.org" <bug-notification@racket-lang.org>
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Mon, 13 Feb 2012 19:49:00 -0600

 --e89a8f23445989fff304b8e2ccc8
 Content-Type: text/plain; charset=UTF-8
 
 On Monday, February 13, 2012, Matthew Flatt wrote:
 
 > At Mon, 13 Feb 2012 13:03:00 -0600, Robby Findler wrote:
 > > >> >> > At Wed, 8 Feb 2012 17:44:01 -0500, robby@eecs.northwestern.edu<javascript:;>wrote:
 > > >> >> >> A new problem report is waiting at
 > > >> >> >>   http://bugs.racket-lang.org/query/?cmd=view&pr=12554
 > >
 > > After a little thought, I'm not happy about the way this will work
 > > only on some platforms and not others. At least unhappy enough to ask
 > > another question.
 > >
 > > Is there a problem with changing the default font for 'modern to one
 > > that generally works with make-bitmap?
 >
 > I doubt that changing one of the fonts is the right solution. Fonts are
 > the clearest case where platform-specific rendering is different than
 > Cairo's built-in rendering, but that's not the only case.
 >
 > Unfortunately, I can't remember the significant cases. Bitmap scaling,
 > maybe? Whatever the reasons, when I've run into this before, I've
 > consistently arrived at the conclusion that platform-specific bitmaps
 > are best when the eventual destination is the screen. The alternative
 > of more portable rendering always sounds attractive, but it rarely
 > seems to work out.
 >
 > Meanwhile, I'm not too worried about things working less well on X,
 > because I've never noticed any particular difference between default
 > bitmaps and screen bitmaps on X (unlike Mac and Windows). I think Cairo
 > and modern X font systems share a lot of their design and
 > implementation.
 >
 >
 Okay. So then the primitive you suggested seems right.
 
 When is make-bitmap the right choice? It seems rare that you'd make a
 bitmap that was never going to be displayed.
 
 (Well, the use case you suggested earlier of creating a screen bitmap that
 you copy into a regular bitmap comes to mind, I guess.)
 
  Robby
 
 --e89a8f23445989fff304b8e2ccc8
 Content-Type: text/html; charset=UTF-8
 Content-Transfer-Encoding: quoted-printable
 
 <br><br>On Monday, February 13, 2012, Matthew Flatt  wrote:<br><blockquote =
 class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid=
 ;padding-left:1ex">At Mon, 13 Feb 2012 13:03:00 -0600, Robby Findler wrote:=
 <br>
 
 &gt; &gt;&gt; &gt;&gt; &gt; At Wed, 8 Feb 2012 17:44:01 -0500, <a href=3D"j=
 avascript:;" onclick=3D"_e(event, &#39;cvml&#39;, &#39;robby@eecs.northwest=
 ern.edu&#39;)">robby@eecs.northwestern.edu</a> wrote:<br>
 &gt; &gt;&gt; &gt;&gt; &gt;&gt; A new problem report is waiting at<br>
 &gt; &gt;&gt; &gt;&gt; &gt;&gt; =C2=A0 <a href=3D"http://bugs.racket-lang.o=
 rg/query/?cmd=3Dview&amp;pr=3D12554" target=3D"_blank">http://bugs.racket-l=
 ang.org/query/?cmd=3Dview&amp;pr=3D12554</a><br>
 &gt;<br>
 &gt; After a little thought, I&#39;m not happy about the way this will work=
 <br>
 &gt; only on some platforms and not others. At least unhappy enough to ask<=
 br>
 &gt; another question.<br>
 &gt;<br>
 &gt; Is there a problem with changing the default font for &#39;modern to o=
 ne<br>
 &gt; that generally works with make-bitmap?<br>
 <br>
 I doubt that changing one of the fonts is the right solution. Fonts are<br>
 the clearest case where platform-specific rendering is different than<br>
 Cairo&#39;s built-in rendering, but that&#39;s not the only case.<br>
 <br>
 Unfortunately, I can&#39;t remember the significant cases. Bitmap scaling,<=
 br>
 maybe? Whatever the reasons, when I&#39;ve run into this before, I&#39;ve<b=
 r>
 consistently arrived at the conclusion that platform-specific bitmaps<br>
 are best when the eventual destination is the screen. The alternative<br>
 of more portable rendering always sounds attractive, but it rarely<br>
 seems to work out.<br>
 <br></blockquote><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8=
 ex;border-left:1px #ccc solid;padding-left:1ex">Meanwhile, I&#39;m not too =
 worried about things working less well on X,<br>
 because I&#39;ve never noticed any particular difference between default<br=
 >
 bitmaps and screen bitmaps on X (unlike Mac and Windows). I think Cairo<br>
 and modern X font systems share a lot of their design and<br>
 implementation.<br>
 <br></blockquote><div><br></div><div><div>Okay. So then the primitive you s=
 uggested seems right.</div><div><br></div><div>When is make-bitmap the righ=
 t choice? It seems rare that you&#39;d make a bitmap that was never going t=
 o be displayed.</div>
 <div>=C2=A0</div><div>(Well, the use case you suggested earlier of creating=
  a screen bitmap that you copy into a regular bitmap comes to mind, I guess=
 .)</div><div>=C2=A0</div>=C2=A0Robby</div>
 
 --e89a8f23445989fff304b8e2ccc8--
From: Sam Tobin-Hochstadt <samth@ccs.neu.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: Robby Findler <robby@eecs.northwestern.edu>, bugs@racket-lang.org,
        nobody@racket-lang.org, bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Mon, 13 Feb 2012 20:55:00 -0500

 On Mon, Feb 13, 2012 at 8:42 PM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > I think Cairo
 > and modern X font systems share a lot of their design and
 > implementation.
 
 This is definitely the case, and I also haven't noticed this kind of
 bitmap weirdness.
 -- 
 sam th
 samth@ccs.neu.edu
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@racket-lang.org, Sam TH <samth@ccs.neu.edu>
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Wed, 15 Feb 2012 16:28:14 -0600

 On Fri, Feb 10, 2012 at 8:04 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > So, a new `make-platform-bitmap' could be exported from `racket/draw'
 > and provide the same functionality on Windows and Mac OS X as
 > Win32/Cocoa `make-screen-bitmap' --- but it can only provide the
 > functionality of `make-bitmap' on Unix.
 
 I started looking into this and was able to easily break the
 dependencies for the mac os x version of make-screen-bitmap (I think I
 did it successfully anyways), but the windows one needs
 
   GetDC & ReleaseDC from mred/private/wx/win32/utils.rkt
   create-gl-context from mred/private/wx/win32/gl-context.rkt
 
 The latter seems like it should be able to be changed to use a generic
 gl interface (I didn't try to find that yet, tho), but I'm not sure
 how to proceed with the former.
 
 Also, I wondered why the mac version didn't depend on any gl stuff.
 
 Any advice?
 
 Thanks,
 Robby
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs@racket-lang.org, Sam TH <samth@ccs.neu.edu>
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Wed, 15 Feb 2012 16:41:52 -0700

 At Wed, 15 Feb 2012 16:28:14 -0600, Robby Findler wrote:
 > On Fri, Feb 10, 2012 at 8:04 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > > So, a new `make-platform-bitmap' could be exported from `racket/draw'
 > > and provide the same functionality on Windows and Mac OS X as
 > > Win32/Cocoa `make-screen-bitmap' --- but it can only provide the
 > > functionality of `make-bitmap' on Unix.
 > 
 > I started looking into this and was able to easily break the
 > dependencies for the mac os x version of make-screen-bitmap (I think I
 > did it successfully anyways), but the windows one needs
 > 
 >   GetDC & ReleaseDC from mred/private/wx/win32/utils.rkt
 >   create-gl-context from mred/private/wx/win32/gl-context.rkt
 > 
 > The latter seems like it should be able to be changed to use a generic
 > gl interface (I didn't try to find that yet, tho), but I'm not sure
 > how to proceed with the former.
 
 I think both the DC and gl stuff could stay in the current "dc.rkt" as
 a further extension of `win32-bitmap%'. They are triggered only by the
 creation of a canvas-backing bitmap and by `make-gl-bitmap' --- not by
 `make-screen-bitmap' (or `make-platform-bitmap').
 
 > Also, I wondered why the mac version didn't depend on any gl stuff.
 
 The three platforms have very different ways to get at GL support.
 
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Wed, 15 Feb 2012 21:24:39 -0600

 On Fri, Feb 10, 2012 at 8:04 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > So, a new `make-platform-bitmap' could be exported from `racket/draw'
 > and provide the same functionality on Windows and Mac OS X as
 > Win32/Cocoa `make-screen-bitmap' --- but it can only provide the
 > functionality of `make-bitmap' on Unix.
 
 When I look at the Guide for racket/draw, it makes me think we should
 call the new thing make-bitmap and call the old one make-cairo-bitmap
 or something like that.
 
 Would that cause backwards compatibility problems? Maybe because of
 the win32 resources problem?
 
 Assuming we cannot change the names (I'm not sure myself), I think it
 is probably a good idea to change the docs to generally use
 make-platform-bitmap in examples and then have the docs for
 make-bitmap point to make-platform-bitmap.
 
 Robby
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Thu, 16 Feb 2012 06:58:45 -0600

 Is drawing to the result of a make-screen-bitmap the same as drawing
 to the result of a make-bitmap under linux?
 
 Robby
From: Matthew Flatt <mflatt@cs.utah.edu>
To: Robby Findler <robby@eecs.northwestern.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Thu, 16 Feb 2012 06:58:34 -0700

 Early on, I considered trying to make bitmaps transparently migrate
 from one back-end to the other --- perhaps allowing N platform bitmaps
 at a time on Windows, and when an N+1th bitmap is about to be modified,
 shifting the least-recently modified platform bitmap to a Cairo bitmap.
 Maybe that's the right strategy to try, instead?
 
 At Wed, 15 Feb 2012 21:24:39 -0600, Robby Findler wrote:
 > On Fri, Feb 10, 2012 at 8:04 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > > So, a new `make-platform-bitmap' could be exported from `racket/draw'
 > > and provide the same functionality on Windows and Mac OS X as
 > > Win32/Cocoa `make-screen-bitmap' --- but it can only provide the
 > > functionality of `make-bitmap' on Unix.
 > 
 > When I look at the Guide for racket/draw, it makes me think we should
 > call the new thing make-bitmap and call the old one make-cairo-bitmap
 > or something like that.
 > 
 > Would that cause backwards compatibility problems? Maybe because of
 > the win32 resources problem?
 > 
 > Assuming we cannot change the names (I'm not sure myself), I think it
 > is probably a good idea to change the docs to generally use
 > make-platform-bitmap in examples and then have the docs for
 > make-bitmap point to make-platform-bitmap.
 > 
 > Robby
From: Robby Findler <robby@eecs.northwestern.edu>
To: Matthew Flatt <mflatt@cs.utah.edu>
Cc: bugs@racket-lang.org, nobody@racket-lang.org,
        bug-notification@racket-lang.org
Subject: Re: [racket-bug] all/12554: picts: right edge of letters chopped off
Date: Thu, 16 Feb 2012 09:52:11 -0600

 That sounds interesting to try.
 
 I'll take that to mean that, however, it is good to keep the "ugly"
 name make-platform-bitmap for the most recent addition, since it
 really isn't the right thing in the long term.
 
 Meanwhile, I'll just document make-platform-bitmap as the one to use
 by default and explain the limitations.
 
 Robby
 
 On Thu, Feb 16, 2012 at 7:58 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 > Early on, I considered trying to make bitmaps transparently migrate
 > from one back-end to the other --- perhaps allowing N platform bitmaps
 > at a time on Windows, and when an N+1th bitmap is about to be modified,
 > shifting the least-recently modified platform bitmap to a Cairo bitmap.
 > Maybe that's the right strategy to try, instead?
 >
 > At Wed, 15 Feb 2012 21:24:39 -0600, Robby Findler wrote:
 >> On Fri, Feb 10, 2012 at 8:04 AM, Matthew Flatt <mflatt@cs.utah.edu> wrote:
 >> > So, a new `make-platform-bitmap' could be exported from `racket/draw'
 >> > and provide the same functionality on Windows and Mac OS X as
 >> > Win32/Cocoa `make-screen-bitmap' --- but it can only provide the
 >> > functionality of `make-bitmap' on Unix.
 >>
 >> When I look at the Guide for racket/draw, it makes me think we should
 >> call the new thing make-bitmap and call the old one make-cairo-bitmap
 >> or something like that.
 >>
 >> Would that cause backwards compatibility problems? Maybe because of
 >> the win32 resources problem?
 >>
 >> Assuming we cannot change the names (I'm not sure myself), I think it
 >> is probably a good idea to change the docs to generally use
 >> make-platform-bitmap in examples and then have the docs for
 >> make-bitmap point to make-platform-bitmap.
 >>
 >> Robby
Responsible changed from "mflatt" to "robby" by robby@racket-lang.org at Tue, 21 Feb 2012 17:19:54 -0500
Reason>>> A commit by robby@racket-lang.org has resolved this report
  http://git.racket-lang.org/plt/commit/1945ff2709
State changed from "open" to "closed" by robby@racket-lang.org at Tue, 21 Feb 2012 17:19:54 -0500
Reason>>> A commit by robby@racket-lang.org has resolved this report
  http://git.racket-lang.org/plt/commit/1945ff2709
From: Matthew Flatt <mflatt@cs.utah.edu>
To: bugs@racket-lang.org
Cc: robby@racket-lang.org, robby@eecs.northwestern.edu
Subject: Re: [racket-bug] mred/12554 picts: right edge of letters chopped off
Date: Tue, 21 Feb 2012 16:09:14 -0700

 While adding `make-platform-bitmap' increases our options, here's an
 important discovery that didn't make it into the bug-report record:
 
 The main problem with the original may be a broken font in Mac OS X
 10.7. The character bounding boxes in the "Courier New" font (as
 reported by the CGFontGetGlyphBBoxes() function) appear to be too far
 to the left. The problem doesn't show up with 10.6, where the bounding
 boxes appear to be correctly aligned. More work is needed to determine
 if it really is a problem in the 10.7 "Courier New" font, though.
 
